///////////////////////////////////////////////////////////////////////////////
//	LAND CONTROL 6
//	~~~~~~~~~~~~~~
//
//	This is the enemy AI script
//
//	Rewards:			None
//
//	Start date:			25-03-05			By:	Steve
//	Update date:		14-05-05			By: Steve
///////////////////////////////////////////////////////////////////////////////


//-----------------------------------------------------------------------------
//	Constants 
//-----------------------------------------------------------------------------
define LC6_INVALID									= 0
define LC6_TRUE										= 1
define LC6_FALSE									= 0

define LC6_FORCE									= 1
define LC6_IMPRESS									= 2

define LC6_NEUTRAL									= 1
define LC6_WAR										= 2
define LC6_CITY										= 3
define LC6_PLAYER									= 2
define LC6_OPPONENT									= 3

define LC6_NEUTRAL_ALIGN							= 1
define LC6_GOOD_ALIGN								= 2
define LC6_EVIL_ALIGN								= 3

define LC6_GREEK									= 0
define LC6_JAPANESE									= 1

define LC6_SETTLEMENT								= 1
define LC6_TOWN										= 2

define LC6_NUM_MINOR_TOWNS							= 5
define LC6_NUM_BUILDINGS							= 34

define LC6_NUM_WALLS								= 10
define LC6_NUM_ROADS								= 22

// Patrol route stuff
define LC6_MAX_PATROL_ROUTES						= 20
define LC6_MAX_PLATOONS								= 10
define LC6_MAX_CATAPULTS							= 6


// Secondary objectives
define LC6_OBJECTIVE_REACH_POP						= 1
define LC6_OBJECTIVE_BUILD_IMPRESSIVE_BUILDINGS		= 2
define LC6_OBJECTIVE_MAKE_BREEDERS					= 3
define LC6_OBJECTIVE_TAKE_OVER_ALL_SETTLEMENTS		= 4
define LC6_OBJECTIVE_MAKE_SOLDIERS					= 5


// --- Target Amounts --- //
define LC6_NUM_POPULATION_NEEDED					= 600
define LC6_NUM_IMPRESSIVE_BUILDINGS_NEEDED			= 3
define LC6_NUM_BREEDERS_NEEDED						= 20
define LC6_NUM_SETTLEMENTS							= 6
define LC6_NUM_SOLDIERS_NEEDED						= 100
define LC6_AMOUNT_IMPRESSIVE_LEVEL_1_THRESHOLD		= 1000
define LC6_AMOUNT_IMPRESSIVE_LEVEL_2_THRESHOLD		= 2500
define LC6_AMOUNT_IMPRESSIVE_LEVEL_3_THRESHOLD		= 5000
define LC6_AMOUNT_IMPRESSIVE_FOR_EACH_BUILDING		= 250


//--- General Reaction States ---//
define LC6_GEN_REACT_ARRIVAL										= 1
define LC6_GEN_REACT_TAKE_FIRST_SETTLEMENT_IMP						= 2
define LC6_GEN_REACT_TAKE_FIRST_SETTLEMENT_ARM						= 3
define LC6_GEN_REACT_TAKE_SECOND_SETTLEMENT_IMP						= 4
define LC6_GEN_REACT_TAKE_SECOND_SETTLEMENT_ARM						= 5
define LC6_GEN_REACT_TAKE_THIRD_SETTLEMENT_IMP						= 6
define LC6_GEN_REACT_TAKE_THIRD_SETTLEMENT_ARM						= 7
define LC6_GEN_REACT_TAKE_FOURTH_SETTLEMENT_IMP						= 8
define LC6_GEN_REACT_TAKE_FOURTH_SETTLEMENT_ARM						= 9
define LC6_GEN_REACT_TAKE_FIFTH_SETTLEMENT_IMP						= 10
define LC6_GEN_REACT_TAKE_FIFTH_SETTLEMENT_ARM						= 11
define LC6_GEN_REACT_TAKE_FIRST_TOWN_IMP							= 12
define LC6_GEN_REACT_TAKE_SECOND_TOWN_IMP							= 13
define LC6_GEN_REACT_TAKE_THIRD_TOWN_IMP							= 14
define LC6_GEN_REACT_TAKE_FOURTH_TOWN_IMP							= 15
define LC6_GEN_REACT_TAKE_FIFTH_TOWN_IMP							= 16
define LC6_GEN_REACT_CROSSED_MAJINO_LINE_EARLY_ARM					= 17
define LC6_GEN_REACT_TAKE_TOWN_ONE_AFTER_RUSH_ARM					= 18
define LC6_GEN_REACT_TAKE_TOWN_TWO_AFTER_RUSH_ARM					= 19
define LC6_GEN_REACT_TAKE_TOWN_ONE_OR_TWO_BEFORE_RUSH_ARM			= 20
define LC6_GEN_REACT_TAKE_OTHER_TOWN_BEFORE_RUSH_ARM				= 21
define LC6_GEN_REACT_TAKE_TOWN_THREE_AFTER_TOWN_ONE_OR_TWO_ARM		= 22
define LC6_GEN_REACT_TAKE_TOWN_FOUR_ARM								= 23
define LC6_GEN_REACT_TAKE_TOWN_FIVE_ARM								= 24
define LC6_GEN_TAKES_FIRST_SETTLEMENT_IMP							= 25
define LC6_GEN_TAKES_FIRST_SETTLEMENT_ARM							= 26
define LC6_GEN_TAKES_SECOND_SETTLEMENT_IMP							= 27
define LC6_GEN_TAKES_SECOND_SETTLEMENT_ARM							= 28
define LC6_GEN_TAKES_THIRD_SETTLEMENT_IMP							= 29
define LC6_GEN_TAKES_THIRD_SETTLEMENT_ARM							= 30
define LC6_GEN_TAKES_FOURTH_SETTLEMENT_IMP							= 31
define LC6_GEN_TAKES_FOURTH_SETTLEMENT_ARM							= 32
define LC6_GEN_TAKES_FIFTH_SETTLEMENT_IMP							= 33
define LC6_GEN_TAKES_FIFTH_SETTLEMENT_ARM							= 34
define LC6_GEN_TAKES_FIRST_TOWN_IMP									= 35
define LC6_GEN_TAKES_FIRST_TOWN_ARM									= 36
define LC6_GEN_TAKES_SECOND_TOWN_IMP								= 37
define LC6_GEN_TAKES_SECOND_TOWN_ARM								= 38
define LC6_GEN_TAKES_THIRD_TOWN_IMP									= 39
define LC6_GEN_TAKES_THIRD_TOWN_ARM									= 40
define LC6_GEN_TAKES_FOURTH_TOWN_IMP								= 41
define LC6_GEN_TAKES_FOURTH_TOWN_ARM								= 42
define LC6_GEN_TAKES_FIFTH_TOWN_IMP									= 43
define LC6_GEN_TAKES_FIFTH_TOWN_ARM									= 44
define LC6_GEN_SURRENDERS_PLAYER_WON_WITH_IMP						= 45
define LC6_GEN_SURRENDERS_PLAYER_WON_WITH_ARM						= 46
define LC6_GEN_REACT_PLAYER_BUILDS_ARMOURY							= 47
define LC6_GEN_REACT_PLAYER_CREATES_THEIR_FIRST_PLATOON				= 48
define LC6_GEN_REACT_PLAYER_CREATES_THEIR_FIRST_CATAPULT			= 49
define LC6_GEN_REACT_PLAYER_USES_MAGIC_FIRST_TIME					= 50
define LC6_GEN_REACT_PLAYER_USES_CREATURE_OFFENSIVELY_FIRST_TIME	= 51
define LC6_GEN_REACT_IMPRESSIVE_LEVEL_1								= 52
define LC6_GEN_REACT_IMPRESSIVE_LEVEL_2								= 53
define LC6_GEN_REACT_IMPRESSIVE_LEVEL_3								= 54
define LC6_GEN_REACT_PLAYER_KILLS_ENEMY_CREATURE					= 55
define LC6_GEN_REACT_PLAYER_POPULATION_EXPANDS_TO_X					= 56
define LC6_GEN_REACT_PLAYER_TAKEN_ALL_MINOR_TOWNS_MOST_WITH_FORCE	= 57
define LC6_GEN_REACT_SIREN_READY_TO_CONVERT_ATTACKING_TROOPS		= 58
define LC6_GEN_REACT_SIREN_READY_PLAYER_TRYING_TO_IMPRESS			= 59
define LC6_GEN_REACT_PLAYER_SWITCHED_FROM_IMPRESS_TO_FORCE			= 60
define LC6_GEN_REACT_PLAYER_SWITCHED_FROM_FORCE_TO_IMPRESS			= 61
define LC6_GEN_REACT_PLAYER_INVESTIGATES_MONKS						= 62
define LC6_GEN_REACT_JAPANESE_PLATOON_READY_TO_ATTACK_MONKS			= 63
define LC6_GEN_REACT_JAPANESE_PLATOON_DEAD_AFTER_ATTACKING_MONKS	= 64
define LC6_GEN_REACT_PLAYER_ATTACKS_JAPANESE_HOME_TOWN				= 65
define LC6_GEN_REACT_PLAYER_ATTACKS_JAPANESE_CLOSE_MINOR_TOWNS		= 66
define LC6_GEN_REACT_PLAYER_WINS_THE_LAND							= 67
define LC6_GEN_REACT_KICK_OFF_SIREN									= 68
define LC6_GEN_REACT_KICK_OFF_HURRICANE								= 69
define LC6_GEN_REACT_CITY_BUILT_ABODES								= 70
define LC6_GEN_REACT_CITY_BUILT_FIELDS								= 71
define LC6_GEN_REACT_CITY_BUILT_STORAGE_PIT							= 72
define LC6_GEN_REACT_CITY_BUILT_TEMPLE								= 73
define LC6_GEN_REACT_CITY_BUILT_GRANARY								= 74
define LC6_GEN_REACT_CITY_BUILT_SCENIC_TREES						= 75
define LC6_GEN_REACT_CITY_BUILT_NURSERY								= 76
define LC6_GEN_REACT_CITY_BUILT_FERTILITY_STATUE					= 77
define LC6_GEN_REACT_CITY_BUILT_MARKET								= 78
define LC6_GEN_REACT_CITY_BUILT_TAVERN								= 79
define LC6_GEN_REACT_CITY_BUILT_WALL								= 80
define LC6_GEN_REACT_CITY_BUILT_GATEHOUSE							= 81
define LC6_GEN_REACT_WAR_BUILT_ABODES								= 82
define LC6_GEN_REACT_WAR_BUILT_FIELDS								= 83
define LC6_GEN_REACT_WAR_BUILT_STORAGE_PIT							= 84
define LC6_GEN_REACT_WAR_BUILT_RANGED_ARMOURY						= 85
define LC6_GEN_REACT_WAR_BUILT_MELEE_ARMOURY						= 86
define LC6_GEN_REACT_WAR_BUILT_NURSERY								= 87
define LC6_GEN_REACT_WAR_BUILT_FERTILITY_STATUE						= 88
define LC6_GEN_REACT_WAR_BUILT_WALL									= 89
define LC6_GEN_REACT_WAR_BUILT_GATEHOUSE							= 90
define LC6_GEN_REACT_PLAYER_TAKES_BACK_TOWN							= 91
define LC6_GEN_REACT_GENERAL_TAKES_BACK_TOWN						= 92
define LC6_GEN_REACT_GENERAL_PLAYING_WAR_STYLE						= 93
define LC6_GEN_REACT_GENERAL_PLAYING_CITY_STYLE						= 94
define LC6_GEN_REACT_TO_PLAYER_BUILDING_HUT							= 95
define LC6_GEN_REACT_TO_PLAYER_BUILDING_HOUSE						= 96
define LC6_GEN_REACT_TO_PLAYER_BUILDING_VILLA						= 97
define LC6_GEN_REACT_TO_PLAYER_BUILDING_MANSION						= 98
define LC6_GEN_REACT_TO_PLAYER_BUILDING_MANOR						= 99
define LC6_GEN_REACT_TO_PLAYER_BUILDING_SKYSCRAPER					= 100
define LC6_GEN_REACT_TO_PLAYER_BUILDING_ALTAR						= 101
define LC6_GEN_REACT_TO_PLAYER_BUILDING_STOREHOUSE					= 102
define LC6_GEN_REACT_TO_PLAYER_BUILDING_FIELD						= 103
define LC6_GEN_REACT_TO_PLAYER_BUILDING_CREATURE_PEN				= 104
define LC6_GEN_REACT_TO_PLAYER_BUILDING_GATEHOUSE					= 105
define LC6_GEN_REACT_TO_PLAYER_BUILDING_GRAVEYARD					= 106
define LC6_GEN_REACT_TO_PLAYER_BUILDING_TAVERN						= 107
define LC6_GEN_REACT_TO_PLAYER_BUILDING_NURSERY						= 108
define LC6_GEN_REACT_TO_PLAYER_BUILDING_UNIVERSITY					= 109
define LC6_GEN_REACT_TO_PLAYER_BUILDING_RESTHOME					= 110
define LC6_GEN_REACT_TO_PLAYER_BUILDING_FORTIFIED_WALL				= 111
define LC6_GEN_REACT_TO_PLAYER_BUILDING_TEMPLE						= 112
define LC6_GEN_REACT_TO_PLAYER_BUILDING_LUMBERMILL					= 113
define LC6_GEN_REACT_TO_PLAYER_BUILDING_SMELTER						= 114
define LC6_GEN_REACT_TO_PLAYER_BUILDING_GRANARY						= 115
define LC6_GEN_REACT_TO_PLAYER_BUILDING_BATHOUSE					= 116
define LC6_GEN_REACT_TO_PLAYER_BUILDING_AMPHITHEATRE				= 117
define LC6_GEN_REACT_TO_PLAYER_BUILDING_PRISON						= 118

//--- Advisor Reaction States ---//
define LC6_ADV_REACT_ARRIVAL										= 1
define LC6_ADV_REACT_PLAYER_X_IMPRESSIVE_BUILDINGS					= 2
define LC6_ADV_REACT_PLAYER_CREATES_X_BREEDERS						= 3
define LC6_ADV_REACT_PLAYER_TAKES_ALL_MINOR_TOWNS_MOST_WITH_IMPRESS	= 4
define LC6_ADV_REACT_PLAYER_TAKEN_ALL_MINOR_TOWNS_MOST_WITH_FORCE	= 5
define LC6_ADV_REACT_PLAYERS_CREATURE_WINS_FIGHT					= 6
define LC6_ADV_REACT_PLAYER_CREATES_X_SOLDIERS						= 7
define LC6_ADV_REACT_JAPANESE_PLATOON_READY_TO_ATTACK_MONKS			= 8
define LC6_ADV_REACT_JAPANESE_PLATOON_DEAD_AFTER_ATTACKING_MONKS	= 9
define LC6_ADV_REACT_PLAYER_PLATOON_NEARS_UNFRIENDLY_MONKS			= 10
define LC6_ADV_REACT_EPILOGUE										= 11
define LC6_ADV_ADVISES_TO_BUILD_ARCHERY_ARMOURY						= 12
define LC6_ADV_TELL_ABOUT_ARMIES_EATING_TWICE_AS_MUCH				= 13
define LC6_ADV_TELL_ABOUT_BUILDING_WALL								= 14

define NUMBER_OF_GATE_HOUSES										= 3
define DOMTIME														= 400
define DOMSBIGTIME													= 600
//-----------------------------------------------------------------------------
//	Globals
//-----------------------------------------------------------------------------
// NOTE: ANY MORE TOWN ARRAYS NEED TO BE REORDERED IN: LC6_ReorderTownsSoNearestToJapaneseFirst
global LC6_WhoOwnsTown[L6_NUM_OF_MINOR_SETTLEMENTS]
global LC6_TakenTownByForceOrImpress[L6_NUM_OF_MINOR_SETTLEMENTS]
global LC6_TownOrSettlement[L6_NUM_OF_MINOR_SETTLEMENTS]

global LC6_TownActual[LC6_NUM_MINOR_TOWNS]						// This holds the minor towns in ascending order ie T1, T2, T3, T4, T5
global LC6_TownTakenOrder[LC6_NUM_MINOR_TOWNS]					// This holds the minor towns in the order they are taken over

global LC6_Wall[LC6_NUM_WALLS]
global LC6_WallPos[LC6_NUM_WALLS]

global LC6_JapaneseCreature							= 0
global LC6_JapaneseCreatureHelpsBuild				= LC6_FALSE
global LC6_MyCreatureWinsFight						= LC6_FALSE

global LC6_PlayerMinorTownTotal						= 0
global LC6_PlayerMinorSettlementTotal				= 0
global LC6_PlayerTakenTownForceTotal				= 0
global LC6_PlayerTakenTownImpressTotal				= 0

global LC6_GeneralMinorTownTotal					= 0
global LC6_GeneralMinorSettlementTotal				= 0
global LC6_GeneralTakenTownForceTotal				= 0
global LC6_GeneralTakenTownImpressTotal				= 0

global LC6_PlayerSwitchedForceToImpress				= LC6_FALSE
global LC6_PlayerSwitchedImpressToForce				= LC6_FALSE

global LC6_PlayerRetakeHappened						= LC6_FALSE
global LC6_GeneralRetakeHappened					= LC6_FALSE

global LC6_NumImpressiveBuildings					= 0
global LC6_JapaneseMonkPlatoon						= 0
global LC6_JapanesePlayingStyle						= 0
global LC6_SelectedPlayingStyle						= LC6_FALSE
global LC6_BuildingSetToUse							= 0
global LC6_Wonder									= 0
global LC6_WonderReady								= LC6_FALSE

global LC6_NumGuardingPlatoons						= 0
global LC6_NumAttackingPlatoons						= 0
global LC6_TypeOfPlatoon							= 0

global LC6_MeleeShouldBeBuiult						= LC6_FALSE
global LC6_RangedShouldBeBuiult						= LC6_FALSE
global LC6_CrossedMajinoLine						= LC6_FALSE

global LC6_PlayersInitialArchers					= 0
global LC6_GeneralsInitialArchers					= 0
global LC6_GeneralsInitialMelee						= 0
global LC6_GeneralsInitialArchersBusy				= LC6_FALSE
global LC6_GeneralsInitialMeleeBusy					= LC6_FALSE

global LC6_BuildWalls								= LC6_FALSE
global LC6_BuiltWallsAroundCapital					= LC6_FALSE

// Patrol / platoon stuff
global LC6_GuardingPlatoon[LC6_MAX_PLATOONS]
global LC6_AttackingPlatoon[LC6_MAX_PLATOONS]
global LC6_Catapult[LC6_MAX_CATAPULTS]
global LC6_PatrolRoute[LC6_MAX_PATROL_ROUTES]

global LC6_ShowDebug								= LC6_FALSE
global LC6_AlignmentPlatoon							= 0
global LC6_GeneralsInitialFireArchers				= 0
global LC6_SafeGuard1								= 0						// Guard the enemy capital
global LC6_SafeGuard2								= 0						// Guard the enemy capital
global LC6_DoneConvertWithSiren						= LC6_FALSE
global LC6_NeedResources							= LC6_TRUE
global LC6_SirenFired								= LC6_FALSE
global LC6_EnemyHasLotsOfArmies						= LC6_FALSE
//-----------------------------------------------------------------------------
//	Script defines
//-----------------------------------------------------------------------------
define script LC6_GetTownsAndCreatures
define script LC6_LandIntro
define script LC6_LandOutro
define script LC6_CreateDepartureScroll
define script LC6_OkToStartWonder

define script LC6_GeneralManagement(MonasteryPos)
define script LC6_AdvisorManagement(MonasteryPos)
define script LC6_ArmyManagement
define script LC6_CityManagement
define script LC6_CreatureManagement

define script LC6_BuildJapaneseWalls

define script LC6_GeneralReactions(ID)
define script LC6_AdvisorReactions(ID)

//--- Troop stuff ---//
define script LC6_SetupGenericPatrolRoutes
define script LC6_SetupIndividualPatrolRoute(Route, Pos1, Pos2, Pos3, Pos4, Pos5, Pos6, Pos7, Pos8, Pos9, Pos10)

define script LC6_ReorderTownsSoNearestToJapaneseFirst
define script LC6_RecruitPlatoons

define script LC6_UpdateMinorSettlementStats

define script LC6_ForceBuildingOfJapaneseArmoury(ArmouryType)

//--- Generals reactions to triggers ---//
define script LC6_GeneralResponds_PlayerTakesOneSettlement
define script LC6_GeneralResponds_PlayerTakesTwoSettlements
define script LC6_GeneralResponds_PlayerTakesThreeSettlements
define script LC6_GeneralResponds_PlayerTakesFourSettlements
define script LC6_GeneralResponds_PlayerTakesFiveSettlements

define script LC6_GeneralResponds_GeneralTakesOneSettlement
define script LC6_GeneralResponds_GeneralTakesTwoSettlements
define script LC6_GeneralResponds_GeneralTakesThreeSettlements
define script LC6_GeneralResponds_GeneralTakesFourSettlements
define script LC6_GeneralResponds_GeneralTakesFiveSettlements

define script LC6_GeneralResponds_PlayerTakesOneTown(TakeOverMethod, TownTaken)
define script LC6_GeneralResponds_PlayerTakesTwoTowns(TakeOverMethod, TownTaken)
define script LC6_GeneralResponds_PlayerTakesThreeTowns(TakeOverMethod, TownTaken)
define script LC6_GeneralResponds_PlayerTakesFourTowns(TakeOverMethod, TownTaken)
define script LC6_GeneralResponds_PlayerTakesFiveTowns(TakeOverMethod, TownTaken)

define script LC6_GeneralResponds_GeneralTakesOneTown
define script LC6_GeneralResponds_GeneralTakesTwoTowns
define script LC6_GeneralResponds_GeneralTakesThreeTowns
define script LC6_GeneralResponds_GeneralTakesFourTowns
define script LC6_GeneralResponds_GeneralTakesFiveTowns

define script LC6_GeneralResponds_PlayerCreatesPlatoon
define script LC6_GeneralResponds_PlayerReachesImpressiveThreshold_2
define script LC6_GeneralResponds_PlayerReachesImpressiveThreshold_3
define script LC6_GeneralResponds_PlayerSwitchedFromImpressToForce
define script LC6_GeneralResponds_PlayerSwitchedFromForceToImpress
define script LC6_GeneralResponds_PlayerCrossedMajinoLine
define script LC6_SetJapanesePlayingStyle(Style)

define script LC6_GivePLayerTributeForTakingTown(Town)
define script LC6_AddObjectives
define script LC6_RemoveObjective(Objective)

define script LC6_FireSiren(Pos)

define script LC6_AlignmentAttack
define script LC6_MoveArchersToHill
define script LC6_ShowSirenCutScene(Wonder)
define script LC6_GateManager

define script LC6_TributeManager
define script LC6_RoadBuilder
define script LC6_ResourceManager
define script LC6_ChargeWonder
define script LC6_CheckEnemiesArmySize
//-----------------------------------------------------------------------------
//	Script defines
//-----------------------------------------------------------------------------
begin script Land6JapaneseCapitalScript

	MonasteryPos			= marker at {0.000,0.000,0.000}

start
	// Get the various towns and creatures and do the general setup stuff
	run script LC6_GetTownsAndCreatures
	
	// Welcome to the land
	run script LC6_LandIntro
	run background script LC6_TributeManager
	run background script LC6_GateManager
	run background script LC6_ResourceManager
	run background script LC6_AlignmentAttack
	run background script LC6_CheckEnemiesArmySize
	// Setup the secondary objectives
	run background script LC6_AddObjectives
	run background script LC6_AdvisorReactions(LC6_ADV_ADVISES_TO_BUILD_ARCHERY_ARMOURY)

	// Run the army, city and dialogue management scripts
	run background script LC6_ArmyManagement
	run background script LC6_CityManagement	
	run background script LC6_GeneralManagement(MonasteryPos)
	run background script LC6_AdvisorManagement(MonasteryPos)
	run background script LC6_UpdateMinorSettlementStats
	
	// Loop until the Japanese home town is converted
	begin loop
	until L6CapitalConverted == LC6_TRUE
	end loop
	
	//TA: ADDING the completing of objectives here!
	if PLAYER of L6JapaneseCapital == LC6_GREEK
		set player 0 objective TRIBUTE_OBJECTIVE_SCRIPT_CONTROLLED_WIN_LAND with amount 1 text "BW2T_SCRIPT_07FINAL_SECONDARYOBJECTIVE_80" amount 1 description "BW2T_SCRIPT_06FINAL_SECONDARYOBJECTIVE_51" alignment -0.1		
	else
		set player 0 objective TRIBUTE_OBJECTIVE_SCRIPT_CONTROLLED_WIN_LAND with amount 1 text "BW2T_SCRIPT_07FINAL_SECONDARYOBJECTIVE_80" amount 1 description "BW2T_SCRIPT_06FINAL_SECONDARYOBJECTIVE_51" alignment 0.1				
	end if
	//Either way we have completed the land.
	set player 0 objective TRIBUTE_OBJECTIVE_SCRIPT_CONTROLLED_WIN_LAND value 1
	
	run background script LandOver(L6GreekTown)
	
	
	wait 2 seconds
	// We've won the land
	run script Land6Outro
	
	// Create the departure scroll
	//run script LC6_CreateDepartureScroll
	
end script Land6JapaneseCapitalScript


//-----------------------------------------------------------------------------
//	Handle the Japanese generals actions
//-----------------------------------------------------------------------------
begin script LC6_GeneralManagement(MonasteryPos)
	
	MArmoury							= 0
	RArmoury							= 0
	Platoon								= 0
	Catapult							= 0
	NearestTownToJapanese				= 0
	Dist								= 0
	Ctr									= 0
	CastEpicPos							= 0
	MinDistSoFar						= 10000
	
	DoneTakenFirstTown					= LC6_FALSE
	DoneTakenFirstSettlement			= LC6_FALSE
	DoneTakenSecondTown					= LC6_FALSE
	DoneTakenSecondSettlement			= LC6_FALSE
	DoneTakenThirdTown					= LC6_FALSE
	DoneTakenFourthTown					= LC6_FALSE
	DoneTakenFifthTown					= LC6_FALSE
	DoneTakenThirdSettlement			= LC6_FALSE
	DoneTakenFourthSettlement			= LC6_FALSE
	DoneTakenFifthSettlement			= LC6_FALSE
	DoneTakenSixthSettlement			= LC6_FALSE
	DoneSwitchImpressToForce			= LC6_FALSE
	DoneSwitchForceToImpress			= LC6_FALSE
	DoneImpressLevel_1					= LC6_FALSE
	DoneImpressLevel_2					= LC6_FALSE
	DoneImpressLevel_3					= LC6_FALSE
	DoneBuildArmoury					= LC6_FALSE
	DoneCreatePlatoon					= LC6_FALSE
	DoneCreateCatapult					= LC6_FALSE
	DoneUsedMagic						= LC6_FALSE
	DonePlayerKillsCreature				= LC6_FALSE
	DoneUsedCreatureOffensively			= LC6_FALSE
	DoneHighPop							= LC6_FALSE
	DoneTakeTownsByForce				= LC6_FALSE
	DoneConvertTroopsWithSiren			= LC6_FALSE
	DoneSirenWinWithImpress				= LC6_FALSE
	DonePlayerLookAtMonks				= LC6_FALSE
	DoneJapaneseAttackMonks				= LC6_FALSE
	DoneJapaneseKilledByMonks			= LC6_FALSE
	DoneAttackJapaneseHomeTown			= LC6_FALSE
	DoneAttackJapaneseCloseTown			= LC6_FALSE
	DoneGeneralTakenFirstSettlement		= LC6_FALSE
	DoneGeneralTakenSecondSettlement	= LC6_FALSE
	DoneGeneralTakenThirdSettlement		= LC6_FALSE
	DoneGeneralTakenFourthSettlement	= LC6_FALSE
	DoneGeneralTakenFifthSettlement		= LC6_FALSE
	DoneGeneralTakenFirstTown			= LC6_FALSE
	DoneGeneralTakenSecondTown			= LC6_FALSE
	DoneGeneralTakenThirdTown			= LC6_FALSE
	DoneGeneralTakenFourthTown			= LC6_FALSE
	DoneGeneralTakenFifthTown			= LC6_FALSE
	DoneEarlyMajinoLineCross			= LC6_FALSE
	DonePlayerRetakeTown				= LC6_FALSE
	DoneGeneralRetakeTown				= LC6_FALSE

	TakeOverMethod						= LC6_INVALID
	TownTaken							= 0
	Counter								= 0
start


	// Get the nearest town to the Japanese capital
	while Ctr < L6_NUM_OF_MINOR_SETTLEMENTS
		Dist = get distance from {L6JapaneseCapital} to {L6_MinorSettlement[Ctr]}
	
		if Dist < MinDistSoFar
			MinDistSoFar = Dist
			NearestTownToJapanese = L6_MinorSettlement[Ctr]
		end if
		
		Ctr++
	end while
	
	

	// Check to see if the different tasks have been met
	begin loop
		// GENERAL CHECKS
		
		//	LastCaptureEnum.h	-	for how the town was last captured
		//	LAST_CAPTURE_AGGRESSIVE                         =  1 ,
		//	LAST_CAPTURE_PASSIVE                            =  2 ,
		
		// Player minor settlement total checks
		// 1st settlement
		if LC6_PlayerMinorSettlementTotal == 1 and DoneTakenFirstSettlement == LC6_FALSE
			if variable get last settlement player LC6_GREEK method of last conversion == variable LAST_CAPTURE_AGGRESSIVE
				run script LC6_GeneralReactions(LC6_GEN_REACT_TAKE_FIRST_SETTLEMENT_ARM)
			else
				run script LC6_GeneralReactions(LC6_GEN_REACT_TAKE_FIRST_SETTLEMENT_IMP)
			end if		
			run background script LC6_GeneralResponds_PlayerTakesOneSettlement
			DoneTakenFirstSettlement = LC6_TRUE
		
		// 2nd settlement
		elsif LC6_PlayerMinorSettlementTotal == 2 and DoneTakenSecondSettlement == LC6_FALSE
			if variable get last settlement player LC6_GREEK method of last conversion == variable LAST_CAPTURE_AGGRESSIVE
				run script LC6_GeneralReactions(LC6_GEN_REACT_TAKE_SECOND_SETTLEMENT_ARM)
			else
				run script LC6_GeneralReactions(LC6_GEN_REACT_TAKE_SECOND_SETTLEMENT_IMP)
			end if
			run background script LC6_GeneralResponds_PlayerTakesTwoSettlements
			DoneTakenSecondSettlement = LC6_TRUE
		
		// 3rd settlement
		elsif LC6_PlayerMinorSettlementTotal == 3 and DoneTakenThirdSettlement == LC6_FALSE
			if variable get last settlement player LC6_GREEK method of last conversion == variable LAST_CAPTURE_AGGRESSIVE
				run script LC6_GeneralReactions(LC6_GEN_REACT_TAKE_THIRD_SETTLEMENT_ARM)
			else
				run script LC6_GeneralReactions(LC6_GEN_REACT_TAKE_THIRD_SETTLEMENT_IMP)
			end if
			run background script LC6_GeneralResponds_PlayerTakesThreeSettlements
			DoneTakenThirdSettlement = LC6_TRUE

		// 4th settlement
		elsif LC6_PlayerMinorSettlementTotal == 4 and DoneTakenFourthSettlement == LC6_FALSE
			if variable get last settlement player LC6_GREEK method of last conversion == variable LAST_CAPTURE_AGGRESSIVE
				run script LC6_GeneralReactions(LC6_GEN_REACT_TAKE_FOURTH_SETTLEMENT_ARM)
			else
				run script LC6_GeneralReactions(LC6_GEN_REACT_TAKE_FOURTH_SETTLEMENT_IMP)
			end if
			run background script LC6_GeneralResponds_PlayerTakesFourSettlements
			DoneTakenFourthSettlement = LC6_TRUE

		// 5th settlement
		elsif LC6_PlayerMinorSettlementTotal == 5 and DoneTakenFifthSettlement == LC6_FALSE
			if variable get last settlement player LC6_GREEK method of last conversion == variable LAST_CAPTURE_AGGRESSIVE
				run script LC6_GeneralReactions(LC6_GEN_REACT_TAKE_FIFTH_SETTLEMENT_ARM)
			else
				run script LC6_GeneralReactions(LC6_GEN_REACT_TAKE_FIFTH_SETTLEMENT_IMP)
			end if
			run background script LC6_GeneralResponds_PlayerTakesFiveSettlements
			DoneTakenFifthSettlement = LC6_TRUE

		elsif LC6_PlayerMinorSettlementTotal == 6 and DoneTakenSixthSettlement == LC6_FALSE
			run background script LC6_RemoveObjective(LC6_OBJECTIVE_TAKE_OVER_ALL_SETTLEMENTS)
			DoneTakenSixthSettlement = LC6_TRUE
		end if										// Player settlement total checks

		// Player crossed majino line early check
		if LC6_CrossedMajinoLine == LC6_TRUE and DoneEarlyMajinoLineCross == LC6_FALSE
			if LC6_PlayerMinorTownTotal < 1
				// Only do this reaction if they haven't taken the first 2 minor towns
				run background script LC6_GeneralReactions(LC6_GEN_REACT_CROSSED_MAJINO_LINE_EARLY_ARM)
				run background script LC6_GeneralResponds_PlayerCrossedMajinoLine
			end if
			DoneEarlyMajinoLineCross = LC6_TRUE
		end if										// Player crossed majino line early check



		// Get the town that has just been taken over
		if LC6_PlayerMinorTownTotal > 0
			// Find out which actual town we took over
			if LC6_TownTakenOrder[LC6_PlayerMinorTownTotal - 1] exists
				if LC6_TownTakenOrder[LC6_PlayerMinorTownTotal - 1] == LC6_TownActual[0]		// T1
					// This town taken over is the 1st town
					TownTaken = 1
					if LC6_ShowDebug == LC6_TRUE
//						say "INFO: Taken over town 1"
						wait until read
					end if
				elsif LC6_TownTakenOrder[LC6_PlayerMinorTownTotal - 1] == LC6_TownActual[1]		// T2
					// This town taken over is the 2nd town
					TownTaken = 2
					if LC6_ShowDebug == LC6_TRUE
//						say "INFO: Taken over town 2"
						wait until read
					end if
				elsif LC6_TownTakenOrder[LC6_PlayerMinorTownTotal - 1] == LC6_TownActual[2]		// T3
					// This town taken over is the 3rd town
					TownTaken = 3
					if LC6_ShowDebug == LC6_TRUE
//						say "INFO: Taken over town 3"
						wait until read
					end if
				elsif LC6_TownTakenOrder[LC6_PlayerMinorTownTotal - 1] == LC6_TownActual[3]		// T4
					// This town taken over is the 4th town
					TownTaken = 4
					if LC6_ShowDebug == LC6_TRUE
//						say "INFO: Taken over town 4"
						wait until read
					end if
				elsif LC6_TownTakenOrder[LC6_PlayerMinorTownTotal - 1] == LC6_TownActual[4]		// T5
					// This town taken over is the 5th town
					TownTaken = 5
					if LC6_ShowDebug == LC6_TRUE
//						say "INFO: Taken over town 5"
						wait until read
					end if
				else
					// Screwed up somewhere
					TownTaken = 0
				end if
			else
				if LC6_ShowDebug == LC6_TRUE
//					say "ERROR: We don't have a town taken when we are supposed to have."
					wait until read
				end if
			end if
		end if



		// Player minor town total checks
		// 1st town
		if LC6_PlayerMinorTownTotal == 1 and DoneTakenFirstTown == LC6_FALSE
			if variable get last town player LC6_GREEK method of last conversion == variable LAST_CAPTURE_AGGRESSIVE
				if LC6_CrossedMajinoLine == LC6_FALSE
					// As they haven't crossed the line the town taken can only be T1 or T2
					run script LC6_GeneralReactions(LC6_GEN_REACT_TAKE_TOWN_ONE_OR_TWO_BEFORE_RUSH_ARM)
				else
					// Get a response depending on which town the player took
					if TownTaken == 1 or TownTaken == 2
						run script LC6_GeneralReactions(LC6_GEN_REACT_TAKE_TOWN_ONE_AFTER_RUSH_ARM)
					else	// Taken town 3, 4, or 5 as the first town taken
						run script LC6_GeneralReactions(LC6_GEN_REACT_TAKE_TOWN_THREE_AFTER_TOWN_ONE_OR_TWO_ARM)
					end if
				end if
				TakeOverMethod = LC6_FORCE
			else
				run script LC6_GeneralReactions(LC6_GEN_REACT_TAKE_FIRST_TOWN_IMP)
				TakeOverMethod = LC6_IMPRESS
			end if
			run background script LC6_GivePLayerTributeForTakingTown(TownTaken)
			run background script LC6_GeneralResponds_PlayerTakesOneTown(TakeOverMethod, TownTaken)
			DoneTakenFirstTown = LC6_TRUE
			
		// 2nd town
		elsif LC6_PlayerMinorTownTotal == 2 and DoneTakenSecondTown == LC6_FALSE
			if variable get last town player LC6_GREEK method of last conversion == variable LAST_CAPTURE_AGGRESSIVE
				if LC6_CrossedMajinoLine == LC6_FALSE
					// As they haven't crossed the line the town taken can only be T1 or T2
					run script LC6_GeneralReactions(LC6_GEN_REACT_TAKE_OTHER_TOWN_BEFORE_RUSH_ARM)
				else
					// Get a response depending on which town the player took
					if TownTaken == 1 or TownTaken == 2
						run script LC6_GeneralReactions(LC6_GEN_REACT_TAKE_TOWN_TWO_AFTER_RUSH_ARM)
					else	// Taken town 3, 4, or 5 as the second town taken
						run script LC6_GeneralReactions(LC6_GEN_REACT_TAKE_TOWN_THREE_AFTER_TOWN_ONE_OR_TWO_ARM)
					end if
				end if
				TakeOverMethod = LC6_FORCE
			else
				run script LC6_GeneralReactions(LC6_GEN_REACT_TAKE_SECOND_TOWN_IMP)
				TakeOverMethod = LC6_IMPRESS
			end if
			run background script LC6_GivePLayerTributeForTakingTown(TownTaken)
			run background script LC6_GeneralResponds_PlayerTakesTwoTowns(TakeOverMethod, TownTaken)
			DoneTakenSecondTown = LC6_TRUE
			
		// 3rd town
		elsif LC6_PlayerMinorTownTotal == 3 and DoneTakenThirdTown == LC6_FALSE
			if variable get last town player LC6_GREEK method of last conversion == variable LAST_CAPTURE_AGGRESSIVE
				run script LC6_GeneralReactions(LC6_GEN_REACT_TAKE_TOWN_THREE_AFTER_TOWN_ONE_OR_TWO_ARM)
				TakeOverMethod = LC6_FORCE
			else
				run script LC6_GeneralReactions(LC6_GEN_REACT_TAKE_THIRD_TOWN_IMP)
				TakeOverMethod = LC6_IMPRESS
			end if
			run background script LC6_GivePLayerTributeForTakingTown(TownTaken)
			run background script LC6_GeneralResponds_PlayerTakesThreeTowns(TakeOverMethod, TownTaken)
			DoneTakenThirdTown = LC6_TRUE

		// 4th town
		elsif LC6_PlayerMinorTownTotal == 4 and DoneTakenFourthTown == LC6_FALSE
			if variable get last town player LC6_GREEK method of last conversion == variable LAST_CAPTURE_AGGRESSIVE
				run script LC6_GeneralReactions(LC6_GEN_REACT_TAKE_TOWN_FOUR_ARM)
				TakeOverMethod = LC6_FORCE
			else
				run script LC6_GeneralReactions(LC6_GEN_REACT_TAKE_FOURTH_TOWN_IMP)
				TakeOverMethod = LC6_IMPRESS
			end if
			run background script LC6_GivePLayerTributeForTakingTown(TownTaken)
			run background script LC6_GeneralResponds_PlayerTakesFourTowns(TakeOverMethod, TownTaken)
			DoneTakenFourthTown = LC6_TRUE

		// 5th town
		elsif LC6_PlayerMinorTownTotal == 5 and DoneTakenFifthTown == LC6_FALSE
			if variable get last town player LC6_GREEK method of last conversion == variable LAST_CAPTURE_AGGRESSIVE
				run script LC6_GeneralReactions(LC6_GEN_REACT_TAKE_TOWN_FIVE_ARM)
				TakeOverMethod = LC6_FORCE
			else
				run script LC6_GeneralReactions(LC6_GEN_REACT_TAKE_FIFTH_TOWN_IMP)
				TakeOverMethod = LC6_IMPRESS
			end if
			run background script LC6_GivePLayerTributeForTakingTown(TownTaken)
			run background script LC6_GeneralResponds_PlayerTakesFiveTowns(TakeOverMethod, TownTaken)
			DoneTakenFifthTown = LC6_TRUE
			
		// > 4th town and < all minor towns (includes both towns and settlements)
		elsif (LC6_PlayerMinorTownTotal + LC6_PlayerMinorSettlementTotal) > 4 and (LC6_PlayerMinorTownTotal + LC6_PlayerMinorSettlementTotal) < L6_NUM_OF_MINOR_SETTLEMENTS
			if LC6_PlayerSwitchedImpressToForce == LC6_TRUE and DoneSwitchImpressToForce == LC6_FALSE
				// Check for player switching from impressing to using force (only after fourth town taken) - LC6_GEN_REACT_PLAYER_SWITCHED_FROM_IMPRESS_TO_FORCE
				run script LC6_GeneralReactions(LC6_GEN_REACT_PLAYER_SWITCHED_FROM_IMPRESS_TO_FORCE)
				run background script LC6_GeneralResponds_PlayerSwitchedFromImpressToForce
				DoneSwitchImpressToForce = LC6_TRUE
				
			elsif LC6_PlayerSwitchedForceToImpress == LC6_TRUE and DoneSwitchForceToImpress == LC6_FALSE
				// Check for player switching from using force to impressing (only after fourth town taken) - LC6_GEN_REACT_PLAYER_SWITCHED_FROM_FORCE_TO_IMPRESS
				run script LC6_GeneralReactions(LC6_GEN_REACT_PLAYER_SWITCHED_FROM_FORCE_TO_IMPRESS)
				run background script LC6_GeneralResponds_PlayerSwitchedFromForceToImpress
				DoneSwitchForceToImpress = LC6_TRUE
			end if
			
		// All minor towns
		else
			// Player takes over all towns (force) check
			if LC6_PlayerTakenTownForceTotal >= (L6_NUM_OF_MINOR_SETTLEMENTS / 2) and DoneTakeTownsByForce == LC6_FALSE
				run script LC6_GeneralReactions(LC6_GEN_REACT_PLAYER_TAKEN_ALL_MINOR_TOWNS_MOST_WITH_FORCE)
				run script LC6_AdvisorReactions(LC6_ADV_REACT_PLAYER_TAKEN_ALL_MINOR_TOWNS_MOST_WITH_FORCE)
				DoneTakeTownsByForce = LC6_TRUE
			end if
		end if										// Player town total checks
		
		
		
		// General takes settlements
		// 1st settlement
		if LC6_GeneralMinorSettlementTotal == 1 and DoneGeneralTakenFirstSettlement == LC6_FALSE
			if variable get last settlement player LC6_JAPANESE method of last conversion == variable LAST_CAPTURE_AGGRESSIVE
				run script LC6_GeneralReactions(LC6_GEN_TAKES_FIRST_SETTLEMENT_ARM)
			else
				run script LC6_GeneralReactions(LC6_GEN_TAKES_FIRST_SETTLEMENT_IMP)
			end if
			run background script LC6_GeneralResponds_GeneralTakesOneSettlement
			DoneGeneralTakenFirstSettlement = LC6_TRUE
			
		// 2nd settlement
		elsif LC6_GeneralMinorSettlementTotal == 2 and DoneGeneralTakenSecondSettlement == LC6_FALSE
			if variable get last settlement player LC6_JAPANESE method of last conversion == variable LAST_CAPTURE_AGGRESSIVE
				run script LC6_GeneralReactions(LC6_GEN_TAKES_SECOND_SETTLEMENT_ARM)
			else
				run script LC6_GeneralReactions(LC6_GEN_TAKES_SECOND_SETTLEMENT_IMP)
			end if
			run background script LC6_GeneralResponds_GeneralTakesTwoSettlements
			DoneGeneralTakenSecondSettlement = LC6_TRUE
		
		// 3rd settlement			
		elsif LC6_GeneralMinorSettlementTotal == 3 and DoneGeneralTakenThirdSettlement == LC6_FALSE
			if variable get last settlement player LC6_JAPANESE method of last conversion == variable LAST_CAPTURE_AGGRESSIVE
				run script LC6_GeneralReactions(LC6_GEN_TAKES_THIRD_SETTLEMENT_ARM)
			else
				run script LC6_GeneralReactions(LC6_GEN_TAKES_THIRD_SETTLEMENT_IMP)
			end if
			run background script LC6_GeneralResponds_GeneralTakesThreeSettlements
			DoneGeneralTakenThirdSettlement = LC6_TRUE
		
		// 4th settlement
		elsif LC6_GeneralMinorSettlementTotal == 4 and DoneGeneralTakenFourthSettlement == LC6_FALSE
			if variable get last settlement player LC6_JAPANESE method of last conversion == variable LAST_CAPTURE_AGGRESSIVE
				run script LC6_GeneralReactions(LC6_GEN_TAKES_FOURTH_SETTLEMENT_ARM)
			else
				run script LC6_GeneralReactions(LC6_GEN_TAKES_FOURTH_SETTLEMENT_IMP)
			end if
			run background script LC6_GeneralResponds_GeneralTakesFourSettlements
			DoneGeneralTakenFourthSettlement = LC6_TRUE
			
		// 5th settlement
		elsif LC6_GeneralMinorSettlementTotal == 5 and DoneGeneralTakenFifthSettlement == LC6_FALSE
			if variable get last settlement player LC6_JAPANESE method of last conversion == variable LAST_CAPTURE_AGGRESSIVE
				run script LC6_GeneralReactions(LC6_GEN_TAKES_FIFTH_SETTLEMENT_ARM)
			else
				run script LC6_GeneralReactions(LC6_GEN_TAKES_FIFTH_SETTLEMENT_IMP)
			end if
			run background script LC6_GeneralResponds_GeneralTakesFiveSettlements
			DoneGeneralTakenFifthSettlement = LC6_TRUE
		end if										// General takes settlements
		

		
		// General takes towns
		// 1st town
		if LC6_GeneralMinorTownTotal == 1 and DoneGeneralTakenFirstTown == LC6_FALSE
			if variable get last town player LC6_JAPANESE method of last conversion == variable LAST_CAPTURE_AGGRESSIVE
				run script LC6_GeneralReactions(LC6_GEN_TAKES_FIRST_TOWN_ARM)
			else
				run script LC6_GeneralReactions(LC6_GEN_TAKES_FIRST_TOWN_IMP)
			end if
			run background script LC6_GeneralResponds_GeneralTakesOneTown
			DoneGeneralTakenFirstTown = LC6_TRUE
			
		// 2nd town
		elsif LC6_GeneralMinorTownTotal == 2 and DoneGeneralTakenSecondTown == LC6_FALSE
			if variable get last town player LC6_JAPANESE method of last conversion == variable LAST_CAPTURE_AGGRESSIVE
				run script LC6_GeneralReactions(LC6_GEN_TAKES_SECOND_TOWN_ARM)
			else
				run script LC6_GeneralReactions(LC6_GEN_TAKES_SECOND_TOWN_IMP)
			end if
			run background script LC6_GeneralResponds_GeneralTakesTwoTowns
			DoneGeneralTakenSecondTown = LC6_TRUE
			
		// 3rd town
		elsif LC6_GeneralMinorTownTotal == 3 and DoneGeneralTakenThirdTown == LC6_FALSE
			if variable get last town player LC6_JAPANESE method of last conversion == variable LAST_CAPTURE_AGGRESSIVE
				run script LC6_GeneralReactions(LC6_GEN_TAKES_THIRD_TOWN_ARM)
			else
				run script LC6_GeneralReactions(LC6_GEN_TAKES_THIRD_TOWN_IMP)
			end if
			run background script LC6_GeneralResponds_GeneralTakesThreeTowns
			DoneGeneralTakenThirdTown = LC6_TRUE

		// 4th town
		elsif LC6_GeneralMinorTownTotal == 4 and DoneGeneralTakenFourthTown == LC6_FALSE
			if variable get last town player LC6_JAPANESE method of last conversion == variable LAST_CAPTURE_AGGRESSIVE
				run script LC6_GeneralReactions(LC6_GEN_TAKES_FOURTH_TOWN_ARM)
			else
				run script LC6_GeneralReactions(LC6_GEN_TAKES_FOURTH_TOWN_IMP)
			end if
			run background script LC6_GeneralResponds_GeneralTakesFourTowns
			DoneGeneralTakenFourthTown = LC6_TRUE

		// 5th town
		elsif LC6_GeneralMinorTownTotal == 5 and DoneGeneralTakenFifthTown == LC6_FALSE
			if variable get last town player LC6_JAPANESE method of last conversion == variable LAST_CAPTURE_AGGRESSIVE
				run script LC6_GeneralReactions(LC6_GEN_TAKES_FIFTH_TOWN_ARM)
			else
				run script LC6_GeneralReactions(LC6_GEN_TAKES_FIFTH_TOWN_IMP)
			end if
			run background script LC6_GeneralResponds_GeneralTakesFiveTowns
			DoneGeneralTakenFifthTown = LC6_TRUE
		end if										// General takes towns



		// Player impressive checks
		// Impressive level 1
		if get town L6GreekTown impressiveness >= LC6_AMOUNT_IMPRESSIVE_LEVEL_1_THRESHOLD and DoneImpressLevel_1 == LC6_FALSE
			run script LC6_GeneralReactions(LC6_GEN_REACT_IMPRESSIVE_LEVEL_1)
			DoneImpressLevel_1 = LC6_TRUE
		
		// Impressive level 2
		elsif get town L6GreekTown impressiveness >= LC6_AMOUNT_IMPRESSIVE_LEVEL_2_THRESHOLD and DoneImpressLevel_2 == LC6_FALSE
			run script LC6_GeneralReactions(LC6_GEN_REACT_IMPRESSIVE_LEVEL_2)
			run background script LC6_GeneralResponds_PlayerReachesImpressiveThreshold_2
			DoneImpressLevel_2 = LC6_TRUE
		
		// Impressive level 3
		elsif get town L6GreekTown impressiveness >= LC6_AMOUNT_IMPRESSIVE_LEVEL_3_THRESHOLD and DoneImpressLevel_3 == LC6_FALSE
			run script LC6_GeneralReactions(LC6_GEN_REACT_IMPRESSIVE_LEVEL_3)
			run background script LC6_GeneralResponds_PlayerReachesImpressiveThreshold_3
			DoneImpressLevel_3 = LC6_TRUE
		end if										// Player impressive checks
		
		
		
		// Player build armoury check
		if DoneBuildArmoury == LC6_FALSE
			MArmoury = get building ABODE_NUMBER_MELEE_ARMOURY in L6GreekTown min built 1.0
			RArmoury = get building ABODE_NUMBER_RANGED_ARMOURY in L6GreekTown min built 1.0
			
			if MArmoury exists or RArmoury exists
				run script LC6_GeneralReactions(LC6_GEN_REACT_PLAYER_BUILDS_ARMOURY)
				DoneBuildArmoury = LC6_TRUE
			end if
		end if										// Player build armoury check
		
		
		
		// Player creates platoon check
		if DoneCreatePlatoon == LC6_FALSE
			Platoon = get platoon of type SCRIPT_FIND_TYPE_ANY of town L6GreekTown excluding scripted
			
			if Platoon exists
				if not Platoon recruiting
					run script LC6_GeneralReactions(LC6_GEN_REACT_PLAYER_CREATES_THEIR_FIRST_PLATOON)
					run background script LC6_GeneralResponds_PlayerCreatesPlatoon
					DoneCreatePlatoon = LC6_TRUE
				end if
			end if
		end if										// Player creates platoon check
		

		
		// Player creates catapult check
		if DoneCreateCatapult == LC6_FALSE
			Catapult = get number of type SCRIPT_OBJECT_TYPE_SIEGE_WEAPON in L6GreekTown min built 1.0
			
			if Catapult >= 1
				run script LC6_GeneralReactions(LC6_GEN_REACT_PLAYER_CREATES_THEIR_FIRST_CATAPULT)
				DoneCreateCatapult = LC6_TRUE
			end if
		end if										// Player creates catapult check

		
		
		// Player uses magic check
		if DoneUsedMagic == LC6_FALSE
			// MIRACLE_TYPE_HEAL
			if player LC6_GREEK cast miracle SCRIPT_FIND_TYPE_ANY near {L6JapaneseCapital} radius 500
				run script LC6_GeneralReactions(LC6_GEN_REACT_PLAYER_USES_MAGIC_FIRST_TIME)
				DoneUsedMagic = LC6_TRUE
			end if			
		end if										// Player uses magic check
		
		
/*		
		// Player kills enemy creature check
		if LC6_JapaneseCreature not exists and DonePlayerKillsCreature == LC6_FALSE
			run script LC6_GeneralReactions(LC6_GEN_REACT_PLAYER_KILLS_ENEMY_CREATURE)
			increment tribute by 1000
			DonePlayerKillsCreature = LC6_TRUE
		end if										// Player kills enemy creature check
*/		
		
		
		// Player uses his creature offensively
		if DoneUsedCreatureOffensively == LC6_FALSE
			if MyCreature exists and {MyCreature} near {L6JapaneseCapital} radius 100
				run script LC6_GeneralReactions(LC6_GEN_REACT_PLAYER_USES_CREATURE_OFFENSIVELY_FIRST_TIME)
				DoneUsedCreatureOffensively = LC6_TRUE
			end if
		end if										// Player uses his creture offensively
		
		
		
		// Player population check
		if size of L6GreekTown >= LC6_NUM_POPULATION_NEEDED and DoneHighPop == LC6_FALSE
			run script LC6_GeneralReactions(LC6_GEN_REACT_PLAYER_POPULATION_EXPANDS_TO_X)
			run background script LC6_RemoveObjective(LC6_OBJECTIVE_REACH_POP)
			increment tribute by 1000			
			DoneHighPop = LC6_TRUE
		end if										// Player population check
		
		
				
		// Wonder ready - convert attacking troops - player trying to win with impress
		if LC6_WonderReady == LC6_TRUE and LC6_DoneConvertWithSiren == LC6_FALSE
			// Convert attacking troops
			// TODO: Need to check all platoons and see if it's a big enough attack
			Platoon = get platoon of player LC6_GREEK nearest {L6JapaneseCapital} radius 200
			
			if Platoon exists //and DoneConvertTroopsWithSiren == LC6_FALSE
				CastEpicPos = marker at {Platoon}
				LC6_DoneConvertWithSiren = LC6_TRUE
				run background script LC6_FireSiren(CastEpicPos)
				//DoneConvertTroopsWithSiren = LC6_TRUE
				
							
			// Player trying to win with impress
			elsif LC6_PlayerMinorTownTotal >= 5 and LC6_PlayerTakenTownImpressTotal > LC6_PlayerTakenTownForceTotal 
				Counter = 0
				while Counter < L6_NUM_OF_MINOR_SETTLEMENTS
					if adult size of L6_AlexsMinorSettlement[Counter] > 10 and PLAYER of L6_AlexsMinorSettlement[Counter] != 1
						CastEpicPos = marker at {L6_AlexsMinorSettlement[Counter]} + {10, 10}
						LC6_DoneConvertWithSiren = LC6_TRUE
						run background script LC6_FireSiren(CastEpicPos)
					end if
					Counter++
				end while
			end if			
		end if										// Wonder ready - convert attacking troops - player trying to win with impress
		
		
		
		// Player inspects monks
		/*if camera position near {MonasteryPos} radius 50 and {MonasteryPos} viewed and DonePlayerLookAtMonks == LC6_FALSE
			run script LC6_GeneralReactions(LC6_GEN_REACT_PLAYER_INVESTIGATES_MONKS)
			DonePlayerLookAtMonks = LC6_TRUE
		end if*/										// Player inspects monks
		
		
		
		// Japanese attack monks and Japanese defeated by monks
		/*if DoneJapaneseAttackMonks == LC6_FALSE
			// Japanese attack monks
			Platoon = get platoon of player LC6_JAPANESE nearest {MonasteryPos} radius 50
			
			if Platoon exists
				run script LC6_GeneralReactions(LC6_GEN_REACT_JAPANESE_PLATOON_READY_TO_ATTACK_MONKS)
				run script LC6_AdvisorReactions(LC6_ADV_REACT_JAPANESE_PLATOON_READY_TO_ATTACK_MONKS)
				LC6_JapaneseMonkPlatoon = Platoon
				DoneJapaneseAttackMonks = LC6_TRUE
			end if									// Japanese attack monks
			
		else
			// Japanese defeated by monks
			if LC6_JapaneseMonkPlatoon not exists and DoneJapaneseKilledByMonks == LC6_FALSE
				run script LC6_GeneralReactions(LC6_GEN_REACT_JAPANESE_PLATOON_DEAD_AFTER_ATTACKING_MONKS)
				run script LC6_AdvisorReactions(LC6_ADV_REACT_JAPANESE_PLATOON_DEAD_AFTER_ATTACKING_MONKS)
				DoneJapaneseKilledByMonks = LC6_TRUE
			end if									// Japanese defeated by monks
		end if*/
		
		
		
		// Attacking Japanese home town
		if DoneAttackJapaneseHomeTown == LC6_FALSE
			Platoon = get platoon of player LC6_GREEK nearest {L6JapaneseCapital} radius 50
			
			if Platoon exists
				run script LC6_GeneralReactions(LC6_GEN_REACT_PLAYER_ATTACKS_JAPANESE_HOME_TOWN)
				DoneAttackJapaneseHomeTown = LC6_TRUE
			end if
		end if										// Attacking Japanese home town
		
		
		
		// Player getting close to Japanese town
		if DoneAttackJapaneseCloseTown == LC6_FALSE
			Platoon = get platoon of player LC6_GREEK nearest {NearestTownToJapanese} radius 50
			
			if Platoon exists
				run script LC6_GeneralReactions(LC6_GEN_REACT_PLAYER_ATTACKS_JAPANESE_CLOSE_MINOR_TOWNS)
				DoneAttackJapaneseCloseTown = LC6_TRUE
			end if
		end if										// Player getting close to Japanese town
		

		
		// Player retakes town check
		if LC6_PlayerRetakeHappened == LC6_TRUE and DonePlayerRetakeTown == LC6_FALSE
			run script LC6_GeneralReactions(LC6_GEN_REACT_PLAYER_TAKES_BACK_TOWN)
			DonePlayerRetakeTown = LC6_TRUE
		end if										// Player retakes town check



		// General retakes town check
		if LC6_GeneralRetakeHappened == LC6_TRUE and DoneGeneralRetakeTown == LC6_FALSE
			run script LC6_GeneralReactions(LC6_GEN_REACT_GENERAL_TAKES_BACK_TOWN)
			DoneGeneralRetakeTown = LC6_TRUE
		end if										// General retakes town check



		// FINAL CHECK - to see if the player has taken over the Japanese home town
		if PLAYER of L6JapaneseCapital == LC6_GREEK or variable get town L6JapaneseCapital status == variable TOWN_STATUS_MIGRATION_STARTED		
			L6CapitalConverted = LC6_TRUE
		end if
			
	until L6CapitalConverted == LC6_TRUE
	end loop

end script LC6_GeneralManagement


//-----------------------------------------------------------------------------
//	Handles the unique advisor comments (any that follow the enemy general appear in that management script)
//-----------------------------------------------------------------------------
begin script LC6_AdvisorManagement(MonasteryPos)

	BreederTotal						= 0
	Platoon								= 0
	ObjectUnderHand						= 0
	
	DoneBuiltEnoughImpressive			= LC6_FALSE
	DoneCreatedEnoughBreeders			= LC6_FALSE
	DoneTakeTownsByImpressive			= LC6_FALSE
	DonePlayerCreatureWonFirstFight		= LC6_FALSE
	DonePlayerCreatedEnoughSoldiers		= LC6_FALSE
	DonePlaterApproachingMonks			= LC6_FALSE
	DoneArmiesEachMore					= LC6_FALSE
	DoneWallReminder					= LC6_FALSE

	ArmiesReminder						= create timer for 60 seconds
	WallReminder						= create timer for 30 seconds

start

	// Check to see if the different tasks have been met
	begin loop
		// ADVISOR CHECKS
		
		// Impressive building check
		if LC6_NumImpressiveBuildings >= LC6_NUM_IMPRESSIVE_BUILDINGS_NEEDED and DoneBuiltEnoughImpressive == LC6_FALSE
			run script LC6_AdvisorReactions(LC6_ADV_REACT_PLAYER_X_IMPRESSIVE_BUILDINGS)
			//TA: This objective is no longer in the design.
			//run background script LC6_RemoveObjective(LC6_OBJECTIVE_BUILD_IMPRESSIVE_BUILDINGS)
			//increment tribute by 1000			
			DoneBuiltEnoughImpressive = LC6_TRUE
		end if										// Impressive building check



		// Player breeder check
		if DoneCreatedEnoughBreeders == LC6_FALSE
		
			if player 0 objective TRIBUTE_OBJECTIVE_MAKE_BREEDER_DISCIPLES complete
				run script LC6_AdvisorReactions(LC6_ADV_REACT_PLAYER_CREATES_X_BREEDERS)
				run background script LC6_RemoveObjective(LC6_OBJECTIVE_MAKE_BREEDERS)				
				DoneCreatedEnoughBreeders = LC6_TRUE
			end if
		end if										// Player breeder check
		
		
		
		// Player takes all towns (mostly impress)
		if LC6_PlayerMinorTownTotal >= L6_NUM_OF_MINOR_SETTLEMENTS and DoneTakeTownsByImpressive == LC6_FALSE
			if LC6_PlayerTakenTownImpressTotal > (L6_NUM_OF_MINOR_SETTLEMENTS / 2)
				run script LC6_AdvisorReactions(LC6_ADV_REACT_PLAYER_TAKES_ALL_MINOR_TOWNS_MOST_WITH_IMPRESS)
				increment tribute by 1000				
				DoneTakeTownsByImpressive = LC6_TRUE
			end if
		end if										// Player takes all towns (mostly impress)
		
		
/*
		// Player creature wins first fight
		if LC6_MyCreatureWinsFight == LC6_TRUE and DonePlayerCreatureWonFirstFight == LC6_FALSE
			run script LC6_AdvisorReactions(LC6_ADV_REACT_PLAYERS_CREATURE_WINS_FIGHT)
			increment tribute by 1000			
			DonePlayerCreatureWonFirstFight = LC6_TRUE
		end if										// Player creature wins first fight
*/
		
		
		// Player created soldiers check
		if player 0 objective TRIBUTE_OBJECTIVE_CREATE_PLATOONS complete and DonePlayerCreatedEnoughSoldiers == LC6_FALSE
			run script LC6_AdvisorReactions(LC6_ADV_REACT_PLAYER_CREATES_X_SOLDIERS)			
			//TA: This adivser comment is now out of date?!?
			run background script LC6_RemoveObjective(LC6_ADV_REACT_PLAYER_CREATES_X_SOLDIERS)
			DonePlayerCreatedEnoughSoldiers = LC6_TRUE
		end if										// Player created soldiers check
		
		
		
		// TODO: Need to add the check to see if the monks challenge has been completed
		// Player going near unfriendly monks
		if DonePlaterApproachingMonks == LC6_FALSE
			Platoon = get platoon of player LC6_GREEK nearest {MonasteryPos} radius 50
			
			if Platoon exists
				run script LC6_AdvisorReactions(LC6_ADV_REACT_PLAYER_PLATOON_NEARS_UNFRIENDLY_MONKS)
				DonePlaterApproachingMonks = LC6_TRUE
			end if
		end if										// Player going near unfriendly monks



		// Armies eating more food
		if DoneArmiesEachMore == LC6_FALSE
			ObjectUnderHand = get object hand is over
			if ObjectUnderHand exists
				if variable get ObjectUnderHand type == variable SOLDIER //get ArmiesReminder time remaining <= 0 or 
					run script LC6_AdvisorReactions(LC6_ADV_TELL_ABOUT_ARMIES_EATING_TWICE_AS_MUCH)
					DoneArmiesEachMore = LC6_TRUE
				end if
			end if
		end if										// Armies eating more food



		// Build wall
		if DoneWallReminder == LC6_FALSE
			if get WallReminder time remaining <= 0
				run script LC6_AdvisorReactions(LC6_ADV_TELL_ABOUT_BUILDING_WALL)
				DoneWallReminder = LC6_TRUE
			end if
		end if
		
	until L6CapitalConverted == LC6_TRUE
	end loop		

end script LC6_AdvisorManagement


//-----------------------------------------------------------------------------
//	The general responds to the player taking over 1 settlement
//-----------------------------------------------------------------------------
begin script LC6_GeneralResponds_PlayerTakesOneSettlement
start
end script LC6_GeneralResponds_PlayerTakesOneSettlement


//-----------------------------------------------------------------------------
//	The general responds to the player taking over 2 settlements
//-----------------------------------------------------------------------------
begin script LC6_GeneralResponds_PlayerTakesTwoSettlements
start
end script LC6_GeneralResponds_PlayerTakesTwoSettlements


//-----------------------------------------------------------------------------
//	The general responds to the player taking over 3 settlements
//-----------------------------------------------------------------------------
begin script LC6_GeneralResponds_PlayerTakesThreeSettlements
start	
end script LC6_GeneralResponds_PlayerTakesThreeSettlements


//-----------------------------------------------------------------------------
//	The general responds to the player taking over 4 settlements
//-----------------------------------------------------------------------------
begin script LC6_GeneralResponds_PlayerTakesFourSettlements
start
end script LC6_GeneralResponds_PlayerTakesFourSettlements


//-----------------------------------------------------------------------------
//	The general responds to the player taking over 5 settlements
//-----------------------------------------------------------------------------
begin script LC6_GeneralResponds_PlayerTakesFiveSettlements
start
end script LC6_GeneralResponds_PlayerTakesFiveSettlements


//-----------------------------------------------------------------------------
//	The general responds to the player taking over 1 town
//-----------------------------------------------------------------------------
begin script LC6_GeneralResponds_PlayerTakesOneTown(TakeOverMethod, TownTaken)

	TownForGeneralToTake		= 0
	PutArchersOnWalls			= LC6_FALSE

	Target						= 0
	DIST						= 40
	
	WP_1						= 0
	WP_2						= 0
	WP_3						= 0
	WP_4						= 0
	WP_5						= 0
	WP_6						= 0
	WP_7						= 0
	WP_8						= 0
	WP_9						= 0
	WP_10						= 0
	
	Ctr							= 0
	
	// TEMP:
	SFX							= 0

start

	// Has the player rushed straight towards town 3 or beyond?
	if LC6_CrossedMajinoLine == LC6_FALSE
		// The player still hasn't rushed forward so the town taken can only be T1 or T2
		// General responds by taking town 5
		if TakeOverMethod == LC6_IMPRESS
			if LC6_JapanesePlayingStyle == LC6_CITY
				// TEMP: Need a response for this, for now just make them take over T5
				TownForGeneralToTake = 5
			else
				TownForGeneralToTake = 5
			end if
		else
			if LC6_JapanesePlayingStyle == LC6_CITY
				// TEMP: Need a response for this, for now just make them take over T5
				TownForGeneralToTake = 5
			else
				TownForGeneralToTake = 5
			end if
		end if

	else
		// The player made a rush for it and possibly backtracked, stopped where they are or pushed on

		// Handle the responses
		if TakeOverMethod == LC6_IMPRESS
			if LC6_JapanesePlayingStyle == LC6_CITY
				// TEMP: Need a response for this, for now do nothing...
				if TownTaken == 1 or TownTaken == 2
				elsif TownTaken == 3
				elsif TownTaken == 4
				elsif TownTaken == 5
				end if

				TownForGeneralToTake = 5

			else																// War style being played
				if TownTaken == 1 or TownTaken == 2
					// Player has backtracked, general responds by taking town 4
					TownForGeneralToTake = 4
					PutArchersOnWalls = LC6_TRUE
				elsif TownTaken == 3
					// Player has stopped at town 3, general responds by attacking town 3
					TownForGeneralToTake = 3
				elsif TownTaken == 4
					// Player has pushed on, general goes to meet threat
					TownForGeneralToTake = 4
				elsif TownTaken == 5
					// Player has pushed on, general goes to meet threat
					TownForGeneralToTake = 5
				end if
			end if

		else																	// Taken over by force
			if LC6_JapanesePlayingStyle == LC6_CITY
				// TEMP: Need a response for this, for now do nothing...
				if TownTaken == 1 or TownTaken == 2
				elsif TownTaken == 3
				elsif TownTaken == 4
				elsif TownTaken == 5
				end if
				
				TownForGeneralToTake = 5

			else																// War style being played
				if TownTaken == 1 or TownTaken == 2
					// Player has backtracked, general responds by taking town 4
					TownForGeneralToTake = 4
					PutArchersOnWalls = LC6_TRUE
				elsif TownTaken == 3
					// Player has stopped at town 3, general responds by attacking town 3
					TownForGeneralToTake = 3
				elsif TownTaken == 4
					// Player has pushed on, general goes to meet threat
					TownForGeneralToTake = 4
				elsif TownTaken == 5
					// Player has pushed on, general goes to meet threat
					TownForGeneralToTake = 5
				end if
			end if
		end if
	end if

	// Do the actual responses
	if TownForGeneralToTake > 0
		// Recruit the melee platoons
		run script LC6_ForceBuildingOfJapaneseArmoury(variable ABODE_NUMBER_MELEE_ARMOURY)

		// Make sure we don't go over the platoon limit
		if LC6_NumAttackingPlatoons + 2 <= LC6_MAX_PLATOONS
			LC6_NumAttackingPlatoons += 2
		else
			LC6_NumAttackingPlatoons = 2
		end if

		LC6_TypeOfPlatoon = variable ARMY_UNIT_TYPE_MELEE_2	
		wait until LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 1] exists
		wait until LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 2] exists
		wait until not LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 1] recruiting
		wait until not LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 2] recruiting
		clear LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 1] action queue
		clear LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 2] action queue

		// Setup the target
		Target = LC6_TownActual[TownForGeneralToTake - 1]

		// Recruit a platoon and send them off to take over a nearby town
		WP_1	= marker at get target from {0,0,0} to {Target} distance DIST angle 0
		WP_2	= marker at get target from {0,0,0} to {Target} distance DIST angle 45
		WP_3	= marker at get target from {0,0,0} to {Target} distance DIST angle 90
		WP_4	= marker at get target from {0,0,0} to {Target} distance DIST angle 135
		WP_5	= marker at get target from {0,0,0} to {Target} distance DIST angle 180
		WP_6	= marker at get target from {0,0,0} to {Target} distance DIST angle 225
		WP_7	= marker at get target from {0,0,0} to {Target} distance DIST angle 270
		WP_8	= marker at get target from {0,0,0} to {Target} distance DIST angle 315
		WP_9	= 0
		WP_10	= 0
		run script LC6_SetupIndividualPatrolRoute(10, WP_1, WP_2, WP_3, WP_4, WP_5, WP_6, WP_7, WP_8, WP_9, WP_10)
		
		if LC6_ShowDebug == LC6_TRUE
			SFX = create visual effect "gp_s_townctr_beam.ves" strength 0.1 scale 0.6 at {WP_1} time -1
			SFX = create visual effect "gp_s_townctr_beam.ves" strength 0.1 scale 0.6 at {WP_2} time -1
			SFX = create visual effect "gp_s_townctr_beam.ves" strength 0.1 scale 0.6 at {WP_3} time -1
			SFX = create visual effect "gp_s_townctr_beam.ves" strength 0.1 scale 0.6 at {WP_4} time -1
			SFX = create visual effect "gp_s_townctr_beam.ves" strength 0.1 scale 0.6 at {WP_5} time -1
			SFX = create visual effect "gp_s_townctr_beam.ves" strength 0.1 scale 0.6 at {WP_6} time -1
			SFX = create visual effect "gp_s_townctr_beam.ves" strength 0.1 scale 0.6 at {WP_7} time -1
			SFX = create visual effect "gp_s_townctr_beam.ves" strength 0.1 scale 0.6 at {WP_8} time -1
		end if

		add action PLATOON_AGENDA_ACTION_ATTACK_TOWN_CENTRE_FOR_TAKE_OVER using Target to LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 1] action queue
		move LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 1] along LC6_PatrolRoute[3] with patrol WAYPOINTROUTE_TRAVERSAL_TYPE_CIRCULAR
		move LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 2] along LC6_PatrolRoute[10] with patrol WAYPOINTROUTE_TRAVERSAL_TYPE_CIRCULAR

		// Recruit the archer platoons and put them on the walls if any walls exist
		Ctr = 0
		Target = 0
		force while Ctr < 6 and Target == 0
			if LC6_Wall[Ctr] exists and BUILT of LC6_Wall[Ctr] >= 1.0
				Target = LC6_Wall[Ctr]
				
			end if
			Ctr++
		end while

		if PutArchersOnWalls == LC6_TRUE and Target != 0
			run script LC6_ForceBuildingOfJapaneseArmoury(variable ABODE_NUMBER_RANGED_ARMOURY)
			if LC6_GeneralsInitialArchersBusy == LC6_FALSE
				add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Target to LC6_GeneralsInitialArchers action queue
				LC6_GeneralsInitialArchersBusy = LC6_TRUE
			else
				// Make sure we don't go over the platoon limit
				if LC6_NumGuardingPlatoons + 1 < LC6_MAX_PLATOONS
					LC6_NumGuardingPlatoons += 1
				else
					LC6_NumGuardingPlatoons = 1
				end if

				LC6_TypeOfPlatoon = variable ARMY_UNIT_TYPE_RANGED_2	
				wait until LC6_GuardingPlatoon[LC6_NumGuardingPlatoons - 1] exists
				wait until not LC6_GuardingPlatoon[LC6_NumGuardingPlatoons - 1] recruiting
				clear LC6_GuardingPlatoon[LC6_NumGuardingPlatoons - 1] action queue
				add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Target to LC6_GuardingPlatoon[LC6_NumGuardingPlatoons - 1] action queue
			end if
		end if
	end if

end script LC6_GeneralResponds_PlayerTakesOneTown


//-----------------------------------------------------------------------------
//	The general responds to the player taking over 2 towns
//-----------------------------------------------------------------------------
begin script LC6_GeneralResponds_PlayerTakesTwoTowns(TakeOverMethod, TownTaken)

	TownForGeneralToTake		= 0
	PutArchersOnWalls			= LC6_FALSE

	Target						= 0
	DIST						= 40
	
	WP_1						= 0
	WP_2						= 0
	WP_3						= 0
	WP_4						= 0
	WP_5						= 0
	WP_6						= 0
	WP_7						= 0
	WP_8						= 0
	WP_9						= 0
	WP_10						= 0
	
	Ctr							= 0
	
	// TEMP:
	SFX							= 0

start

	// Has the player rushed straight towards town 3 or beyond?
	if LC6_CrossedMajinoLine == LC6_FALSE
		// The player still hasn't rushed forward so the town taken can only be T1 or T2
		// General responds by taking town 4 as he took town 5 the last time
		if TakeOverMethod == LC6_IMPRESS
			if LC6_JapanesePlayingStyle == LC6_CITY
				// TEMP: Need a response for this, for now just make them take over T5
				TownForGeneralToTake = 4
			else
				TownForGeneralToTake = 4
			end if
		else
			if LC6_JapanesePlayingStyle == LC6_CITY
				// TEMP: Need a response for this, for now just make them take over T5
				TownForGeneralToTake = 4
			else
				TownForGeneralToTake = 4
			end if
		end if

	else
		// The player made a rush for it and possibly backtracked, stopped where they are or pushed on

		// Handle the responses
		if TakeOverMethod == LC6_IMPRESS
			if LC6_JapanesePlayingStyle == LC6_CITY
				// TEMP: Need a response for this, for now do nothing...
				if TownTaken == 1 or TownTaken == 2
				elsif TownTaken == 3
				elsif TownTaken == 4
				elsif TownTaken == 5
				end if

				TownForGeneralToTake = 4

			else																// War style being played
				if TownTaken == 1 or TownTaken == 2
					// Player has backtracked, general responds by taking town 5
					TownForGeneralToTake = 4
					PutArchersOnWalls = LC6_TRUE
				elsif TownTaken == 3
					// Player has stopped at town 3, general responds by attacking town 3
					TownForGeneralToTake = 3
				elsif TownTaken == 4
					// Player has pushed on, general goes to meet threat
					TownForGeneralToTake = 4
				elsif TownTaken == 5
					// Player has pushed on, general goes to meet threat
					TownForGeneralToTake = 5
				end if
			end if

		else																	// Taken over by force
			if LC6_JapanesePlayingStyle == LC6_CITY
				// TEMP: Need a response for this, for now do nothing...
				if TownTaken == 1 or TownTaken == 2
				elsif TownTaken == 3
				elsif TownTaken == 4
				elsif TownTaken == 5
				end if
				
				TownForGeneralToTake = 4

			else																// War style being played
				if TownTaken == 1 or TownTaken == 2
					// Player has backtracked, general responds by taking town 5
					TownForGeneralToTake = 4
					PutArchersOnWalls = LC6_TRUE
				elsif TownTaken == 3
					// Player has stopped at town 3, general responds by attacking town 3
					TownForGeneralToTake = 3
				elsif TownTaken == 4
					// Player has pushed on, general goes to meet threat
					TownForGeneralToTake = 4
				elsif TownTaken == 5
					// Player has pushed on, general goes to meet threat
					TownForGeneralToTake = 5
				end if
			end if
		end if
	end if

	// Do the actual responses
	if TownForGeneralToTake > 0
		// Recruit the melee platoons
		run script LC6_ForceBuildingOfJapaneseArmoury(variable ABODE_NUMBER_MELEE_ARMOURY)

		// Make sure we don't go over the platoon limit
		if LC6_NumAttackingPlatoons + 2 <= LC6_MAX_PLATOONS
			LC6_NumAttackingPlatoons += 2
		else
			LC6_NumAttackingPlatoons = 2
		end if

		LC6_TypeOfPlatoon = variable ARMY_UNIT_TYPE_MELEE_2	
		wait until LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 1] exists
		wait until LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 2] exists
		wait until not LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 1] recruiting
		wait until not LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 2] recruiting
		clear LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 1] action queue
		clear LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 2] action queue

		// Setup the target
		Target = LC6_TownActual[TownForGeneralToTake - 1]

		// Recruit a platoon and send them off to take over a nearby town
		WP_1	= marker at get target from {0,0,0} to {Target} distance DIST angle 0
		WP_2	= marker at get target from {0,0,0} to {Target} distance DIST angle 45
		WP_3	= marker at get target from {0,0,0} to {Target} distance DIST angle 90
		WP_4	= marker at get target from {0,0,0} to {Target} distance DIST angle 135
		WP_5	= marker at get target from {0,0,0} to {Target} distance DIST angle 180
		WP_6	= marker at get target from {0,0,0} to {Target} distance DIST angle 225
		WP_7	= marker at get target from {0,0,0} to {Target} distance DIST angle 270
		WP_8	= marker at get target from {0,0,0} to {Target} distance DIST angle 315
		WP_9	= 0
		WP_10	= 0
		run script LC6_SetupIndividualPatrolRoute(11, WP_1, WP_2, WP_3, WP_4, WP_5, WP_6, WP_7, WP_8, WP_9, WP_10)
		
		if LC6_ShowDebug == LC6_TRUE
			SFX = create visual effect "gp_s_townctr_beam.ves" strength 0.1 scale 0.6 at {WP_1} time -1
			SFX = create visual effect "gp_s_townctr_beam.ves" strength 0.1 scale 0.6 at {WP_2} time -1
			SFX = create visual effect "gp_s_townctr_beam.ves" strength 0.1 scale 0.6 at {WP_3} time -1
			SFX = create visual effect "gp_s_townctr_beam.ves" strength 0.1 scale 0.6 at {WP_4} time -1
			SFX = create visual effect "gp_s_townctr_beam.ves" strength 0.1 scale 0.6 at {WP_5} time -1
			SFX = create visual effect "gp_s_townctr_beam.ves" strength 0.1 scale 0.6 at {WP_6} time -1
			SFX = create visual effect "gp_s_townctr_beam.ves" strength 0.1 scale 0.6 at {WP_7} time -1
			SFX = create visual effect "gp_s_townctr_beam.ves" strength 0.1 scale 0.6 at {WP_8} time -1
		end if

		add action PLATOON_AGENDA_ACTION_ATTACK_TOWN_CENTRE_FOR_TAKE_OVER using Target to LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 1] action queue
		move LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 1] along LC6_PatrolRoute[3] with patrol WAYPOINTROUTE_TRAVERSAL_TYPE_CIRCULAR
		move LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 2] along LC6_PatrolRoute[11] with patrol WAYPOINTROUTE_TRAVERSAL_TYPE_CIRCULAR

		// Recruit the archer platoons and put them on the walls if any walls exist
		Ctr = 0
		Target = 0
		force while Ctr < 6 and Target == 0
			if LC6_Wall[Ctr] exists and BUILT of LC6_Wall[Ctr] >= 1.0
				Target = LC6_Wall[Ctr]
			end if
			Ctr++
		end while

		if PutArchersOnWalls == LC6_TRUE and Target != 0
			run script LC6_ForceBuildingOfJapaneseArmoury(variable ABODE_NUMBER_RANGED_ARMOURY)
			if LC6_GeneralsInitialArchersBusy == LC6_FALSE
				add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Target to LC6_GeneralsInitialArchers action queue
				LC6_GeneralsInitialArchersBusy = LC6_TRUE
			else
				// Make sure we don't go over the platoon limit
				if LC6_NumGuardingPlatoons + 1 < LC6_MAX_PLATOONS
					LC6_NumGuardingPlatoons += 1
				else
					LC6_NumGuardingPlatoons = 1
				end if

				LC6_TypeOfPlatoon = variable ARMY_UNIT_TYPE_RANGED_2	
				wait until LC6_GuardingPlatoon[LC6_NumGuardingPlatoons - 1] exists
				wait until not LC6_GuardingPlatoon[LC6_NumGuardingPlatoons - 1] recruiting
				clear LC6_GuardingPlatoon[LC6_NumGuardingPlatoons - 1] action queue
				add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Target to LC6_GuardingPlatoon[LC6_NumGuardingPlatoons - 1] action queue
			end if
		end if
	end if

end script LC6_GeneralResponds_PlayerTakesTwoTowns


//-----------------------------------------------------------------------------
//	The general responds to the player taking over 3 towns
//-----------------------------------------------------------------------------
begin script LC6_GeneralResponds_PlayerTakesThreeTowns(TakeOverMethod, TownTaken)

	TownForGeneralToTake		= 0
	PutArchersOnWalls			= LC6_FALSE

	Target						= 0
	DIST						= 40
	
	WP_1						= 0
	WP_2						= 0
	WP_3						= 0
	WP_4						= 0
	WP_5						= 0
	WP_6						= 0
	WP_7						= 0
	WP_8						= 0
	WP_9						= 0
	WP_10						= 0
	
	Ctr							= 0
	
	// TEMP:
	SFX							= 0

start

	// Handle the responses
	if TakeOverMethod == LC6_IMPRESS
		if LC6_JapanesePlayingStyle == LC6_CITY
			// TEMP: Need a response for this, for now do nothing...
			if TownTaken == 1 or TownTaken == 2
			elsif TownTaken == 3
			elsif TownTaken == 4
			elsif TownTaken == 5
			end if

			TownForGeneralToTake = 3

		else																// War style being played
			if TownTaken == 1 or TownTaken == 2
				// Player has backtracked, general responds by taking town 4
				TownForGeneralToTake = 3
				PutArchersOnWalls = LC6_TRUE
			elsif TownTaken == 3
				// Player has stopped at town 3, general responds by attacking town 3
				TownForGeneralToTake = 3
			elsif TownTaken == 4
				// Player has pushed on, general goes to meet threat
				TownForGeneralToTake = 4
			elsif TownTaken == 5
				// Player has pushed on, general goes to meet threat
				TownForGeneralToTake = 5
			end if
		end if

	else																	// Taken over by force
		if LC6_JapanesePlayingStyle == LC6_CITY
			// TEMP: Need a response for this, for now do nothing...
			if TownTaken == 1 or TownTaken == 2
			elsif TownTaken == 3
			elsif TownTaken == 4
			elsif TownTaken == 5
			end if
			
			TownForGeneralToTake = 3

		else																// War style being played
			if TownTaken == 1 or TownTaken == 2
				// Player has backtracked, general responds by taking town 4
				TownForGeneralToTake = 3
				PutArchersOnWalls = LC6_TRUE
			elsif TownTaken == 3
				// Player has stopped at town 3, general responds by attacking town 3
				TownForGeneralToTake = 3
			elsif TownTaken == 4
				// Player has pushed on, general goes to meet threat
				TownForGeneralToTake = 4
			elsif TownTaken == 5
				// Player has pushed on, general goes to meet threat
				TownForGeneralToTake = 5
			end if
		end if
	end if



	// Do the actual responses
	if TownForGeneralToTake > 0
		// Recruit the melee platoons
		run script LC6_ForceBuildingOfJapaneseArmoury(variable ABODE_NUMBER_MELEE_ARMOURY)

		// Make sure we don't go over the platoon limit
		if LC6_NumAttackingPlatoons + 2 <= LC6_MAX_PLATOONS
			LC6_NumAttackingPlatoons += 2
		else
			LC6_NumAttackingPlatoons = 2
		end if

		LC6_TypeOfPlatoon = variable ARMY_UNIT_TYPE_MELEE_2	
		wait until LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 1] exists
		wait until LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 2] exists
		wait until not LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 1] recruiting
		wait until not LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 2] recruiting
		clear LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 1] action queue
		clear LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 2] action queue

		// Setup the target
		Target = LC6_TownActual[TownForGeneralToTake - 1]

		// Recruit a platoon and send them off to take over a nearby town
		WP_1	= marker at get target from {0,0,0} to {Target} distance DIST angle 0
		WP_2	= marker at get target from {0,0,0} to {Target} distance DIST angle 45
		WP_3	= marker at get target from {0,0,0} to {Target} distance DIST angle 90
		WP_4	= marker at get target from {0,0,0} to {Target} distance DIST angle 135
		WP_5	= marker at get target from {0,0,0} to {Target} distance DIST angle 180
		WP_6	= marker at get target from {0,0,0} to {Target} distance DIST angle 225
		WP_7	= marker at get target from {0,0,0} to {Target} distance DIST angle 270
		WP_8	= marker at get target from {0,0,0} to {Target} distance DIST angle 315
		WP_9	= 0
		WP_10	= 0
		run script LC6_SetupIndividualPatrolRoute(12, WP_1, WP_2, WP_3, WP_4, WP_5, WP_6, WP_7, WP_8, WP_9, WP_10)
				
		if LC6_ShowDebug == LC6_TRUE
			SFX = create visual effect "gp_s_townctr_beam.ves" strength 0.1 scale 0.6 at {WP_1} time -1
			SFX = create visual effect "gp_s_townctr_beam.ves" strength 0.1 scale 0.6 at {WP_2} time -1
			SFX = create visual effect "gp_s_townctr_beam.ves" strength 0.1 scale 0.6 at {WP_3} time -1
			SFX = create visual effect "gp_s_townctr_beam.ves" strength 0.1 scale 0.6 at {WP_4} time -1
			SFX = create visual effect "gp_s_townctr_beam.ves" strength 0.1 scale 0.6 at {WP_5} time -1
			SFX = create visual effect "gp_s_townctr_beam.ves" strength 0.1 scale 0.6 at {WP_6} time -1
			SFX = create visual effect "gp_s_townctr_beam.ves" strength 0.1 scale 0.6 at {WP_7} time -1
			SFX = create visual effect "gp_s_townctr_beam.ves" strength 0.1 scale 0.6 at {WP_8} time -1
		end if

		add action PLATOON_AGENDA_ACTION_ATTACK_TOWN_CENTRE_FOR_TAKE_OVER using Target to LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 1] action queue
		move LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 1] along LC6_PatrolRoute[3] with patrol WAYPOINTROUTE_TRAVERSAL_TYPE_CIRCULAR
		move LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 2] along LC6_PatrolRoute[12] with patrol WAYPOINTROUTE_TRAVERSAL_TYPE_CIRCULAR

		// Recruit the archer platoons and put them on the walls if any walls exist
		Ctr = 0
		Target = 0
		force while Ctr < 6 and Target == 0
			if LC6_Wall[Ctr] exists and BUILT of LC6_Wall[Ctr] >= 1.0
				Target = LC6_Wall[Ctr]
			end if
			Ctr++
		end while

		if PutArchersOnWalls == LC6_TRUE and Target != 0
			run script LC6_ForceBuildingOfJapaneseArmoury(variable ABODE_NUMBER_RANGED_ARMOURY)
			if LC6_GeneralsInitialArchersBusy == LC6_FALSE
				add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Target to LC6_GeneralsInitialArchers action queue
				LC6_GeneralsInitialArchersBusy = LC6_TRUE
			else
				// Make sure we don't go over the platoon limit
				if LC6_NumGuardingPlatoons + 1 < LC6_MAX_PLATOONS
					LC6_NumGuardingPlatoons += 1
				else
					LC6_NumGuardingPlatoons = 1
				end if

				LC6_TypeOfPlatoon = variable ARMY_UNIT_TYPE_RANGED_2	
				wait until LC6_GuardingPlatoon[LC6_NumGuardingPlatoons - 1] exists
				wait until not LC6_GuardingPlatoon[LC6_NumGuardingPlatoons - 1] recruiting
				clear LC6_GuardingPlatoon[LC6_NumGuardingPlatoons - 1] action queue
				add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Target to LC6_GuardingPlatoon[LC6_NumGuardingPlatoons - 1] action queue
			end if
		end if
	end if

end script LC6_GeneralResponds_PlayerTakesThreeTowns


//-----------------------------------------------------------------------------
//	The general responds to the player taking over 4 towns
//-----------------------------------------------------------------------------
begin script LC6_GeneralResponds_PlayerTakesFourTowns(TakeOverMethod, TownTaken)

	Wall[6]
	WallPos[6]

	SEARCH_RADIUS				= 5

	Ctr					= 0
	WallIndex			= 0

start

	// Get the walls
	WallPos[0] = marker at {988.381,110.997,1876.501}			// FrontGateHouseLeftWall
	WallPos[1] = marker at {1080.687,111.916,1842.750}		// FrontGateHouseRightWall
	WallPos[2] = marker at {924.713,116.627,1960.141}			// LeftGateHouseBottomWall
	WallPos[3] = marker at {916.402,117.854,2041.918}			// LeftGateHouseTopWall
	WallPos[4] = marker at {1235.494,110.937,1908.927}		// RightGateHouseBottomWall
	WallPos[5] = marker at {1258.164,120.654,2015.128}		// RightGateHouseTopWall

	// Recruit the melee platoons
	run script LC6_ForceBuildingOfJapaneseArmoury(variable ABODE_NUMBER_MELEE_ARMOURY)

	// Withdraw all of the generals troops back to his capital
	// Attacking troops
	LC6_NumAttackingPlatoons = LC6_MAX_PLATOONS
	LC6_TypeOfPlatoon = variable ARMY_UNIT_TYPE_MELEE_2
	Ctr = 0
	force while Ctr < LC6_MAX_PLATOONS
		wait until LC6_AttackingPlatoon[Ctr] exists
		wait until not LC6_AttackingPlatoon[Ctr] recruiting
		clear LC6_AttackingPlatoon[Ctr] action queue
		add action PLATOON_AGENDA_ACTION_MOVE_TO_POS using {L6JapaneseCapital} + {number from -30 to 30, number from -30 to 30} to LC6_AttackingPlatoon[Ctr] action queue
		Ctr++
	end while

	// Recruit the ranged platoons
	run script LC6_ForceBuildingOfJapaneseArmoury(variable ABODE_NUMBER_RANGED_ARMOURY)

	// Defending troops
	LC6_NumGuardingPlatoons = LC6_MAX_PLATOONS
	LC6_TypeOfPlatoon = variable ARMY_UNIT_TYPE_RANGED_2
	Ctr = 0
	WallIndex = 0
	force while Ctr < LC6_MAX_PLATOONS
		wait until LC6_GuardingPlatoon[Ctr] exists
		wait until not LC6_GuardingPlatoon[Ctr] recruiting
		clear LC6_GuardingPlatoon[Ctr] action queue

		Wall[WallIndex] = get wall segment nearest {WallPos[WallIndex]} radius SEARCH_RADIUS
		if Wall[WallIndex] exists and BUILT of Wall[WallIndex] >= 1.0
			add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[WallIndex] to LC6_GuardingPlatoon[Ctr] action queue
			WallIndex++
		else
			add action PLATOON_AGENDA_ACTION_MOVE_TO_POS using {L6JapaneseCapital} + {number from -30 to 30, number from -30 to 30} to LC6_GuardingPlatoon[Ctr] action queue
		end if

		if WallIndex >= 6
			WallIndex = 0
		end if

		Ctr++
	end while
	
	// Initial archer troop
	if LC6_GeneralsInitialArchers exists
		add action PLATOON_AGENDA_ACTION_MOVE_TO_POS using {L6JapaneseCapital} to LC6_GeneralsInitialArchers action queue
	end if

	// Initial melee troop
	if LC6_GeneralsInitialMelee exists
		clear LC6_GeneralsInitialMelee action queue
		add action PLATOON_AGENDA_ACTION_MOVE_TO_POS using {L6JapaneseCapital} to LC6_GeneralsInitialMelee action queue
	end if

end script LC6_GeneralResponds_PlayerTakesFourTowns


//-----------------------------------------------------------------------------
//	The general responds to the player taking over 5 towns
//-----------------------------------------------------------------------------
begin script LC6_GeneralResponds_PlayerTakesFiveTowns(TakeOverMethod, TownTaken)

	Wall[6]
	WallPos[6]

	SEARCH_RADIUS				= 5

	Ctr					= 0
	WallIndex			= 0

start

	// Get the walls
	WallPos[0] = marker at {988.381,110.997,1876.501}			// FrontGateHouseLeftWall
	WallPos[1] = marker at {1080.687,111.916,1842.750}		// FrontGateHouseRightWall
	WallPos[2] = marker at {924.713,116.627,1960.141}			// LeftGateHouseBottomWall
	WallPos[3] = marker at {916.402,117.854,2041.918}			// LeftGateHouseTopWall
	WallPos[4] = marker at {1235.494,110.937,1908.927}		// RightGateHouseBottomWall
	WallPos[5] = marker at {1258.164,120.654,2015.128}		// RightGateHouseTopWall

	// Recruit the melee platoons
	run script LC6_ForceBuildingOfJapaneseArmoury(variable ABODE_NUMBER_MELEE_ARMOURY)

	// Withdraw all of the generals troops back to his capital
	// Attacking troops
	LC6_NumAttackingPlatoons = LC6_MAX_PLATOONS
	LC6_TypeOfPlatoon = variable ARMY_UNIT_TYPE_MELEE_2
	Ctr = 0
	force while Ctr < LC6_MAX_PLATOONS
		wait until LC6_AttackingPlatoon[Ctr] exists
		wait until not LC6_AttackingPlatoon[Ctr] recruiting
		clear LC6_AttackingPlatoon[Ctr] action queue
		add action PLATOON_AGENDA_ACTION_MOVE_TO_POS using {L6JapaneseCapital} + {number from -30 to 30, number from -30 to 30} to LC6_AttackingPlatoon[Ctr] action queue
		Ctr++
	end while

	// Recruit the ranged platoons
	run script LC6_ForceBuildingOfJapaneseArmoury(variable ABODE_NUMBER_RANGED_ARMOURY)

	// Defending troops
	LC6_NumGuardingPlatoons = LC6_MAX_PLATOONS
	LC6_TypeOfPlatoon = variable ARMY_UNIT_TYPE_RANGED_2
	Ctr = 0
	WallIndex = 0
	force while Ctr < LC6_MAX_PLATOONS
		wait until LC6_GuardingPlatoon[Ctr] exists
		wait until not LC6_GuardingPlatoon[Ctr] recruiting
		clear LC6_GuardingPlatoon[Ctr] action queue

		Wall[WallIndex] = get wall segment nearest {WallPos[WallIndex]} radius SEARCH_RADIUS
		if Wall[WallIndex] exists and BUILT of Wall[WallIndex] >= 1.0
			add action PLATOON_AGENDA_ACTION_GET_ON_WALL using Wall[WallIndex] to LC6_GuardingPlatoon[Ctr] action queue
			WallIndex++
		else
			add action PLATOON_AGENDA_ACTION_MOVE_TO_POS using {L6JapaneseCapital} + {number from -30 to 30, number from -30 to 30} to LC6_GuardingPlatoon[Ctr] action queue
		end if

		if WallIndex >= 6
			WallIndex = 0
		end if

		Ctr++
	end while
	
	// Initial archer troop
	if LC6_GeneralsInitialArchers exists
		add action PLATOON_AGENDA_ACTION_MOVE_TO_POS using {L6JapaneseCapital} to LC6_GeneralsInitialArchers action queue
	end if

	// Initial melee troop
	if LC6_GeneralsInitialMelee exists
		clear LC6_GeneralsInitialMelee action queue
		add action PLATOON_AGENDA_ACTION_MOVE_TO_POS using {L6JapaneseCapital} to LC6_GeneralsInitialMelee action queue
	end if

end script LC6_GeneralResponds_PlayerTakesFiveTowns


//-----------------------------------------------------------------------------
//	The general responds when he takes over 1 settlement
//-----------------------------------------------------------------------------
begin script LC6_GeneralResponds_GeneralTakesOneSettlement
start
end script LC6_GeneralResponds_GeneralTakesOneSettlement


//-----------------------------------------------------------------------------
//	The general responds when he takes over 2 settlements
//-----------------------------------------------------------------------------
begin script LC6_GeneralResponds_GeneralTakesTwoSettlements
start
end script LC6_GeneralResponds_GeneralTakesTwoSettlements


//-----------------------------------------------------------------------------
//	The general responds when he takes over 3 settlements
//-----------------------------------------------------------------------------
begin script LC6_GeneralResponds_GeneralTakesThreeSettlements
start
end script LC6_GeneralResponds_GeneralTakesThreeSettlements


//-----------------------------------------------------------------------------
//	The general responds when he takes over 4 settlements
//-----------------------------------------------------------------------------
begin script LC6_GeneralResponds_GeneralTakesFourSettlements
start
end script LC6_GeneralResponds_GeneralTakesFourSettlements


//-----------------------------------------------------------------------------
//	The general responds when he takes over 5 settlements
//-----------------------------------------------------------------------------
begin script LC6_GeneralResponds_GeneralTakesFiveSettlements
start
end script LC6_GeneralResponds_GeneralTakesFiveSettlements


//-----------------------------------------------------------------------------
//	The general responds when he takes over 1 town
//-----------------------------------------------------------------------------
begin script LC6_GeneralResponds_GeneralTakesOneTown
start
end script LC6_GeneralResponds_GeneralTakesOneTown


//-----------------------------------------------------------------------------
//	The general responds when he takes over 2 towns
//-----------------------------------------------------------------------------
begin script LC6_GeneralResponds_GeneralTakesTwoTowns
start
end script LC6_GeneralResponds_GeneralTakesTwoTowns


//-----------------------------------------------------------------------------
//	The general responds when he takes over 3 towns
//-----------------------------------------------------------------------------
begin script LC6_GeneralResponds_GeneralTakesThreeTowns
start
end script LC6_GeneralResponds_GeneralTakesThreeTowns


//-----------------------------------------------------------------------------
//	The general responds when he takes over 4 towns
//-----------------------------------------------------------------------------
begin script LC6_GeneralResponds_GeneralTakesFourTowns
start
end script LC6_GeneralResponds_GeneralTakesFourTowns


//-----------------------------------------------------------------------------
//	The general responds when he takes over 5 towns
//-----------------------------------------------------------------------------
begin script LC6_GeneralResponds_GeneralTakesFiveTowns
start
end script LC6_GeneralResponds_GeneralTakesFiveTowns


//-----------------------------------------------------------------------------
//	The general responds when the player creates a platoon
//-----------------------------------------------------------------------------
begin script LC6_GeneralResponds_PlayerCreatesPlatoon
start

	// The general creates a platoon (archers for city general, melee for war general)
	if LC6_JapanesePlayingStyle == LC6_CITY
		// Force build an armoury if we don't have one
		run script LC6_ForceBuildingOfJapaneseArmoury(variable ABODE_NUMBER_RANGED_ARMOURY)
		
		// Need to start the recruiting of the platoons now
		if LC6_NumGuardingPlatoons + 1 < LC6_MAX_PLATOONS
			// Make sure we don't go over the platoon limit
			if LC6_NumGuardingPlatoons + 1 < LC6_MAX_PLATOONS
				LC6_NumGuardingPlatoons += 1
			else
				LC6_NumGuardingPlatoons = 1
			end if

			LC6_TypeOfPlatoon = variable ARMY_UNIT_TYPE_RANGED_2
			wait until LC6_GuardingPlatoon[LC6_NumGuardingPlatoons - 1] exists		
			wait until not LC6_GuardingPlatoon[LC6_NumGuardingPlatoons - 1] recruiting
			clear LC6_GuardingPlatoon[LC6_NumGuardingPlatoons - 1] action queue
			move LC6_GuardingPlatoon[LC6_NumGuardingPlatoons - 1] along LC6_PatrolRoute[3] with patrol WAYPOINTROUTE_TRAVERSAL_TYPE_CIRCULAR
		else
			if LC6_ShowDebug == LC6_TRUE
//				say "ERROR: Cannot create another guarding platoon. Called in: LC6_GeneralResponds_PlayerCreatesPlatoon"
				wait until read
			end if
		end if
	else
		// Force build an armoury if we don't have one
		run script LC6_ForceBuildingOfJapaneseArmoury(variable ABODE_NUMBER_MELEE_ARMOURY)
		
		// Need to start the recruiting of the platoons now
		if LC6_NumAttackingPlatoons + 1 < LC6_MAX_PLATOONS
			// Make sure we don't go over the platoon limit
			if LC6_NumAttackingPlatoons + 1 <= LC6_MAX_PLATOONS
				LC6_NumAttackingPlatoons += 1
			else
				LC6_NumAttackingPlatoons = 1
			end if

			LC6_TypeOfPlatoon = variable ARMY_UNIT_TYPE_MELEE_2
			wait until LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 1] exists		
			wait until not LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 1] recruiting
			clear LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 1] action queue
			move LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 1] along LC6_PatrolRoute[3] with patrol WAYPOINTROUTE_TRAVERSAL_TYPE_CIRCULAR
		else
			if LC6_ShowDebug == LC6_TRUE
//				say "ERROR: Cannot create another attacking platoon. Called in: LC6_GeneralResponds_PlayerCreatesPlatoon"
				wait until read
			end if
		end if
	end if

end script LC6_GeneralResponds_PlayerCreatesPlatoon


//-----------------------------------------------------------------------------
//	The player has reached the impressiveness threshold for level 2
//-----------------------------------------------------------------------------
begin script LC6_GeneralResponds_PlayerReachesImpressiveThreshold_2
start
/*
	// The generals creature assists in the building of the city - handled in the creature script
	if HEALTH of LC6_JapaneseCreature <= 0 or LC6_JapaneseCreature not exists
		LC6_JapaneseCreatureHelpsBuild = LC6_TRUE
	end if
*/
end script LC6_GeneralResponds_PlayerReachesImpressiveThreshold_2


//-----------------------------------------------------------------------------
//	The player has reached the impressiveness threshold for level 3
//-----------------------------------------------------------------------------
begin script LC6_GeneralResponds_PlayerReachesImpressiveThreshold_3
start

	// The general continues building up his city or building armies

end script LC6_GeneralResponds_PlayerReachesImpressiveThreshold_3


//-----------------------------------------------------------------------------
//	The player taken more than 4 settlements and they've switched from impress to force
//-----------------------------------------------------------------------------
begin script LC6_GeneralResponds_PlayerSwitchedFromImpressToForce
start

	// The general recruits some troops to handle the situation

end script LC6_GeneralResponds_PlayerSwitchedFromImpressToForce


//-----------------------------------------------------------------------------
//	The player taken more than 4 settlements and they've switched from force to impress
//-----------------------------------------------------------------------------
begin script LC6_GeneralResponds_PlayerSwitchedFromForceToImpress
start

	// Enemy town starts to construct some more impressive buildings

end script LC6_GeneralResponds_PlayerSwitchedFromForceToImpress


//-----------------------------------------------------------------------------
//	The player has crossed the line early - tried a rush tactic
//-----------------------------------------------------------------------------
begin script LC6_GeneralResponds_PlayerCrossedMajinoLine
start

	// If the general is still playing a neutral game make him switch to war mode
	if LC6_JapanesePlayingStyle == LC6_NEUTRAL
		run background script LC6_SetJapanesePlayingStyle(LC6_WAR)
		LC6_BuildWalls = LC6_TRUE
	end if



	// Send the enemy generals initial platoons to take over town 3 and town 4
	if LC6_GeneralsInitialMelee exists
		clear LC6_GeneralsInitialMelee action queue
		add action PLATOON_AGENDA_ACTION_ATTACK_TOWN_CENTRE_FOR_TAKE_OVER using get town with id 6 to LC6_GeneralsInitialMelee action queue
	end if

	if LC6_GeneralsInitialArchers exists
		clear LC6_GeneralsInitialArchers action queue
		add action PLATOON_AGENDA_ACTION_ATTACK_TOWN_CENTRE_FOR_TAKE_OVER using get town with id 9 to LC6_GeneralsInitialArchers action queue
	end if



	// Send the melee units to the front of the city walls
	//clear LC6_GeneralsInitialMelee action queue
	//move LC6_GeneralsInitialMelee along LC6_PatrolRoute[3] with patrol WAYPOINTROUTE_TRAVERSAL_TYPE_CIRCULAR
	
	// Create a couple of platoons
	run script LC6_ForceBuildingOfJapaneseArmoury(variable ABODE_NUMBER_MELEE_ARMOURY)
	set town L6JapaneseCapital desire for TOWN_DESIRE_TO_BUILD to 1

	// Make sure we don't go over the platoon limit
	if LC6_NumAttackingPlatoons + 2 <= LC6_MAX_PLATOONS
		LC6_NumAttackingPlatoons += 2
	else
		LC6_NumAttackingPlatoons = 2
	end if

	LC6_TypeOfPlatoon = variable ARMY_UNIT_TYPE_MELEE_2	
	wait until LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 1] exists
	wait until LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 2] exists
	wait until not LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 1] recruiting
	wait until not LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 2] recruiting
	clear LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 1] action queue
	clear LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 2] action queue
	move LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 1] along LC6_PatrolRoute[1] with patrol WAYPOINTROUTE_TRAVERSAL_TYPE_CIRCULAR
	move LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 2] along LC6_PatrolRoute[2] with patrol WAYPOINTROUTE_TRAVERSAL_TYPE_CIRCULAR

end script LC6_GeneralResponds_PlayerCrossedMajinoLine


//-----------------------------------------------------------------------------
//	Set the playing style of the Japanese general
//-----------------------------------------------------------------------------
begin script LC6_SetJapanesePlayingStyle(Style)
start

	LC6_SelectedPlayingStyle = LC6_TRUE
	LC6_JapanesePlayingStyle = Style

	if Style == LC6_WAR
		run script LC6_GeneralReactions(LC6_GEN_REACT_GENERAL_PLAYING_WAR_STYLE)
		LC6_BuildingSetToUse = LC6_EVIL_ALIGN
	elsif Style == LC6_CITY
		run script LC6_GeneralReactions(LC6_GEN_REACT_GENERAL_PLAYING_CITY_STYLE)
		LC6_BuildingSetToUse = LC6_GOOD_ALIGN
	else
		if LC6_ShowDebug == LC6_TRUE
//			say "ERROR: Trying to set the Japanese playing style to something other than WAR or CITY."
			wait until read
		end if
	end if

end script LC6_SetJapanesePlayingStyle


//-----------------------------------------------------------------------------
//	Set the flag that forces the type of armoury sent to be built
//-----------------------------------------------------------------------------
begin script LC6_ForceBuildingOfJapaneseArmoury(ArmouryType)

	NumArmouries			= 0
	SetFlag					= LC6_FALSE

start

	while get number of built ABODE_NUMBER_MELEE_ARMOURY in L6JapaneseCapital < 1
		// Set the flag that says we need to build an armoury
		if SetFlag == LC6_FALSE
			// This global flag is used in the city management script to force the building of the armoury
			if ArmouryType == variable ABODE_NUMBER_MELEE_ARMOURY 
				LC6_MeleeShouldBeBuiult = LC6_TRUE
			else
				LC6_RangedShouldBeBuiult = LC6_TRUE
			end if
						
			SetFlag = LC6_TRUE
		end if
	end while

end script LC6_ForceBuildingOfJapaneseArmoury


//-----------------------------------------------------------------------------
//	Keep track of how many towns and settlements the player and the opponent have
//-----------------------------------------------------------------------------
begin script LC6_UpdateMinorSettlementStats

	LastOwner					= 0
	CapturingPlayer				= 0
	TimeSinceCapture			= 0
	TimeSinceMigrationStarted	= 0
	TimeSinceMigrationArrived	= 0
	TimeSinceMigrationAccepted	= 0
	TotalMigrationsAccepted		= 0
	TownStatus					= 0

	MigratingToTown				= 0
	PlayersPlatoon				= 0

	RetakeHappened				= LC6_FALSE

	NumForce					= 0
	NumImpress					= 0

	Ctr							= 0

	MajinoLeftPos				= marker at {466.893,45.077,1335.857}
	MajinoRightPos				= marker at {1073.318,45.011,1250.653}

	NEUTRAL						= 0
	PASSIVE						= 1
	AGGRESSIVE					= 2
	TownConversionMethod		= 0

start

	// Keep checking while the Japanese exist
	begin loop
		// Check to see if the player has passed the majino line with a platoon of any type
		if LC6_CrossedMajinoLine == LC6_FALSE
			PlayersPlatoon = get platoon of player LC6_GREEK nearest {L6JapaneseCapital} radius 1500 
			if PlayersPlatoon exists
				if {PlayersPlatoon} and {L6JapaneseCapital} on same side of line between {MajinoLeftPos} and {MajinoRightPos} 
					// We need to get the general to build some defensive and attacking platoons so they need the armouries
					LC6_MeleeShouldBeBuiult	= LC6_TRUE
					LC6_RangedShouldBeBuiult = LC6_TRUE
					LC6_CrossedMajinoLine = LC6_TRUE
					LC6_BuildWalls = LC6_TRUE
				end if
			end if
			if LC6_CrossedMajinoLine == LC6_FALSE
				if {MyCreature} and {L6JapaneseCapital} on same side of line between {MajinoLeftPos} and {MajinoRightPos} 
					// We need to get the general to build some defensive and attacking platoons so they need the armouries
					LC6_MeleeShouldBeBuiult	= LC6_TRUE
					LC6_RangedShouldBeBuiult = LC6_TRUE
					LC6_CrossedMajinoLine = LC6_TRUE
					LC6_BuildWalls = LC6_TRUE
				end if
			end if
		end if


		// Check through each town
		Ctr = 0
		force while Ctr < L6_NUM_OF_MINOR_SETTLEMENTS
			RetakeHappened			= LC6_FALSE
			TownConversionMethod	= NEUTRAL

			if L6_MinorSettlement[Ctr] exists
				// Keep track of whats going on
				LastOwner					= get town L6_MinorSettlement[Ctr] previous player
				CapturingPlayer				= get player capturing town L6_MinorSettlement[Ctr]
				TimeSinceCapture			= get time since town L6_MinorSettlement[Ctr] last captured 
				TimeSinceMigrationStarted	= get time since last migration started from town L6_MinorSettlement[Ctr]
				TimeSinceMigrationArrived	= get time since last migration arrived at town L6_MinorSettlement[Ctr]
				TimeSinceMigrationAccepted	= get time since last migration accepted at town L6_MinorSettlement[Ctr]
				TotalMigrationsAccepted		= get number of migrations accepted by town L6_MinorSettlement[Ctr]

				TownStatus					= variable get town L6_MinorSettlement[Ctr] status

				// Check for the different status'
				if TownStatus == variable TOWN_STATUS_DEFAULT
					// Startup - nothing much happening

				elsif TownStatus == variable TOWN_STATUS_MIGRATION_STARTED
					// Started leaving town for new potential owners town

					// Get the town that is being migrated to
					MigratingToTown = get town L6_MinorSettlement[Ctr] is migrating to

					// Who is the migration to?
					if MigratingToTown exists
						// Migrating to the player or the Japanese?
						if PLAYER of MigratingToTown == LC6_GREEK
							// Is it newly owned?
							if LC6_WhoOwnsTown[Ctr] != LC6_PLAYER
								// This is a newly aquired town or settlement?
								if LC6_TownOrSettlement[Ctr] == LC6_SETTLEMENT
									// Increment the player settlement counter
									if LC6_PlayerMinorSettlementTotal < L6_NUM_OF_MINOR_SETTLEMENTS
										LC6_PlayerMinorSettlementTotal++
									end if

								else														// LC6_TOWN
									// As it's a town we need to test for a retake
									if LC6_WhoOwnsTown[Ctr] == LC6_OPPONENT
										RetakeHappened = LC6_TRUE
									else
										RetakeHappened = LC6_FALSE
									end if

									// Increment the player town counter
									if LC6_PlayerMinorTownTotal < L6_NUM_OF_MINOR_SETTLEMENTS
										LC6_PlayerMinorTownTotal++
									end if
									
									// Decrement the general town counter
									if RetakeHappened == LC6_TRUE
										if LC6_GeneralMinorTownTotal > 0
											LC6_GeneralMinorTownTotal--
										end if
									end if

									// Record the order that the minor towns have been taken in
									// This is only used for the player and is used in calculating which tactic the general uses
									LC6_TownTakenOrder[LC6_PlayerMinorTownTotal - 1] = L6_MinorSettlement[Ctr]

									// We need to flag that the player has retaken a town
									if RetakeHappened == LC6_TRUE and LC6_PlayerRetakeHappened == LC6_FALSE
										LC6_PlayerRetakeHappened = LC6_TRUE
									end if
								end if

								// Incrememnt the players taken by impress counter
								if LC6_PlayerTakenTownImpressTotal < L6_NUM_OF_MINOR_SETTLEMENTS
									LC6_PlayerTakenTownImpressTotal++
								end if
								
								// Decrement the generals taken by impress counter
								if RetakeHappened == LC6_TRUE
									if LC6_GeneralTakenTownImpressTotal > 0
										LC6_GeneralTakenTownImpressTotal--
									end if
								end if

								// This is a new town/settlement  for the player
								LC6_WhoOwnsTown[Ctr] = LC6_PLAYER
								LC6_TakenTownByForceOrImpress[Ctr] = LC6_IMPRESS
							end if

						elsif PLAYER of MigratingToTown == LC6_JAPANESE
							// Is it newly owned?
							if LC6_WhoOwnsTown[Ctr] != LC6_OPPONENT
								// This is a newly aquired town / settlement
								if LC6_TownOrSettlement[Ctr] == LC6_SETTLEMENT
									// Increment the general settlement counter
									if LC6_GeneralMinorSettlementTotal < L6_NUM_OF_MINOR_SETTLEMENTS
										LC6_GeneralMinorSettlementTotal++
									end if

								else														// LC6_TOWN
									// As it's a town we need to test for a retake
									if LC6_WhoOwnsTown[Ctr] == LC6_PLAYER
										RetakeHappened = LC6_TRUE
									else
										RetakeHappened = LC6_FALSE
									end if

									// Increment the general town counter
									if LC6_GeneralMinorTownTotal < L6_NUM_OF_MINOR_SETTLEMENTS
										LC6_GeneralMinorTownTotal++
									end if
									
									// Decrement the player town counter
									if RetakeHappened == LC6_TRUE
										if LC6_PlayerMinorTownTotal > 0
											LC6_PlayerMinorTownTotal--
										end if
									end if

									// We need to flag that the general has retaken a town
									if RetakeHappened == LC6_TRUE and LC6_GeneralRetakeHappened == LC6_FALSE
										LC6_GeneralRetakeHappened = LC6_TRUE
									end if
								end if

								// Incrememnt the generals taken by impress counter
								if LC6_GeneralTakenTownImpressTotal < L6_NUM_OF_MINOR_SETTLEMENTS
									LC6_GeneralTakenTownImpressTotal++
								end if
								
								// Decrement the players taken by impress counter
								if RetakeHappened == LC6_TRUE
									if LC6_PlayerTakenTownImpressTotal > 0
										LC6_PlayerTakenTownImpressTotal--
									end if
								end if

								// This is a new town/settlement  for the Japanese
								LC6_WhoOwnsTown[Ctr] = LC6_OPPONENT
								LC6_TakenTownByForceOrImpress[Ctr] = LC6_IMPRESS
							end if

						else
							if LC6_ShowDebug == LC6_TRUE
//								say "ERROR: The player of the migrating town is neither the players or the Japanese?"
								wait until read
							end if
						end if

						TownConversionMethod = PASSIVE
					end if

				elsif TownStatus == variable TOWN_STATUS_MIGRATION_ARRIVED
					// Arrived at new potential owners town

				elsif TownStatus == variable TOWN_STATUS_MIGRATED
					// Been accepted by new owners

				elsif TownStatus == variable TOWN_STATUS_BEING_CAPTURED
					// Being taken over by armies

				elsif TownStatus == variable TOWN_STATUS_CAPTURED
					// Been captured by armies
					if PLAYER of L6_MinorSettlement[Ctr] == LC6_GREEK
						// Is it newly owned?
						if LC6_WhoOwnsTown[Ctr] != LC6_PLAYER
							// This is a newly aquired town or settlement?
							if LC6_TownOrSettlement[Ctr] == LC6_SETTLEMENT
								// Increment the player settlement counter
								if LC6_PlayerMinorSettlementTotal < L6_NUM_OF_MINOR_SETTLEMENTS
									LC6_PlayerMinorSettlementTotal++
								end if

							else														// LC6_TOWN
								// As it's a town we need to test for a retake
								if LC6_WhoOwnsTown[Ctr] == LC6_OPPONENT
									RetakeHappened = LC6_TRUE
								else
									RetakeHappened = LC6_FALSE
								end if

								// Increment the player town counter
								if LC6_PlayerMinorTownTotal < L6_NUM_OF_MINOR_SETTLEMENTS
									LC6_PlayerMinorTownTotal++
								end if
								
								// Decrement the general town counter
								if RetakeHappened == LC6_TRUE
									if LC6_GeneralMinorTownTotal > 0
										LC6_GeneralMinorTownTotal--
									end if
								end if

								// Record the order that the minor towns have been taken in
								// This is only used for the player and is used in calculating which tactic the general uses
								LC6_TownTakenOrder[LC6_PlayerMinorTownTotal - 1] = L6_MinorSettlement[Ctr]

								// We need to flag that the player has retaken a town
								if RetakeHappened == LC6_TRUE and LC6_PlayerRetakeHappened == LC6_FALSE
									LC6_PlayerRetakeHappened = LC6_TRUE
								end if
							end if

							// Incrememnt the players taken by force counter
							if LC6_PlayerTakenTownForceTotal < L6_NUM_OF_MINOR_SETTLEMENTS
								LC6_PlayerTakenTownForceTotal++
							end if
							
							// Decrement the generals taken by force counter
							if RetakeHappened == LC6_TRUE
								if LC6_GeneralTakenTownForceTotal > 0
									LC6_GeneralTakenTownForceTotal--
								end if
							end if

							// This is a new town/settlement  for the player
							LC6_WhoOwnsTown[Ctr] = LC6_PLAYER
							LC6_TakenTownByForceOrImpress[Ctr] = LC6_FORCE
						end if

					elsif PLAYER of L6_MinorSettlement[Ctr] == LC6_JAPANESE
						// Is it newly owned?
						if LC6_WhoOwnsTown[Ctr] != LC6_OPPONENT
							// This is a newly aquired town or settlement?
							if LC6_TownOrSettlement[Ctr] == LC6_SETTLEMENT
								// Increment the general settlement counter
								if LC6_GeneralMinorSettlementTotal < L6_NUM_OF_MINOR_SETTLEMENTS
									LC6_GeneralMinorSettlementTotal++
								end if

							else														// LC6_TOWN
								// As it's a town we need to test for a retake
								if LC6_WhoOwnsTown[Ctr] == LC6_PLAYER
									RetakeHappened = LC6_TRUE
								else
									RetakeHappened = LC6_FALSE
								end if

								// Increment the general town counter
								if LC6_GeneralMinorTownTotal < L6_NUM_OF_MINOR_SETTLEMENTS
									LC6_GeneralMinorTownTotal++
								end if
								
								// Decrement the player town counter
								if RetakeHappened == LC6_TRUE
									if LC6_PlayerMinorTownTotal > 0
										LC6_PlayerMinorTownTotal--
									end if
								end if

								// We need to flag that the general has retaken a town
								if RetakeHappened == LC6_TRUE and LC6_GeneralRetakeHappened == LC6_FALSE
									LC6_GeneralRetakeHappened = LC6_TRUE
								end if
							end if

							// Incrememnt the generals taken by force counter
							if LC6_GeneralTakenTownForceTotal < L6_NUM_OF_MINOR_SETTLEMENTS
								LC6_GeneralTakenTownForceTotal++
							end if
							
							// Decrement the players taken by force counter
							if RetakeHappened == LC6_TRUE
								if LC6_PlayerTakenTownForceTotal > 0
									LC6_PlayerTakenTownForceTotal--
								end if
							end if

							// This is a new town/settlement  for the general
							LC6_WhoOwnsTown[Ctr] = LC6_OPPONENT
							LC6_TakenTownByForceOrImpress[Ctr] = LC6_FORCE
						end if

					else
						if LC6_ShowDebug == LC6_TRUE
//							say "ERROR: The town has been captured but not by the player or the Japanese general!"
							wait until read
						end if
					end if

					TownConversionMethod = AGGRESSIVE

				else
					// Unknown...error...
				end if
			end if

			Ctr++
		end while



		// Find out if the player has switched their strategy
		if LC6_PlayerMinorTownTotal > 4
			Ctr = 0
			force while Ctr < L6_NUM_OF_MINOR_SETTLEMENTS
				if LC6_WhoOwnsTown[Ctr] == LC6_PLAYER
					if LC6_TakenTownByForceOrImpress[Ctr] == LC6_FORCE
						NumForce++
					elsif LC6_TakenTownByForceOrImpress[Ctr] == LC6_IMPRESS
						NumImpress++
					end if
				end if
			
				Ctr++
			end while
			
			// Switch the flags as necessary
			if NumForce > NumImpress and TownConversionMethod == PASSIVE
				LC6_PlayerSwitchedForceToImpress = LC6_TRUE
				LC6_PlayerSwitchedImpressToForce = LC6_FALSE
				
			elsif NumImpress > NumForce and TownConversionMethod == AGGRESSIVE
				LC6_PlayerSwitchedImpressToForce = LC6_TRUE
				LC6_PlayerSwitchedForceToImpress = LC6_FALSE
			end if
		end if

	until L6CapitalConverted == LC6_TRUE 
	end loop

end script LC6_UpdateMinorSettlementStats


//-----------------------------------------------------------------------------
//	Handle the Japanese army actions
//-----------------------------------------------------------------------------
begin script LC6_ArmyManagement

	GreekTroopSize				= 0
	JapaneseTroopSize			= 0

start

	// Setup the generic patrol routes - just setting up the routes, they are not getting used here
	run script LC6_SetupGenericPatrolRoutes
	run script LC6_ReorderTownsSoNearestToJapaneseFirst
	
	// Run the platoon recruitment script
	run background script LC6_RecruitPlatoons
	
	// Looping stuff...
	begin loop
		// Get the troop sizes and check to see if the Greeks outweigh the Japanese, if so recruit more
//		NumPlatoons = get number of platoon belonging to player 0
//		NumWarriors = get number of platoon warriors belonging to player 0
		GreekTroopSize = get number of platoon warriors belonging to player LC6_GREEK
		JapaneseTroopSize = get number of platoon warriors belonging to player LC6_JAPANESE

		// Make sure the Greek army size doesn't get too big for the Japanese general to handle
		if GreekTroopSize > JapaneseTroopSize
			if LC6_JapanesePlayingStyle == LC6_WAR
				// Make sure the general keeps his troop size similar to the opponents
				run script LC6_ForceBuildingOfJapaneseArmoury(variable ABODE_NUMBER_MELEE_ARMOURY)

				// Make sure we don't go over the platoon limit
				if LC6_NumAttackingPlatoons + 1 < LC6_MAX_PLATOONS
					LC6_NumAttackingPlatoons += 1
				else
					LC6_NumAttackingPlatoons = 1
				end if

				// Recruit the platoon and then...
				LC6_TypeOfPlatoon = variable ARMY_UNIT_TYPE_MELEE_2	
				wait until LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 1] exists
				wait until not LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 1] recruiting
				clear LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 1] action queue
				add action PLATOON_AGENDA_ACTION_WAIT_IN_STATE_OF_READINESS using {L6JapaneseCapital} to LC6_AttackingPlatoon[LC6_NumAttackingPlatoons - 1] action queue

					
			elsif LC6_JapanesePlayingStyle == LC6_CITY
				// Make sure the general keeps his troop size similar to the opponents
				run script LC6_ForceBuildingOfJapaneseArmoury(variable ABODE_NUMBER_RANGED_ARMOURY)

				// Make sure we don't go over the platoon limit
				if LC6_NumGuardingPlatoons + 1 < LC6_MAX_PLATOONS
					LC6_NumGuardingPlatoons += 1
				else
					LC6_NumGuardingPlatoons = 1
				end if

				// Recruit the platoon and then...
				LC6_TypeOfPlatoon = variable ARMY_UNIT_TYPE_RANGED_2	
				wait until LC6_GuardingPlatoon[LC6_NumGuardingPlatoons - 1] exists
				wait until not LC6_GuardingPlatoon[LC6_NumGuardingPlatoons - 1] recruiting
				clear LC6_GuardingPlatoon[LC6_NumGuardingPlatoons - 1] action queue
				add action PLATOON_AGENDA_ACTION_WAIT_IN_STATE_OF_READINESS using {L6JapaneseCapital} to LC6_GuardingPlatoon[LC6_NumGuardingPlatoons - 1] action queue
			
			else																				// LC6_NEUTRAL
				// We need to force the general to play in a certain way
				// Make it war as this check is based on army sizes
				run background script LC6_SetJapanesePlayingStyle(LC6_WAR)
				LC6_BuildWalls = LC6_TRUE

				// The actual recruiting of armies will be done in the above war block the next time through

			end if
		end if
	
	until L6CapitalConverted == LC6_TRUE
	end loop

end script LC6_ArmyManagement


//-----------------------------------------------------------------------------
//	Handle the Japanese city building actions
//-----------------------------------------------------------------------------
begin script LC6_CityManagement

	GreekBuildingTotal[LC6_NUM_BUILDINGS]
	JapaneseBuildingTotal[LC6_NUM_BUILDINGS]
	MaxAmountOfBuildingType[LC6_NUM_BUILDINGS]	
	BuildingType[LC6_NUM_BUILDINGS]
	
	SEARCH_RADIUS						= 300				// Check in the editor to make sure it's big enough
	
	Building							= 0
	BuildingToBuild						= 0
	BuildingBeingBuilt					= 0
	BuildHouse							= 0
	BuildSpecial						= 0
	BuildBuilding						= 0
	BuiltInitialBuildings				= LC6_FALSE
	
	BUILDING_TYPE_HOUSE_A				= 0
	BUILDING_TYPE_HOUSE_B				= 1
	BUILDING_TYPE_HOUSE_C				= 2
	BUILDING_TYPE_HOUSE_D				= 3
	BUILDING_TYPE_HOUSE_E				= 4
	BUILDING_TYPE_SKYSCRAPER			= 5
	BUILDING_TYPE_ALTAR					= 6
	BUILDING_TYPE_STORAGE_PIT			= 7
	BUILDING_TYPE_CRECHE				= 8
	BUILDING_TYPE_SHRINE				= 9
	BUILDING_TYPE_TEMPLE				= 10
	BUILDING_TYPE_PUB					= 11
	BUILDING_TYPE_TOWN_CENTRE			= 12
	BUILDING_TYPE_CREATURE_PEN			= 13
	BUILDING_TYPE_FIELD					= 14
	BUILDING_TYPE_MELEE_ARMOURY			= 15
	BUILDING_TYPE_RANGED_ARMOURY		= 16
	BUILDING_TYPE_WORKSHOP				= 17
	BUILDING_TYPE_STUDY					= 18
	BUILDING_TYPE_UNIVERSITY			= 19
	BUILDING_TYPE_PRISON				= 20
	BUILDING_TYPE_SMELTER				= 21
	BUILDING_TYPE_GRANARY				= 22
	BUILDING_TYPE_LUMBERMILL			= 23
	BUILDING_TYPE_MARKET_POT			= 24
	BUILDING_TYPE_MARKET_STATUE			= 25
	BUILDING_TYPE_MARKET_PLANT			= 26
	BUILDING_TYPE_AMPITHEATRE			= 27
	BUILDING_TYPE_GRAVEYARD				= 28
	BUILDING_TYPE_OLD_PERSONS_HOME		= 29
	BUILDING_TYPE_BATHHOUSE				= 30
	BUILDING_TYPE_WALLTOWER_TECH0		= 31
	BUILDING_TYPE_WALLTOWER_TECH1		= 32
	BUILDING_TYPE_GATEHOUSE				= 33

	DoneBuiltAbodesComment				= LC6_FALSE
	DoneBuiltFieldsComment				= LC6_FALSE
	DoneBuiltStoragePitComment			= LC6_FALSE
	DoneBuiltTempleComment				= LC6_FALSE
	DoneBuiltGranaryComment				= LC6_FALSE
	DoneBuiltScenicTreesComment			= LC6_FALSE
	DoneBuiltNurseryComment				= LC6_FALSE
	DoneBuiltFertilityStatueComment		= LC6_FALSE
	DoneBuiltMarketComment				= LC6_FALSE
	DoneBuiltTavernComment				= LC6_FALSE
	DoneBuiltWallComment				= LC6_FALSE
	DoneBuiltGateHouseComment			= LC6_FALSE
	DoneRangedArmouryComment			= LC6_FALSE
	DoneMeleeArmouryComment				= LC6_FALSE

	DonePlayerHutComment				= LC6_FALSE
	DonePlayerHouseComment				= LC6_FALSE
	DonePlayerVillaComment				= LC6_FALSE
	DonePlayerMansionComment			= LC6_FALSE
	DonePlayerManorComment				= LC6_FALSE
	DonePlayerSkyscraperComment			= LC6_FALSE
	DonePlayerAltarComment				= LC6_FALSE
	DonePlayerStorehouseComment			= LC6_FALSE
	DonePlayerFieldComment				= LC6_FALSE
	DonePlayerCreaturePenComment		= LC6_FALSE
	DonePlayerGatehouseComment			= LC6_FALSE
	DonePlayerGraveyardComment			= LC6_FALSE
	DonePlayerTavernComment				= LC6_FALSE
	DonePlayerNurseryComment			= LC6_FALSE
	DonePlayerUniversityComment			= LC6_FALSE
	DonePlayerResthomeComment			= LC6_FALSE
	DonePlayerFortifiedWallComment		= LC6_FALSE
	DonePlayerTempleComment				= LC6_FALSE
	DonePlayerLumbermillComment			= LC6_FALSE
	DonePlayerSmelterComment			= LC6_FALSE
	DonePlayerGranaryComment			= LC6_FALSE
	DonePlayerBathsComment				= LC6_FALSE
	DonePlayerAmphitheatreComment		= LC6_FALSE
	DonePlayerPrisonComment				= LC6_FALSE
	
	MArmoury							= 0
	RArmoury							= 0
	Temple								= 0
	PlayerOwnsTownByForce				= LC6_FALSE
	PlayerOwnsTownByImpress				= LC6_FALSE

	GreekCapacity						= 0
	JapaneseCapacity					= 0

	PlayerHousesPlaced					= 0
	JapaneseHousesPlaced				= 0
	PlayerHousesBuilt					= 0
	JapaneseHousesBuilt					= 0

	StartedBuildingWalls				= LC6_FALSE

	Ctr									= 0
	GotHouse							= LC6_FALSE

	ScenicTreeCommentTimer				= create timer for 300 seconds				// 5 mins

	Food								= 0
	Wood								= 0
	Ore									= 0
	NumberofPlayerWalls					= 0
start

	add resource RESOURCE_TYPE_FOOD 10000 to L6JapaneseCapital

    add resource RESOURCE_TYPE_WOOD 10000 to L6JapaneseCapital

    add resource RESOURCE_TYPE_ORE 10000 to L6JapaneseCapital

	// Start the general off as a neutral player until the choice is made
	LC6_JapanesePlayingStyle	= LC6_NEUTRAL
	LC6_BuildingSetToUse		= LC6_NEUTRAL_ALIGN


	// Setup the wall positions - in the order they will be built
	LC6_WallPos[0] = marker at {988.389,111.063,1876.981}			// Front Gatehouse
	LC6_WallPos[1] = marker at {1160.666,113.097,1843.978}		// Front right curved wall 1
	LC6_WallPos[2] = marker at {941.842,116.319,1908.636}			// Front left wall
	LC6_WallPos[3] = marker at {1198.482,110.952,1874.909}		// Front right curved wall 2
	LC6_WallPos[4] = marker at {1239.250,111.132,1910.483}		// Front right curved wall 3
	LC6_WallPos[5] = marker at {923.706,116.534,1960.510}			// Left Gatehouse
	LC6_WallPos[6] = marker at {965.210,135.764,2061.530}			// Back left wall
	LC6_WallPos[7] = marker at {1234.736,117.552,1958.419}		// Right Gatehouse
	LC6_WallPos[8] = marker at {1257.764,127.406,2050.072}		// Back right wall 1
	LC6_WallPos[9] = marker at {1201.955,144.729,2083.948}		// Back right wall 2

	
	// List the building types
	BuildingType[0] = variable ABODE_NUMBER_A
	BuildingType[1] = variable ABODE_NUMBER_B
	BuildingType[2] = variable ABODE_NUMBER_C
	BuildingType[3] = variable ABODE_NUMBER_D
	BuildingType[4] = variable ABODE_NUMBER_E
	BuildingType[5] = variable ABODE_NUMBER_SKYSCRAPER
	BuildingType[6] = variable ABODE_NUMBER_ALTAR
	BuildingType[7] = variable ABODE_NUMBER_STORAGE_PIT
	BuildingType[8] = variable ABODE_NUMBER_CRECHE
	BuildingType[9] = variable ABODE_NUMBER_SHRINE
	BuildingType[10] = variable ABODE_NUMBER_TEMPLE
	BuildingType[11] = variable ABODE_NUMBER_PUB
	BuildingType[12] = variable ABODE_NUMBER_TOWN_CENTRE
	BuildingType[13] = variable ABODE_NUMBER_CREATURE_PEN
	BuildingType[14] = variable ABODE_NUMBER_FIELD
	BuildingType[15] = variable ABODE_NUMBER_MELEE_ARMOURY
	BuildingType[16] = variable ABODE_NUMBER_RANGED_ARMOURY
	BuildingType[17] = variable ABODE_NUMBER_WORKSHOP
	BuildingType[18] = variable ABODE_NUMBER_STUDY
	BuildingType[19] = variable ABODE_NUMBER_UNIVERSITY
	BuildingType[20] = variable ABODE_NUMBER_PRISON
	BuildingType[21] = variable ABODE_NUMBER_SMELTER
	BuildingType[22] = variable ABODE_NUMBER_GRANARY
	BuildingType[23] = variable ABODE_NUMBER_LUMBERMILL
	BuildingType[24] = variable ABODE_NUMBER_MARKET_POT
	BuildingType[25] = variable ABODE_NUMBER_MARKET_STATUE
	BuildingType[26] = variable ABODE_NUMBER_MARKET_PLANT
	BuildingType[27] = variable ABODE_NUMBER_AMPITHEATRE
	BuildingType[28] = variable ABODE_NUMBER_GRAVEYARD
	BuildingType[29] = variable ABODE_NUMBER_OLD_PERSONS_HOME
	BuildingType[30] = variable ABODE_NUMBER_BATHHOUSE
	BuildingType[31] = variable ABODE_NUMBER_WALLTOWER_TECH0
	BuildingType[32] = variable ABODE_NUMBER_WALLTOWER_TECH1
	BuildingType[33] = variable ABODE_NUMBER_GATEHOUSE
	
	
	// Sets the maximum amount of buildings the Japanese general will build, -1 will be unlimited amount
	MaxAmountOfBuildingType[0] = -1							// ABODE_NUMBER_A
	MaxAmountOfBuildingType[1] = -1							// ABODE_NUMBER_B
	MaxAmountOfBuildingType[2] = -1							// ABODE_NUMBER_C
	MaxAmountOfBuildingType[3] = -1							// ABODE_NUMBER_D
	MaxAmountOfBuildingType[4] = -1							// ABODE_NUMBER_E
	MaxAmountOfBuildingType[5] = -1							// ABODE_NUMBER_SKYSCRAPER
	MaxAmountOfBuildingType[6] = 1							// ABODE_NUMBER_ALTAR
	MaxAmountOfBuildingType[7] = 1							// ABODE_NUMBER_STORAGE_PIT
	MaxAmountOfBuildingType[8] = 1							// ABODE_NUMBER_CRECHE
	MaxAmountOfBuildingType[9] = 1							// ABODE_NUMBER_SHRINE
	MaxAmountOfBuildingType[10] = 1							// ABODE_NUMBER_TEMPLE
	MaxAmountOfBuildingType[11] = 1							// ABODE_NUMBER_PUB
	MaxAmountOfBuildingType[12] = 1							// ABODE_NUMBER_TOWN_CENTRE
	MaxAmountOfBuildingType[13] = 1							// ABODE_NUMBER_CREATURE_PEN
	MaxAmountOfBuildingType[14] = -1						// ABODE_NUMBER_FIELD
	MaxAmountOfBuildingType[15] = 1							// ABODE_NUMBER_MELEE_ARMOURY
	MaxAmountOfBuildingType[16] = 1							// ABODE_NUMBER_RANGED_ARMOURY
	MaxAmountOfBuildingType[17] = 1							// ABODE_NUMBER_WORKSHOP
	MaxAmountOfBuildingType[18] = 1							// ABODE_NUMBER_STUDY
	MaxAmountOfBuildingType[19] = 1							// ABODE_NUMBER_UNIVERSITY
	MaxAmountOfBuildingType[20] = 1							// ABODE_NUMBER_PRISON
	MaxAmountOfBuildingType[21] = 1							// ABODE_NUMBER_SMELTER
	MaxAmountOfBuildingType[22] = 1							// ABODE_NUMBER_GRANARY
	MaxAmountOfBuildingType[23] = 1							// ABODE_NUMBER_LUMBERMILL
	MaxAmountOfBuildingType[24] = 1							// ABODE_NUMBER_MARKET_POT
	MaxAmountOfBuildingType[25] = 1							// ABODE_NUMBER_MARKET_STATUE
	MaxAmountOfBuildingType[26] = 1							// ABODE_NUMBER_MARKET_PLANT
	MaxAmountOfBuildingType[27] = 1							// ABODE_NUMBER_AMPITHEATRE
	MaxAmountOfBuildingType[28] = 1							// ABODE_NUMBER_GRAVEYARD
	MaxAmountOfBuildingType[29] = 1							// ABODE_NUMBER_OLD_PERSONS_HOME
	MaxAmountOfBuildingType[30] = 1							// ABODE_NUMBER_BATHHOUSE
	MaxAmountOfBuildingType[31] = -1						// ABODE_NUMBER_WALLTOWER_TECH0
	MaxAmountOfBuildingType[32] = -1						// ABODE_NUMBER_WALLTOWER_TECH1
	MaxAmountOfBuildingType[33] = 3							// ABODE_NUMBER_GATEHOUSE
	NumberofPlayerWalls	= get number of built ABODE_NUMBER_WALLTOWER_TECH0 in L6GreekTown
	NumberofPlayerWalls += get number of built ABODE_NUMBER_WALLTOWER_TECH1 in L6GreekTown
	// Looping stuff...
	begin loop
		// Keep track of the building set we're using and if we have locked into a way of progressing
		if LC6_SelectedPlayingStyle == LC6_FALSE
			// Check to see if we should lock into a war like general or an impressive type general
			MArmoury = get building ABODE_NUMBER_MELEE_ARMOURY in L6GreekTown min built 1.0
			RArmoury = get building ABODE_NUMBER_RANGED_ARMOURY in L6GreekTown min built 1.0
			Temple = get building ABODE_NUMBER_TEMPLE in L6GreekTown min built 1.0

			Ctr = 0
			PlayerOwnsTownByForce = LC6_FALSE
			PlayerOwnsTownByImpress = LC6_FALSE
			force while Ctr < L6_NUM_OF_MINOR_SETTLEMENTS and PlayerOwnsTownByImpress == LC6_FALSE and PlayerOwnsTownByForce == LC6_FALSE
				if LC6_WhoOwnsTown[Ctr] == LC6_PLAYER
					if LC6_TakenTownByForceOrImpress[Ctr] == LC6_IMPRESS
						PlayerOwnsTownByImpress = LC6_TRUE
					elsif LC6_TakenTownByForceOrImpress[Ctr] == LC6_FORCE
						PlayerOwnsTownByForce = LC6_TRUE
					end if
				end if
				Ctr++
			end while

			// Should we lock into a mode?
			if MArmoury exists or RArmoury exists or PlayerOwnsTownByForce == LC6_TRUE
				run script LC6_SetJapanesePlayingStyle(LC6_WAR)
				BuildBuilding = build town L6JapaneseCapital buildings of type constant BuildingType[BUILDING_TYPE_MELEE_ARMOURY] in group LC6_BuildingSetToUse
				BuildBuilding = build town L6JapaneseCapital buildings of type constant BuildingType[BUILDING_TYPE_RANGED_ARMOURY] in group LC6_BuildingSetToUse
				LC6_BuildWalls = LC6_TRUE

			elsif Temple exists or PlayerOwnsTownByImpress == LC6_TRUE
				run script LC6_SetJapanesePlayingStyle(LC6_CITY)
				BuildBuilding = build town L6JapaneseCapital buildings of type constant BuildingType[BUILDING_TYPE_RANGED_ARMOURY] in group LC6_BuildingSetToUse
				LC6_BuildWalls = LC6_TRUE
			end if
		end if



		// Get the general to build the basic town buildings
		if BuiltInitialBuildings == LC6_FALSE
			// Build the storage pit
			BuildBuilding = build town L6JapaneseCapital buildings of type constant BuildingType[BUILDING_TYPE_STORAGE_PIT] in group LC6_BuildingSetToUse
			BuiltInitialBuildings = LC6_TRUE
		end if



		// Check to see if the general should comment on the buildings that he's built
		// Abodes check
		if DoneBuiltAbodesComment == LC6_FALSE
			Building = get number of built ABODE_NUMBER_A in L6JapaneseCapital
			Building += get number of built ABODE_NUMBER_B in L6JapaneseCapital
			Building += get number of built ABODE_NUMBER_C in L6JapaneseCapital
			Building += get number of built ABODE_NUMBER_D in L6JapaneseCapital
			Building += get number of built ABODE_NUMBER_E in L6JapaneseCapital

			if Building >= 6
				if LC6_JapanesePlayingStyle == LC6_CITY
					run script LC6_GeneralReactions(LC6_GEN_REACT_CITY_BUILT_ABODES)
				else
					run script LC6_GeneralReactions(LC6_GEN_REACT_WAR_BUILT_ABODES)
				end if
				DoneBuiltAbodesComment = LC6_TRUE
			end if
		end if

		// Fields
		/*if DoneBuiltFieldsComment == LC6_FALSE
			Building = get building FIELD_OBJECT in L6JapaneseCapital min built 1.0
			if Building >= 1
				if LC6_JapanesePlayingStyle == LC6_CITY
					run script LC6_GeneralReactions(LC6_GEN_REACT_CITY_BUILT_FIELDS)
				else
					run script LC6_GeneralReactions(LC6_GEN_REACT_WAR_BUILT_FIELDS)
				end if
				DoneBuiltFieldsComment = LC6_TRUE
			end if
		end if*/

		// Storage Pit
		if DoneBuiltStoragePitComment == LC6_FALSE
			Building = get building ABODE_NUMBER_STORAGE_PIT in L6JapaneseCapital min built 1.0

			if Building exists
				if LC6_JapanesePlayingStyle == LC6_CITY
					run script LC6_GeneralReactions(LC6_GEN_REACT_CITY_BUILT_STORAGE_PIT)
				else
					run script LC6_GeneralReactions(LC6_GEN_REACT_WAR_BUILT_STORAGE_PIT)
				end if
				DoneBuiltStoragePitComment = LC6_TRUE
			end if
		end if

		// Temple
		if DoneBuiltTempleComment == LC6_FALSE
			Building = get building ABODE_NUMBER_TEMPLE in L6JapaneseCapital min built 1.0

			if Building exists
				if LC6_JapanesePlayingStyle == LC6_CITY
					run script LC6_GeneralReactions(LC6_GEN_REACT_CITY_BUILT_TEMPLE)
				else
					// No response yet
				end if
				DoneBuiltTempleComment = LC6_TRUE
			end if
		end if

		// Granary
		if DoneBuiltGranaryComment == LC6_FALSE
			Building = get building ABODE_NUMBER_GRANARY in L6JapaneseCapital min built 1.0
			
			if Building exists
				if LC6_JapanesePlayingStyle == LC6_CITY
					run script LC6_GeneralReactions(LC6_GEN_REACT_CITY_BUILT_GRANARY)
				else
					// No response yet
				end if
				DoneBuiltGranaryComment = LC6_TRUE
			end if
		end if

		// Scenic Trees		-		Say the line after a time delay as you cannot place scenic trees
		if DoneBuiltScenicTreesComment == LC6_FALSE
			if get ScenicTreeCommentTimer time remaining <= 0
				if LC6_JapanesePlayingStyle == LC6_CITY
					run script LC6_GeneralReactions(LC6_GEN_REACT_CITY_BUILT_SCENIC_TREES)
				else
					// No response yet
				end if
				DoneBuiltScenicTreesComment = LC6_TRUE
			end if
		end if

		// Nursery
		if DoneBuiltNurseryComment == LC6_FALSE
			Building = get building ABODE_NUMBER_CRECHE in L6JapaneseCapital min built 1.0
			
			if Building exists
				if LC6_JapanesePlayingStyle == LC6_CITY
					run script LC6_GeneralReactions(LC6_GEN_REACT_CITY_BUILT_NURSERY)
				else
					run script LC6_GeneralReactions(LC6_GEN_REACT_WAR_BUILT_NURSERY)
				end if
				DoneBuiltNurseryComment = LC6_TRUE
			end if
		end if

		// Fertility Statue		-		Only the Greeks have the fertility staute so commented lines out
		if DoneBuiltFertilityStatueComment == LC6_FALSE			
			if LC6_JapanesePlayingStyle == LC6_CITY
//				run script LC6_GeneralReactions(LC6_GEN_REACT_CITY_BUILT_FERTILITY_STATUE)
			else
//				run script LC6_GeneralReactions(LC6_GEN_REACT_WAR_BUILT_FERTILITY_STATUE)
			end if
			DoneBuiltFertilityStatueComment = LC6_TRUE
		end if

		// Market
		if DoneBuiltMarketComment == LC6_FALSE
			Building = get building ABODE_NUMBER_MARKET_POT in L6JapaneseCapital min built 1.0
			if Building not exists
				Building = get building ABODE_NUMBER_MARKET_STATUE in L6JapaneseCapital min built 1.0
			end if
			if Building not exists
				Building = get building ABODE_NUMBER_MARKET_PLANT in L6JapaneseCapital min built 1.0
			end if
			
			if Building exists
				if LC6_JapanesePlayingStyle == LC6_CITY
					run script LC6_GeneralReactions(LC6_GEN_REACT_CITY_BUILT_MARKET)
				else
					// No response yet
				end if
				DoneBuiltMarketComment = LC6_TRUE
			end if
		end if
			
		// Tavern
		if DoneBuiltTavernComment == LC6_FALSE
			Building = get building ABODE_NUMBER_PUB in L6JapaneseCapital min built 1.0
			
			if Building exists
				if LC6_JapanesePlayingStyle == LC6_CITY
					run script LC6_GeneralReactions(LC6_GEN_REACT_CITY_BUILT_TAVERN)
				else
					// No response yet
				end if
				DoneBuiltTavernComment = LC6_TRUE
			end if
		end if
			
		// Wall
		if DoneBuiltWallComment == LC6_FALSE
			Building = get building ABODE_NUMBER_WALLTOWER_TECH0 in L6JapaneseCapital min built 1.0
			if Building not exists
				Building = get building ABODE_NUMBER_WALLTOWER_TECH1 in L6JapaneseCapital min built 1.0
			end if

			if Building exists
				if LC6_JapanesePlayingStyle == LC6_CITY
					run script LC6_GeneralReactions(LC6_GEN_REACT_CITY_BUILT_WALL)
				else
					run script LC6_GeneralReactions(LC6_GEN_REACT_WAR_BUILT_WALL)
				end if
				DoneBuiltWallComment = LC6_TRUE
			end if
		end if

		// Gatehouse
		if DoneBuiltGateHouseComment == LC6_FALSE
			Building = get building ABODE_NUMBER_GATEHOUSE in L6JapaneseCapital min built 1.0

			if Building exists
				if LC6_JapanesePlayingStyle == LC6_CITY
					run script LC6_GeneralReactions(LC6_GEN_REACT_CITY_BUILT_GATEHOUSE)
				else
					run script LC6_GeneralReactions(LC6_GEN_REACT_WAR_BUILT_GATEHOUSE)
				end if
				DoneBuiltGateHouseComment = LC6_TRUE
			end if
		end if

		// Ranged Armoury
		if DoneRangedArmouryComment == LC6_FALSE
			Building = get building ABODE_NUMBER_RANGED_ARMOURY in L6JapaneseCapital min built 1.0
			
			if Building exists
				if LC6_JapanesePlayingStyle == LC6_CITY
					// No response yet
				else
					run script LC6_GeneralReactions(LC6_GEN_REACT_WAR_BUILT_RANGED_ARMOURY)
				end if
				DoneRangedArmouryComment = LC6_TRUE
			end if
		end if

		// Melee Armoury
		if DoneMeleeArmouryComment == LC6_FALSE
			Building = get building ABODE_NUMBER_MELEE_ARMOURY in L6JapaneseCapital min built 1.0

			if Building exists
				if LC6_JapanesePlayingStyle == LC6_CITY
					// No response yet
				else
					run script LC6_GeneralReactions(LC6_GEN_REACT_WAR_BUILT_MELEE_ARMOURY)
				end if
				DoneMeleeArmouryComment = LC6_TRUE
			end if
		end if



		// Check to see if the general should comment on the buildings that the player has built
		// Hut
		if DonePlayerHutComment == LC6_FALSE
			Building = get building ABODE_NUMBER_A in L6GreekTown min built 1.0

			if Building exists
				run script LC6_GeneralReactions(LC6_GEN_REACT_TO_PLAYER_BUILDING_HUT)
				DonePlayerHutComment = LC6_TRUE
			end if
		end if

		// House
		if DonePlayerHouseComment == LC6_FALSE
			Building = get building ABODE_NUMBER_B in L6GreekTown min built 1.0
			if Building exists
				run script LC6_GeneralReactions(LC6_GEN_REACT_TO_PLAYER_BUILDING_HOUSE)
				DonePlayerHouseComment = LC6_TRUE
			end if
		end if

		// Villa
		if DonePlayerVillaComment == LC6_FALSE
			Building = get building ABODE_NUMBER_C in L6GreekTown min built 1.0
			if Building exists
				run script LC6_GeneralReactions(LC6_GEN_REACT_TO_PLAYER_BUILDING_VILLA)
				DonePlayerVillaComment = LC6_TRUE
			end if
		end if

		// Mansion
		if DonePlayerMansionComment == LC6_FALSE
			Building = get building ABODE_NUMBER_D in L6GreekTown min built 1.0
			if Building exists
				run script LC6_GeneralReactions(LC6_GEN_REACT_TO_PLAYER_BUILDING_MANSION)
				DonePlayerMansionComment = LC6_TRUE
			end if
		end if

		// Manor
		if DonePlayerManorComment == LC6_FALSE
			Building = get building ABODE_NUMBER_E in L6GreekTown min built 1.0
			if Building exists
				run script LC6_GeneralReactions(LC6_GEN_REACT_TO_PLAYER_BUILDING_MANOR)
				DonePlayerManorComment = LC6_TRUE
			end if
		end if

		// Skyscraper
		if DonePlayerSkyscraperComment == LC6_FALSE
			Building = get building ABODE_NUMBER_SKYSCRAPER in L6GreekTown min built 1.0
			if Building exists
				run script LC6_GeneralReactions(LC6_GEN_REACT_TO_PLAYER_BUILDING_SKYSCRAPER)
				DonePlayerSkyscraperComment = LC6_TRUE
			end if
		end if

		// Altar
		if DonePlayerAltarComment == LC6_FALSE
			Building = get building ABODE_NUMBER_ALTAR in L6GreekTown min built 1.0
			if Building exists
				run script LC6_GeneralReactions(LC6_GEN_REACT_TO_PLAYER_BUILDING_ALTAR)
				DonePlayerAltarComment = LC6_TRUE
			end if
		end if

		// Storehouse
		if DonePlayerStorehouseComment == LC6_FALSE
			Building = get building ABODE_NUMBER_STORAGE_PIT in L6GreekTown min built 1.0
			if Building exists
				run script LC6_GeneralReactions(LC6_GEN_REACT_TO_PLAYER_BUILDING_STOREHOUSE)
				DonePlayerStorehouseComment = LC6_TRUE
			end if
		end if

		// Field
		if DonePlayerFieldComment == LC6_FALSE
			Building = get number of built ABODE_NUMBER_FIELD in L6GreekTown
			if Building > 0
				run script LC6_GeneralReactions(LC6_GEN_REACT_TO_PLAYER_BUILDING_FIELD)
				DonePlayerFieldComment = LC6_TRUE
			end if
		end if

		// Creature Pen
		if DonePlayerCreaturePenComment == LC6_FALSE
			Building = get building ABODE_NUMBER_CREATURE_PEN in L6GreekTown min built 1.0
			if Building exists
				run script LC6_GeneralReactions(LC6_GEN_REACT_TO_PLAYER_BUILDING_CREATURE_PEN)
				DonePlayerCreaturePenComment = LC6_TRUE
			end if
		end if

		// Gatehouse
		if DonePlayerGatehouseComment == LC6_FALSE
			Building = get building ABODE_NUMBER_GATEHOUSE in L6GreekTown min built 1.0
			if Building exists
				run script LC6_GeneralReactions(LC6_GEN_REACT_TO_PLAYER_BUILDING_GATEHOUSE)
				DonePlayerGatehouseComment = LC6_TRUE
			end if
		end if

		// Graveyard
		if DonePlayerGraveyardComment == LC6_FALSE
			Building = get building ABODE_NUMBER_GRAVEYARD in L6GreekTown min built 1.0
			if Building exists
				run script LC6_GeneralReactions(LC6_GEN_REACT_TO_PLAYER_BUILDING_GRAVEYARD)
				DonePlayerGraveyardComment = LC6_TRUE
			end if
		end if

		// Tavern
		if DonePlayerTavernComment == LC6_FALSE
			Building = get building ABODE_NUMBER_PUB in L6GreekTown min built 1.0
			if Building exists
				run script LC6_GeneralReactions(LC6_GEN_REACT_TO_PLAYER_BUILDING_TAVERN)
				DonePlayerTavernComment = LC6_TRUE
			end if
		end if

		// Nursery
		if DonePlayerPrisonComment == LC6_FALSE
			Building = get building ABODE_NUMBER_PRISON in L6GreekTown min built 1.0
			if Building exists
				run script LC6_GeneralReactions(LC6_GEN_REACT_TO_PLAYER_BUILDING_PRISON)
				DonePlayerPrisonComment = LC6_TRUE
			end if
		end if

		// Nursery
		if DonePlayerNurseryComment == LC6_FALSE
			Building = get building ABODE_NUMBER_CRECHE in L6GreekTown min built 1.0
			if Building exists
				run script LC6_GeneralReactions(LC6_GEN_REACT_TO_PLAYER_BUILDING_NURSERY)
				DonePlayerNurseryComment = LC6_TRUE
			end if
		end if

		// University
		if DonePlayerUniversityComment == LC6_FALSE
			Building = get building ABODE_NUMBER_UNIVERSITY in L6GreekTown min built 1.0
			if Building exists
				run script LC6_GeneralReactions(LC6_GEN_REACT_TO_PLAYER_BUILDING_UNIVERSITY)
				DonePlayerUniversityComment = LC6_TRUE
			end if
		end if

		// Rest Home
		if DonePlayerResthomeComment == LC6_FALSE
			Building = get building ABODE_NUMBER_OLD_PERSONS_HOME in L6GreekTown min built 1.0
			if Building exists
				run script LC6_GeneralReactions(LC6_GEN_REACT_TO_PLAYER_BUILDING_RESTHOME)
				DonePlayerResthomeComment = LC6_TRUE
			end if
		end if

		// Fortified Wall
		if DonePlayerFortifiedWallComment == LC6_FALSE
		
			Building = get number of built ABODE_NUMBER_WALLTOWER_TECH0 in L6GreekTown
			Building += get number of built ABODE_NUMBER_WALLTOWER_TECH1 in L6GreekTown
			
			if Building > NumberofPlayerWalls
				run script LC6_GeneralReactions(LC6_GEN_REACT_TO_PLAYER_BUILDING_FORTIFIED_WALL)
				DonePlayerFortifiedWallComment = LC6_TRUE
			end if
		end if

		// Temple
		if DonePlayerTempleComment == LC6_FALSE
			Building = get building ABODE_NUMBER_TEMPLE in L6GreekTown min built 1.0
			if Building exists
				run script LC6_GeneralReactions(LC6_GEN_REACT_TO_PLAYER_BUILDING_TEMPLE)
				DonePlayerTempleComment = LC6_TRUE
			end if
		end if

		// Lumber Mill
		if DonePlayerLumbermillComment == LC6_FALSE
			Building = get building ABODE_NUMBER_LUMBERMILL in L6GreekTown min built 1.0
			if Building exists
				run script LC6_GeneralReactions(LC6_GEN_REACT_TO_PLAYER_BUILDING_LUMBERMILL)
				DonePlayerLumbermillComment = LC6_TRUE
			end if
		end if

		// Smelter
		if DonePlayerSmelterComment == LC6_FALSE
			Building = get building ABODE_NUMBER_SMELTER in L6GreekTown min built 1.0
			if Building exists
				run script LC6_GeneralReactions(LC6_GEN_REACT_TO_PLAYER_BUILDING_SMELTER)
				DonePlayerSmelterComment = LC6_TRUE
			end if
		end if

		// Granary
		if DonePlayerGranaryComment == LC6_FALSE
			Building = get building ABODE_NUMBER_GRANARY in L6GreekTown min built 1.0
			if Building exists
				run script LC6_GeneralReactions(LC6_GEN_REACT_TO_PLAYER_BUILDING_GRANARY)
				DonePlayerGranaryComment = LC6_TRUE
			end if
		end if

		// Baths
		if DonePlayerBathsComment == LC6_FALSE
			Building = get building ABODE_NUMBER_BATHHOUSE in L6GreekTown min built 1.0
			if Building exists
				run script LC6_GeneralReactions(LC6_GEN_REACT_TO_PLAYER_BUILDING_BATHOUSE)
				DonePlayerBathsComment = LC6_TRUE
			end if
		end if

		// Amphithertre
		if DonePlayerAmphitheatreComment == LC6_FALSE
			Building = get building ABODE_NUMBER_AMPITHEATRE in L6GreekTown min built 1.0
			if Building exists
				run script LC6_GeneralReactions(LC6_GEN_REACT_TO_PLAYER_BUILDING_AMPHITHEATRE)
				DonePlayerAmphitheatreComment = LC6_TRUE
			end if
		end if



		// Mimicking the Greek town on capacity rather than 1 for 1
		GreekCapacity			= capacity of L6GreekTown
		JapaneseCapacity		= capacity of L6JapaneseCapital

		PlayerHousesPlaced		= 0
		PlayerHousesBuilt		= 0
		JapaneseHousesPlaced	= 0
		JapaneseHousesBuilt		= 0

		// Store the number of abodes the sides have placed an built
		// Check in the minor towns if they are owned as the player might desert their initial town
		Ctr = 0
		force while Ctr < L6_NUM_OF_MINOR_SETTLEMENTS
			if LC6_TownOrSettlement[Ctr] == LC6_TOWN and not is town L6_MinorSettlement[Ctr] settlement
				if LC6_WhoOwnsTown[Ctr] == LC6_PLAYER 
					PlayerHousesPlaced += get number of unbuilt ABODE_NUMBER_A in L6_MinorSettlement[Ctr] + get number of built ABODE_NUMBER_A in L6_MinorSettlement[Ctr]
					PlayerHousesPlaced += get number of unbuilt ABODE_NUMBER_B in L6_MinorSettlement[Ctr] + get number of built ABODE_NUMBER_B in L6_MinorSettlement[Ctr]
					PlayerHousesPlaced += get number of unbuilt ABODE_NUMBER_C in L6_MinorSettlement[Ctr] + get number of built ABODE_NUMBER_C in L6_MinorSettlement[Ctr]
					PlayerHousesPlaced += get number of unbuilt ABODE_NUMBER_D in L6_MinorSettlement[Ctr] + get number of built ABODE_NUMBER_D in L6_MinorSettlement[Ctr]
					PlayerHousesPlaced += get number of unbuilt ABODE_NUMBER_E in L6_MinorSettlement[Ctr] + get number of built ABODE_NUMBER_E in L6_MinorSettlement[Ctr]

					PlayerHousesBuilt += get number of built ABODE_NUMBER_A in L6_MinorSettlement[Ctr]
					PlayerHousesBuilt += get number of built ABODE_NUMBER_B in L6_MinorSettlement[Ctr]
					PlayerHousesBuilt += get number of built ABODE_NUMBER_C in L6_MinorSettlement[Ctr]
					PlayerHousesBuilt += get number of built ABODE_NUMBER_D in L6_MinorSettlement[Ctr]
					PlayerHousesBuilt += get number of built ABODE_NUMBER_E in L6_MinorSettlement[Ctr]

				elsif LC6_WhoOwnsTown[Ctr] == LC6_OPPONENT
					JapaneseHousesPlaced += get number of unbuilt ABODE_NUMBER_A in L6_MinorSettlement[Ctr]	+ get number of built ABODE_NUMBER_A in L6_MinorSettlement[Ctr]
					JapaneseHousesPlaced += get number of unbuilt ABODE_NUMBER_B in L6_MinorSettlement[Ctr]	+ get number of built ABODE_NUMBER_B in L6_MinorSettlement[Ctr]
					JapaneseHousesPlaced += get number of unbuilt ABODE_NUMBER_C in L6_MinorSettlement[Ctr]	+ get number of built ABODE_NUMBER_C in L6_MinorSettlement[Ctr]
					JapaneseHousesPlaced += get number of unbuilt ABODE_NUMBER_D in L6_MinorSettlement[Ctr]	+ get number of built ABODE_NUMBER_D in L6_MinorSettlement[Ctr]
					JapaneseHousesPlaced += get number of unbuilt ABODE_NUMBER_E in L6_MinorSettlement[Ctr] + get number of built ABODE_NUMBER_E in L6_MinorSettlement[Ctr]

					JapaneseHousesBuilt += get number of built ABODE_NUMBER_A in L6_MinorSettlement[Ctr]
					JapaneseHousesBuilt += get number of built ABODE_NUMBER_B in L6_MinorSettlement[Ctr]
					JapaneseHousesBuilt += get number of built ABODE_NUMBER_C in L6_MinorSettlement[Ctr]
					JapaneseHousesBuilt += get number of built ABODE_NUMBER_D in L6_MinorSettlement[Ctr]
					JapaneseHousesBuilt += get number of built ABODE_NUMBER_E in L6_MinorSettlement[Ctr]
				end if
			end if
			Ctr++
		end while

		// Check in the players home town
		PlayerHousesPlaced += get number of unbuilt ABODE_NUMBER_A in L6GreekTown + get number of built ABODE_NUMBER_A in L6GreekTown
		PlayerHousesPlaced += get number of unbuilt ABODE_NUMBER_B in L6GreekTown + get number of built ABODE_NUMBER_B in L6GreekTown
		PlayerHousesPlaced += get number of unbuilt ABODE_NUMBER_C in L6GreekTown + get number of built ABODE_NUMBER_C in L6GreekTown
		PlayerHousesPlaced += get number of unbuilt ABODE_NUMBER_D in L6GreekTown + get number of built ABODE_NUMBER_D in L6GreekTown
		PlayerHousesPlaced += get number of unbuilt ABODE_NUMBER_E in L6GreekTown + get number of built ABODE_NUMBER_E in L6GreekTown

		PlayerHousesBuilt += get number of built ABODE_NUMBER_A in L6GreekTown
		PlayerHousesBuilt += get number of built ABODE_NUMBER_B in L6GreekTown
		PlayerHousesBuilt += get number of built ABODE_NUMBER_C in L6GreekTown
		PlayerHousesBuilt += get number of built ABODE_NUMBER_D in L6GreekTown
		PlayerHousesBuilt += get number of built ABODE_NUMBER_E in L6GreekTown
							 
		// Check in the Japanese generals home town
		JapaneseHousesPlaced += get number of unbuilt ABODE_NUMBER_A in L6JapaneseCapital + get number of built ABODE_NUMBER_A in L6JapaneseCapital
		JapaneseHousesPlaced += get number of unbuilt ABODE_NUMBER_B in L6JapaneseCapital + get number of built ABODE_NUMBER_B in L6JapaneseCapital
		JapaneseHousesPlaced += get number of unbuilt ABODE_NUMBER_C in L6JapaneseCapital + get number of built ABODE_NUMBER_C in L6JapaneseCapital
		JapaneseHousesPlaced += get number of unbuilt ABODE_NUMBER_D in L6JapaneseCapital + get number of built ABODE_NUMBER_D in L6JapaneseCapital
		JapaneseHousesPlaced += get number of unbuilt ABODE_NUMBER_E in L6JapaneseCapital + get number of built ABODE_NUMBER_E in L6JapaneseCapital

		JapaneseHousesBuilt += get number of built ABODE_NUMBER_A in L6JapaneseCapital
		JapaneseHousesBuilt += get number of built ABODE_NUMBER_B in L6JapaneseCapital
		JapaneseHousesBuilt += get number of built ABODE_NUMBER_C in L6JapaneseCapital
		JapaneseHousesBuilt += get number of built ABODE_NUMBER_D in L6JapaneseCapital
		JapaneseHousesBuilt += get number of built ABODE_NUMBER_E in L6JapaneseCapital

		// Handle the building of houses
		if JapaneseHousesPlaced + JapaneseHousesBuilt <= PlayerHousesPlaced + PlayerHousesBuilt
			// Build a house type abode
			GotHouse = LC6_FALSE
			Building = BUILDING_TYPE_HOUSE_A
			force while Building <= BUILDING_TYPE_SKYSCRAPER and GotHouse == LC6_FALSE
				BuildHouse = build town L6JapaneseCapital buildings of type constant BuildingType[Building] in group LC6_BuildingSetToUse
				if BuildHouse exists
					GotHouse = LC6_TRUE
				end if
				Building++
			end while
			
			// If we've not got a building to build and we're not using the neutral set have a look in there
			// as we can build from both the neutral and the selected set
			if BuildHouse not exists and LC6_BuildingSetToUse != LC6_NEUTRAL_ALIGN
				GotHouse = LC6_FALSE
				Building = BUILDING_TYPE_HOUSE_A
				force while Building <= BUILDING_TYPE_SKYSCRAPER and GotHouse == LC6_FALSE
					BuildHouse = build town L6JapaneseCapital buildings of type constant BuildingType[Building] in group LC6_NEUTRAL_ALIGN
					if BuildHouse exists
						GotHouse = LC6_TRUE
					end if
					Building++
				end while
			end if
		end if

		// Handle the special buildings (buildings that are set specific - ie not houses)
		Building = BUILDING_TYPE_ALTAR
		force while Building < LC6_NUM_BUILDINGS
			// Get the totals for both players home towns
			GreekBuildingTotal[Building] = get number of unbuilt constant BuildingType[Building] in L6GreekTown + get number of built constant BuildingType[Building] in L6GreekTown
			JapaneseBuildingTotal[Building]	= get number of unbuilt constant BuildingType[Building] in L6JapaneseCapital + get number of built constant BuildingType[Building] in L6JapaneseCapital

			// Get the totals for both players minor towns if they own them
			Ctr = 0
			force while Ctr < L6_NUM_OF_MINOR_SETTLEMENTS
				if LC6_TownOrSettlement[Ctr] == LC6_TOWN
					if LC6_WhoOwnsTown[Ctr] == LC6_PLAYER
						GreekBuildingTotal[Building] += get number of unbuilt constant BuildingType[Building] in L6_MinorSettlement[Ctr] + get number of built constant BuildingType[Building] in L6_MinorSettlement[Ctr] 
					elsif LC6_WhoOwnsTown[Ctr] == LC6_OPPONENT
						JapaneseBuildingTotal[Building]	+= get number of unbuilt constant BuildingType[Building] in L6_MinorSettlement[Ctr] + get number of built constant BuildingType[Building] in L6_MinorSettlement[Ctr] 
					end if
				end if
				Ctr++
			end while

			// Check each building type to match the Greeks
			if GreekBuildingTotal[Building] > JapaneseBuildingTotal[Building]
				if JapaneseBuildingTotal[Building] < MaxAmountOfBuildingType[Building] or MaxAmountOfBuildingType[Building] == -1
					// Should be able to just build it as it's not a house and if it isn't in the set it won't be built
					BuildSpecial = build town L6JapaneseCapital buildings of type constant BuildingType[Building] in group LC6_BuildingSetToUse
				end if
			else
				// The Greeks don't have more of this building type than the Japanese				

				// Should we build a melee armoury as it's needed for an attack?				
				if JapaneseBuildingTotal[BUILDING_TYPE_MELEE_ARMOURY] < 1 and LC6_MeleeShouldBeBuiult == LC6_TRUE
					BuildSpecial = build town L6JapaneseCapital buildings of type constant BuildingType[BUILDING_TYPE_MELEE_ARMOURY] in group LC6_BuildingSetToUse

					if BuildSpecial not exists
						// We need to manually build one here...
					end if
				end if
							
				// Should we build a ranged armoury as it's needed for an attack?
				if JapaneseBuildingTotal[BUILDING_TYPE_RANGED_ARMOURY] < 1 and LC6_RangedShouldBeBuiult == LC6_TRUE
					BuildSpecial = build town L6JapaneseCapital buildings of type constant BuildingType[BUILDING_TYPE_RANGED_ARMOURY] in group LC6_BuildingSetToUse

					if BuildSpecial not exists
						// We need to manually build one here...
					end if
				end if
			end if
			Building++
		end while


		// Build the walls
		if LC6_BuildWalls == LC6_TRUE and StartedBuildingWalls == LC6_FALSE
			run background script LC6_BuildJapaneseWalls
			StartedBuildingWalls = LC6_TRUE
		end if

	until L6CapitalConverted == LC6_TRUE
	end loop
	
end script LC6_CityManagement


//-----------------------------------------------------------------------------
//	Build up the walls of the Japanese capital
//-----------------------------------------------------------------------------
begin script LC6_BuildJapaneseWalls

	NumWallsBuilt		= 0
	Ctr					= 0

start
	wait until get number of built ABODE_NUMBER_MELEE_ARMOURY in L6JapaneseCapital > 0
	
	// Build the walls
	begin loop
		Ctr = 0
		while Ctr < LC6_NUM_WALLS
			if LC6_Wall[Ctr] not exists
				LC6_Wall[Ctr] = build building at {LC6_WallPos[Ctr]} desire 0.8
			end if
			Ctr++
		end while

		// Have we built the walls?
		Ctr = 0
		NumWallsBuilt = 0
		while Ctr < LC6_NUM_WALLS
			if LC6_Wall[Ctr] exists
				if BUILT of LC6_Wall[Ctr] >= 1.0
					NumWallsBuilt++
				end if
			end if
			Ctr++
		end while

		if NumWallsBuilt >= LC6_NUM_WALLS
			LC6_BuiltWallsAroundCapital = LC6_TRUE
		end if

	until LC6_BuiltWallsAroundCapital == LC6_TRUE or L6CapitalConverted == LC6_TRUE
	end loop
	
	if LC6_BuiltWallsAroundCapital == LC6_TRUE
		if LC6_GeneralsInitialArchersBusy == LC6_FALSE
			add action PLATOON_AGENDA_ACTION_GET_ON_WALL using LC6_Wall[0] to LC6_GeneralsInitialArchers action queue
			LC6_GeneralsInitialArchersBusy = LC6_TRUE
		end if
	end if
	
	run background script LC6_RoadBuilder
	
end script LC6_BuildJapaneseWalls


//-----------------------------------------------------------------------------
//	Handle the Japanese creatures actions
//-----------------------------------------------------------------------------
begin script LC6_CreatureManagement

	CreatureDead			= LC6_FALSE

start

	begin loop
		// Has the creature been killed
		if HEALTH of LC6_JapaneseCreature <= 0 or LC6_JapaneseCreature not exists
			CreatureDead = LC6_TRUE
		else
		
			// Do the creature stuff here...
			
		end if
	
	until CreatureDead == LC6_TRUE or L6CapitalConverted == LC6_TRUE
	end loop
	
	// Release the creature
	if CreatureDead == LC6_FALSE and L6CapitalConverted == LC6_TRUE
		release LC6_JapaneseCreature
	end if

end script LC6_CreatureManagement


//-----------------------------------------------------------------------------
//	Setup the generic patrol routes
//-----------------------------------------------------------------------------
begin script LC6_SetupGenericPatrolRoutes
	
	WP_1			= 0								// Waypoint 1
	WP_2			= 0								// Waypoint 2
	WP_3			= 0								// Waypoint 3
	WP_4			= 0								// Waypoint 4
	WP_5			= 0								// Waypoint 5
	WP_6			= 0								// Waypoint 6
	WP_7			= 0								// Waypoint 7
	WP_8			= 0								// Waypoint 8
	WP_9			= 0								// Waypoint 9
	WP_10			= 0								// Waypoint 10
	
start
	
	// Initial waypoints - any waypoints that are not used need to be set to 0, {0.000,0.000,0.000} is not a good idea
	
	// Patrol around town and down to the houses by the shoreline
	WP_1	= marker at {1312.080,101.580,1986.318}
	WP_2	= marker at {1404.542,92.260,1912.955}
	WP_3	= marker at {1552.957,63.043,1941.944}
	WP_4	= marker at {1579.253,50.545,1812.276}
	WP_5	= marker at {1390.705,53.280,1744.965}
	WP_6	= marker at {1578.882,55.945,1910.231}
	WP_7	= marker at {1409.936,92.595,1915.634}
	WP_8	= marker at {1274.365,110.893,1883.869}
	WP_9	= marker at {1145.263,101.092,1844.367}
	WP_10	= 0
	run script LC6_SetupIndividualPatrolRoute(0, WP_1, WP_2, WP_3, WP_4, WP_5, WP_6, WP_7, WP_8, WP_9, WP_10)
	
	// Patrol around the other side of the city
	WP_1	= marker at {877.937,114.291,2002.504}
	WP_2	= marker at {894.473,113.245,1910.087}
	WP_3	= marker at {791.924,98.670,1944.342}
	WP_4	= marker at {769.907,72.590,1861.227}
	WP_5	= marker at {707.065,70.518,1882.446}
	WP_6	= marker at {594.682,124.743,1989.927}
	WP_7	= marker at {538.183,106.948,2142.958}
	WP_8	= marker at {475.468,61.273,1889.311}
	WP_9	= 0
	WP_10	= 0
	run script LC6_SetupIndividualPatrolRoute(1, WP_1, WP_2, WP_3, WP_4, WP_5, WP_6, WP_7, WP_8, WP_9, WP_10)
	
	// Patrol route outside the walls at the front and down to the little area of wall off to the side
	WP_1	= marker at {961.015,103.956,1856.174}
	WP_2	= marker at {956.874,87.348,1772.443}
	WP_3	= marker at {1017.759,74.402,1710.563}
	WP_4	= marker at {1050.789,77.952,1749.708}
	WP_5	= marker at {1011.618,89.604,1788.664}
	WP_6	= marker at {1031.158,101.226,1837.837}
	WP_7	= marker at {1186.497,107.194,1848.224}
	WP_8	= marker at {1037.475,105.796,1858.431}
	WP_9	= 0
	WP_10	= 0	
	run script LC6_SetupIndividualPatrolRoute(2, WP_1, WP_2, WP_3, WP_4, WP_5, WP_6, WP_7, WP_8, WP_9, WP_10)
	
	// Patrolling around the close minor settlements on the off side
	WP_1	= marker at {895.473,69.105,1653.526}
	WP_2	= marker at {821.093,67.395,1687.959}
	WP_3	= marker at {802.890,88.364,1605.906}
	WP_4	= marker at {839.636,67.691,1709.326}
	WP_5	= marker at {872.722,69.253,1610.752}
	WP_6	= marker at {805.721,70.126,1542.574}
	WP_7	= marker at {840.249,63.457,1453.534}
	WP_8	= marker at {958.597,83.682,1451.997}
	WP_9	= marker at {981.338,87.864,1561.416}
	WP_10	= marker at {876.963,59.229,1553.870}
	run script LC6_SetupIndividualPatrolRoute(3, WP_1, WP_2, WP_3, WP_4, WP_5, WP_6, WP_7, WP_8, WP_9, WP_10)
	
	// Patrolling around the minor settlement in front of the small wall area
	WP_1	= marker at {1119.298,75.193,1607.580}
	WP_2	= marker at {1090.793,71.848,1551.420}
	WP_3	= marker at {1133.120,68.662,1507.112}
	WP_4	= marker at {1184.954,71.941,1535.062}
	WP_5	= marker at {1297.569,69.454,1544.592}
	WP_6	= marker at {1211.294,47.080,1630.733}
	WP_7	= marker at {1149.939,63.964,1637.395}
	WP_8	= 0
	WP_9	= 0
	WP_10	= 0
	run script LC6_SetupIndividualPatrolRoute(4, WP_1, WP_2, WP_3, WP_4, WP_5, WP_6, WP_7, WP_8, WP_9, WP_10)
	
	// Secret way around the beck edge of the map to get to the player (may not be navigable)
	WP_1	= marker at {872.718,65.823,1584.400}
	WP_2	= marker at {786.056,72.218,1538.392}
	WP_3	= marker at {635.232,61.958,1681.201}
	WP_4	= marker at {609.823,109.434,1578.976}
	WP_5	= marker at {500.875,102.992,1551.142}
	WP_6	= marker at {526.481,47.803,1323.184}
	WP_7	= marker at {499.804,85.789,1122.870}
	WP_8	= marker at {380.113,57.507,1055.436}
	WP_9	= marker at {514.382,73.948,752.769}
	WP_10	= marker at {835.305,56.743,669.480}
	run script LC6_SetupIndividualPatrolRoute(5, WP_1, WP_2, WP_3, WP_4, WP_5, WP_6, WP_7, WP_8, WP_9, WP_10)
	
	// Straight down attack
	WP_1	= marker at {873.670,63.343,1575.250}
	WP_2	= marker at {797.624,70.092,1410.278}
	WP_3	= marker at {910.330,60.264,1220.758}
	WP_4	= marker at {934.742,52.801,975.974}
	WP_5	= marker at {899.289,56.315,744.233}
	WP_6	= 0
	WP_7	= 0
	WP_8	= 0
	WP_9	= 0
	WP_10	= 0
	run script LC6_SetupIndividualPatrolRoute(6, WP_1, WP_2, WP_3, WP_4, WP_5, WP_6, WP_7, WP_8, WP_9, WP_10)
	
	// Less sneaky attack
	WP_1	= marker at {865.003,61.630,1561.158}
	WP_2	= marker at {745.003,69.337,1318.650}
	WP_3	= marker at {604.630,52.393,1252.011}
	WP_4	= marker at {515.776,85.862,1131.266}
	WP_5	= marker at {379.459,58.346,1050.199}
	WP_6	= marker at {511.163,73.843,755.283}
	WP_7	= marker at {694.859,54.578,686.158}
	WP_8	= marker at {775.430,55.171,765.378}
	WP_9	= marker at {848.672,55.005,724.986}
	WP_10	= 0	
	run script LC6_SetupIndividualPatrolRoute(7, WP_1, WP_2, WP_3, WP_4, WP_5, WP_6, WP_7, WP_8, WP_9, WP_10)
	
	// Going to minor town
	WP_1	= marker at {1019.424,103.198,1790.917}
	WP_2	= marker at {926.955,71.910,1701.492}
	WP_3	= marker at {881.284,68.996,1724.192}
	WP_4	= 0
	WP_5	= 0
	WP_6	= 0
	WP_7	= 0
	WP_8	= 0
	WP_9	= 0
	WP_10	= 0	
	run script LC6_SetupIndividualPatrolRoute(8, WP_1, WP_2, WP_3, WP_4, WP_5, WP_6, WP_7, WP_8, WP_9, WP_10)
	
	// Patrolling around most minor settlements
	WP_1	= marker at {1005.579,104.699,1812.754}
	WP_2	= marker at {1009.143,73.281,1345.109}
	WP_3	= marker at {894.111,64.003,1464.957}
	WP_4	= marker at {876.773,68.598,1711.702}
	WP_5	= marker at {1135.106,69.264,1557.909}
	WP_6	= marker at {791.012,68.891,1288.911}
	WP_7	= marker at {980.010,87.032,1441.796}
	WP_8	= marker at {1070.847,75.125,1579.374}
	WP_9	= marker at {994.477,83.915,1700.353}
	WP_10	= 0
	run script LC6_SetupIndividualPatrolRoute(9, WP_1, WP_2, WP_3, WP_4, WP_5, WP_6, WP_7, WP_8, WP_9, WP_10)
	
/*
	// Extra routes that can be setup and used mid script
	run script LC6_SetupIndividualPatrolRoute(10, WP_1, WP_2, WP_3, WP_4, WP_5, WP_6, WP_7, WP_8, WP_9, WP_10)
	run script LC6_SetupIndividualPatrolRoute(11, WP_1, WP_2, WP_3, WP_4, WP_5, WP_6, WP_7, WP_8, WP_9, WP_10)
	run script LC6_SetupIndividualPatrolRoute(12, WP_1, WP_2, WP_3, WP_4, WP_5, WP_6, WP_7, WP_8, WP_9, WP_10)
	run script LC6_SetupIndividualPatrolRoute(13, WP_1, WP_2, WP_3, WP_4, WP_5, WP_6, WP_7, WP_8, WP_9, WP_10)
	run script LC6_SetupIndividualPatrolRoute(14, WP_1, WP_2, WP_3, WP_4, WP_5, WP_6, WP_7, WP_8, WP_9, WP_10)
	run script LC6_SetupIndividualPatrolRoute(15, WP_1, WP_2, WP_3, WP_4, WP_5, WP_6, WP_7, WP_8, WP_9, WP_10)
	run script LC6_SetupIndividualPatrolRoute(16, WP_1, WP_2, WP_3, WP_4, WP_5, WP_6, WP_7, WP_8, WP_9, WP_10)
	run script LC6_SetupIndividualPatrolRoute(17, WP_1, WP_2, WP_3, WP_4, WP_5, WP_6, WP_7, WP_8, WP_9, WP_10)
	run script LC6_SetupIndividualPatrolRoute(18, WP_1, WP_2, WP_3, WP_4, WP_5, WP_6, WP_7, WP_8, WP_9, WP_10)
	run script LC6_SetupIndividualPatrolRoute(19, WP_1, WP_2, WP_3, WP_4, WP_5, WP_6, WP_7, WP_8, WP_9, WP_10)
*/

end script LC6_SetupGenericPatrolRoutes


//-----------------------------------------------------------------------------
//	Setup an individual patrol route
//-----------------------------------------------------------------------------
begin script LC6_SetupIndividualPatrolRoute(Route, Pos1, Pos2, Pos3, Pos4, Pos5, Pos6, Pos7, Pos8, Pos9, Pos10)
start

	// Create the patrol route container if it doesn't exist
	if Route < LC6_MAX_PATROL_ROUTES
		if not LC6_PatrolRoute[Route] exists
			LC6_PatrolRoute[Route] = create SCRIPT_OBJECT_TYPE_WAYPOINTROUTE at {L6JapaneseCapital}
		end if

		// Add the waypoints to the patrol routes
		if Pos1 exists
			add {Pos1} to waypoint list LC6_PatrolRoute[Route]
		end if
		
		if Pos2 exists
			add {Pos2} to waypoint list LC6_PatrolRoute[Route]
		end if
		
		if Pos3 exists
			add {Pos3} to waypoint list LC6_PatrolRoute[Route]
		end if
		
		if Pos4 exists
			add {Pos4} to waypoint list LC6_PatrolRoute[Route]
		end if
		
		if Pos5 exists
			add {Pos5} to waypoint list LC6_PatrolRoute[Route]
		end if
		
		if Pos6 exists
			add {Pos6} to waypoint list LC6_PatrolRoute[Route]
		end if
		
		if Pos7 exists
			add {Pos7} to waypoint list LC6_PatrolRoute[Route]
		end if
		
		if Pos8 exists
			add {Pos8} to waypoint list LC6_PatrolRoute[Route]
		end if
		
		if Pos9 exists
			add {Pos9} to waypoint list LC6_PatrolRoute[Route]
		end if
		
		if Pos10 exists
			add {Pos10} to waypoint list LC6_PatrolRoute[Route]
		end if
	else
		if LC6_ShowDebug == LC6_TRUE
//			say "ERROR: Trying to add a patrol route outside the bounds: 0 to $d." with number LC6_MAX_PATROL_ROUTES
			wait until read
		end if
	end if

end script LC6_SetupIndividualPatrolRoute


//-----------------------------------------------------------------------------
//	Arrange the towns so that the nearest to the Japanese capital is the lowest index etc
//-----------------------------------------------------------------------------
begin script LC6_ReorderTownsSoNearestToJapaneseFirst

	TownDistancesFromJapanese[L6_NUM_OF_MINOR_SETTLEMENTS]
	Ctr					= 0
	Ctr2				= 0
	Temp				= 0

start

	// Store the distances from each town to the Japabese capital in ascending order (closest first)
	Ctr = 0
	while Ctr < L6_NUM_OF_MINOR_SETTLEMENTS
		TownDistancesFromJapanese[Ctr] = get distance from {L6JapaneseCapital} to {L6_MinorSettlement[Ctr]}
		Ctr++
	end while

	// Arrange order of towns so that the nearest is first	
	Ctr = 0
	Ctr2 = 0
	while Ctr < L6_NUM_OF_MINOR_SETTLEMENTS - 1
		Ctr2 = Ctr + 1
		while Ctr2 < L6_NUM_OF_MINOR_SETTLEMENTS
			// Do we need to swap the order around?
			// *** MAKE SURE ALL TOWN ARRAYS ARE REORDERED ***
			if TownDistancesFromJapanese[Ctr] > TownDistancesFromJapanese[Ctr2]
				// Swap distances
				Temp = TownDistancesFromJapanese[Ctr]
				TownDistancesFromJapanese[Ctr] = TownDistancesFromJapanese[Ctr2]
				TownDistancesFromJapanese[Ctr2] = Temp
				
				// Swap towns
				Temp = L6_MinorSettlement[Ctr]
				L6_MinorSettlement[Ctr] = L6_MinorSettlement[Ctr2]
				L6_MinorSettlement[Ctr2] = Temp

				// Swap who owns town info
				Temp = LC6_WhoOwnsTown[Ctr]
				LC6_WhoOwnsTown[Ctr] = LC6_WhoOwnsTown[Ctr2]
				LC6_WhoOwnsTown[Ctr2] = Temp

				// Swap taken by force or impress info
				Temp = LC6_TakenTownByForceOrImpress[Ctr]
				LC6_TakenTownByForceOrImpress[Ctr] = LC6_TakenTownByForceOrImpress[Ctr2]
				LC6_TakenTownByForceOrImpress[Ctr2] = Temp

				// Swap town or settlement info
				Temp = LC6_TownOrSettlement[Ctr]
				LC6_TownOrSettlement[Ctr] = LC6_TownOrSettlement[Ctr2]
				LC6_TownOrSettlement[Ctr2] = Temp
			end if
			
			Ctr2++
		end while
		
		Ctr++
	end while

end script LC6_ReorderTownsSoNearestToJapaneseFirst


//-----------------------------------------------------------------------------
//	Recruit the units of the Japanese capital
//-----------------------------------------------------------------------------
begin script LC6_RecruitPlatoons

	MINIMUM_SIZE_OF_ATTACK_FORCE	= 15
	MAXIMUM_SIZE_OF_ATTACK_FORCE	= 50
	HANDICAP						= 5
	NumberOfSoldiers				= 0
	Ctr								= 0
	RecruitTimer					= create timer for 0 seconds
start

	// Keep recruiting platoons for the general depending on the current amount needed
	begin loop
	//----Only recruit if we have at least 20 villagers----//	
		if adult size of L6JapaneseCapital - get number of platoon warriors belonging to player 1 > 20 and get RecruitTimer time remaining == 0
			// Recruit the guarding units here...
			Ctr = 0
			while Ctr < LC6_NumGuardingPlatoons and Ctr < LC6_MAX_PLATOONS
				if LC6_GuardingPlatoon[Ctr] not exists and can town L6JapaneseCapital recruit constant LC6_TypeOfPlatoon platoon of size 15
					if LC6_NeedResources == LC6_TRUE
						LC6_NeedResources = LC6_FALSE
						set town L6JapaneseCapital desire for TOWN_DESIRE_TO_BUILD to -1
					end if
					
					// Recruit the platoon
					LC6_GuardingPlatoon[Ctr] = recruit constant LC6_TypeOfPlatoon town L6JapaneseCapital platoon of size 15
					wait until not LC6_GuardingPlatoon[Ctr] recruiting
					enable platoon LC6_GuardingPlatoon[Ctr] camp
					enable platoon LC6_GuardingPlatoon[Ctr] respond to town L6JapaneseCapital attack
					disable platoon LC6_GuardingPlatoon[Ctr] respond to local platoon attack
					clear LC6_GuardingPlatoon[Ctr] action queue

					if town L6JapaneseCapital is under takeover from player 0
						wait 30 seconds
						set RecruitTimer time to DOMSBIGTIME seconds
					elsif LC6_EnemyHasLotsOfArmies == LC6_TRUE
						wait 30 seconds
						set RecruitTimer time to DOMTIME seconds
					end if
				end if
			
				Ctr++		
			end while
			
			// Do the recruiting of the attacking armies
			// Wait until the player is not recruiting so we can work out the size of their army for the handicapping
			//wait until not L6GreekTown recruiting
			
			// Limit the size of the attacking platoons to make sure they will not be too big for the player
			if LC6_NumAttackingPlatoons > 0
				NumberOfSoldiers = get number of platoon warriors belonging to player 0 
				NumberOfSoldiers /= (LC6_MAX_PLATOONS*2)
			end if
			
			// Make sure we have a minimum size of platoon
			if NumberOfSoldiers < MINIMUM_SIZE_OF_ATTACK_FORCE //or NumberOfSoldiers > get army size in town L6GreekTown
				NumberOfSoldiers = MINIMUM_SIZE_OF_ATTACK_FORCE
			//elsif NumberOfSoldiers > MAXIMUM_SIZE_OF_ATTACK_FORCE
				//NumberOfSoldiers = MAXIMUM_SIZE_OF_ATTACK_FORCE
			end if
					
			// Recruit the attacking units here...
			Ctr = 0
			while Ctr < LC6_NumAttackingPlatoons and Ctr < LC6_MAX_PLATOONS
				if LC6_AttackingPlatoon[Ctr] not exists and can town L6JapaneseCapital recruit constant LC6_TypeOfPlatoon platoon of size NumberOfSoldiers
					// Recruit the platoon
					LC6_AttackingPlatoon[Ctr] = recruit constant LC6_TypeOfPlatoon town L6JapaneseCapital platoon of size NumberOfSoldiers
					wait until not LC6_AttackingPlatoon[Ctr] recruiting
					enable platoon LC6_AttackingPlatoon[Ctr] camp
					enable platoon LC6_AttackingPlatoon[Ctr] respond to town L6JapaneseCapital attack
					disable platoon LC6_AttackingPlatoon[Ctr] respond to local platoon attack
					clear LC6_AttackingPlatoon[Ctr] action queue			

					if town L6JapaneseCapital is under takeover from player 0
						set RecruitTimer time to DOMSBIGTIME seconds
						wait 30 seconds
					elsif LC6_EnemyHasLotsOfArmies == LC6_TRUE
						wait 30 seconds
						set RecruitTimer time to DOMTIME seconds
					end if
				end if
				
				Ctr++
			end while
			
			
			
			// Recruit the catapults here...
		end if
	until L6CapitalConverted == LC6_TRUE		
	end loop

end script LC6_RecruitPlatoons


//-----------------------------------------------------------------------------
//	Give the reactions from the Japanese general
//-----------------------------------------------------------------------------
begin script LC6_GeneralReactions(ID)
start

	wait until dialogue ready //or 10 seconds
	
	if dialogue ready
		begin dialogue
			if ID == LC6_GEN_REACT_ARRIVAL
				// Dialogue is now in the intro script
				
			elsif ID == LC6_GEN_REACT_TAKE_FIRST_SETTLEMENT_IMP
				// GEN: Why would my people forfeit their honour and join the enemy?
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_120"
				wait until read
				
			elsif ID == LC6_GEN_REACT_TAKE_FIRST_SETTLEMENT_ARM
				// GEN: So they choose the path of war? A path we know every inch of, and will defend with honour.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_130"
				wait until read
				
			elsif ID == LC6_GEN_REACT_TAKE_SECOND_SETTLEMENT_IMP
				// GEN: These Greeks are expanding their territory. We must remain vigilant.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_140"
				wait until read
				
				// Kick off the construction of the Wonder
				run background script LC6_OkToStartWonder				
				
			elsif ID == LC6_GEN_REACT_TAKE_SECOND_SETTLEMENT_ARM
				// GEN: Their armies march across the land. Honour of the field of battle is our only option!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_150"
				wait until read

				// Kick off the construction of the Wonder
				run background script LC6_OkToStartWonder
				
			elsif ID == LC6_GEN_REACT_KICK_OFF_SIREN
				// GEN: Start the construction of the Siren Wonder!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_10"
				wait until read
				eject evil spirit 
				//EA: "Oh this is bad."
				say "BW2T_HELP_TEXT_GUIDANCE_BATTLE_ALERT_EA_11"
				wait until read
				
			elsif ID == LC6_GEN_REACT_KICK_OFF_HURRICANE
				// GEN: Start the construction of the Hurricane Wonder!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_20"
				wait until read
				
			elsif ID == LC6_GEN_REACT_TAKE_THIRD_SETTLEMENT_IMP
				// GEN: They have taken another settlement? Ha! Those that expand too fast expose their flanks!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_160"
				wait until read
				
			elsif ID == LC6_GEN_REACT_TAKE_THIRD_SETTLEMENT_ARM
				// GEN: No! This military advance must be stopped. We must shore up our defences!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_170"
				wait until read

			elsif ID == LC6_GEN_REACT_TAKE_FOURTH_SETTLEMENT_IMP
				// GEN: My people leave for the Greeks? No, they are my people no longer. The strong will remain with me!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_180"
				wait until read

			elsif ID == LC6_GEN_REACT_TAKE_FOURTH_SETTLEMENT_ARM
				// GEN: They sneer at the honour of the Japanese. I will be get revenge. But the clever commander chooses his time carefully.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_190"
				wait until read

			elsif ID == LC6_GEN_REACT_TAKE_FIFTH_SETTLEMENT_IMP
				// GEN: This betrayal will end! Those leaving my tribe will live to regret their mistake!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_200"
				wait until read

			elsif ID == LC6_GEN_REACT_TAKE_FIFTH_SETTLEMENT_ARM
				// GEN: Their armies take a Town from us? Step up our defences!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_210"
				wait until read

			elsif ID == LC6_GEN_REACT_TAKE_FIRST_TOWN_IMP
				// GEN: The Greeks are ambitious! They tempt our Towns. Send archers to fortify from the walls!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_220"
				wait until read

			elsif ID == LC6_GEN_REACT_TAKE_SECOND_TOWN_IMP
				// GEN: The teachings say we must build to keep our people! We must remind the villagers that their honour is to the Japanese!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_230"
				wait until read

			elsif ID == LC6_GEN_REACT_TAKE_THIRD_TOWN_IMP
				// GEN: Why do the people migrate to them and not us?
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_30"
				wait until read

			elsif ID == LC6_GEN_REACT_TAKE_FOURTH_TOWN_IMP
				// GEN: I am impressed by the Greek builders skill.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_40"
				wait until read

			elsif ID == LC6_GEN_REACT_TAKE_FIFTH_TOWN_IMP
				// GEN: We cannot compete with such competent builders.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_50"
				wait until read

			elsif ID == LC6_GEN_REACT_CROSSED_MAJINO_LINE_EARLY_ARM
				// GEN: They are trying a tactical rush. It seems they know the Teachings of War.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_970"
				wait until read

			elsif ID == LC6_GEN_REACT_TAKE_TOWN_THREE_AFTER_TOWN_ONE_OR_TWO_ARM
				// GEN: We must retake that Town! Go now, troops!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_950"
				wait until read

			elsif ID == LC6_GEN_REACT_TAKE_TOWN_ONE_AFTER_RUSH_ARM
				// GEN: They are doubling back! Take defensive measures!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_980"
				wait until read

			elsif ID == LC6_GEN_REACT_TAKE_TOWN_TWO_AFTER_RUSH_ARM
				// GEN: Heh heh, they really backtracked there. Cowards!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_60"
				wait until read

			elsif ID == LC6_GEN_REACT_TAKE_TOWN_ONE_OR_TWO_BEFORE_RUSH_ARM
				// GEN: Their armies take a Town from us? Step up our defences! Send our raiders! The teachings say we must not let this lie!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_270"
				wait until read

			elsif ID == LC6_GEN_REACT_TAKE_OTHER_TOWN_BEFORE_RUSH_ARM
				// GEN: Their armies spread. The Teachings of War state that this must be stopped.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_940"
				wait until read

			elsif ID == LC6_GEN_REACT_TAKE_TOWN_FOUR_ARM
				// GEN: Withdraw troops! Defend our capital with honour and strength!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_960"
				wait until read

			elsif ID == LC6_GEN_REACT_TAKE_TOWN_FIVE_ARM
				// GEN: Pull back our men! We must defend our capital to the death!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_990"
				wait until read

			elsif ID == LC6_GEN_TAKES_FIRST_SETTLEMENT_IMP
				// GEN: These people join us and take up our code of honour. We will benefit from their strength.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_300"
				wait until read
				
			elsif ID == LC6_GEN_TAKES_FIRST_SETTLEMENT_ARM
				// GEN: Our armies grow and our numbers swell. The teachings say this is the surest way to victory.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_310"
				wait until read
				
			elsif ID == LC6_GEN_TAKES_SECOND_SETTLEMENT_IMP
				// GEN: More followers. We gain strength in such growing numbers! We cannot fail.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_320"
				wait until read
				
			elsif ID == LC6_GEN_TAKES_SECOND_SETTLEMENT_ARM
				// GEN: Again, we take control of more land. Our armies shall increase and we shall move forward like the mighty wind.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_330"
				wait until read
				
			elsif ID == LC6_GEN_TAKES_THIRD_SETTLEMENT_IMP
				// GEN: We unite against the Greek menace. Our honour and power shall drive them from this land.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_340"
				wait until read
				
			elsif ID == LC6_GEN_TAKES_THIRD_SETTLEMENT_ARM
				// GEN: With each victory our warriors grow stronger. The teachings say that belief is worth a thousand men.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_350"
				wait until read
				
			elsif ID == LC6_GEN_TAKES_FOURTH_SETTLEMENT_IMP
				// GEN: Ha! More people join the way of the Japanese. We have strength and conviction. We cannot lose!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_360"
				wait until read
				
			elsif ID == LC6_GEN_TAKES_FOURTH_SETTLEMENT_ARM
				// GEN: Never before have we amassed such an army. It is like the sea. It cannot be stopped.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_370"
				wait until read
				
			elsif ID == LC6_GEN_TAKES_FIFTH_SETTLEMENT_IMP
				// GEN: Look at those who join us! They will fight for us to the death. Honour and courage will prevail!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_380"
				wait until read
				
			elsif ID == LC6_GEN_TAKES_FIFTH_SETTLEMENT_ARM
				// GEN: Soon we will be unstoppable. In the word of the Teacher of War, like a flood of steel!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_390"
				wait until read

			elsif ID == LC6_GEN_TAKES_FIRST_TOWN_IMP
				// GEN: The people migrate to the Japanese way of life!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_410"
				wait until read

			elsif ID == LC6_GEN_TAKES_FIRST_TOWN_ARM
				// GEN: A Town is ours!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_400"
				wait until read

			elsif ID == LC6_GEN_TAKES_SECOND_TOWN_IMP
				// GEN: Our might and our culture brings in yet more souls!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_430"
				wait until read

			elsif ID == LC6_GEN_TAKES_SECOND_TOWN_ARM
				// GEN: Our ranks grow as more join us!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_420"
				wait until read

			elsif ID == LC6_GEN_TAKES_THIRD_TOWN_IMP
				// GEN: Another Town chooses the honourable path of Japanese enlightenment.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_450"
				wait until read

			elsif ID == LC6_GEN_TAKES_THIRD_TOWN_ARM
				// GEN: The people clamour to join our majestic capital!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_440"
				wait until read

			elsif ID == LC6_GEN_TAKES_FOURTH_TOWN_IMP
				// GEN: These Towns are keen to be part of our civilisation. We welcome them!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_460"
				wait until read

			elsif ID == LC6_GEN_TAKES_FOURTH_TOWN_ARM
				// GEN: We have out-fought the Greeks. They are no match for us!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_1000"
				wait until read

			elsif ID == LC6_GEN_TAKES_FIFTH_TOWN_IMP
				// GEN: Our impressiveness is legendary! The Town is ours!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_1010"
				wait until read

			elsif ID == LC6_GEN_TAKES_FIFTH_TOWN_ARM
				// GEN: The Greeks have been put to the sword!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_1020"
				wait until read
				
			elsif ID == LC6_GEN_SURRENDERS_PLAYER_WON_WITH_IMP
				// GEN: It is over! The Greeks have learnt well. My teachings have failed me. They knew themselves, and us, too well.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_470"
				wait until read
				
				// GEN: But they do not know my brother. His military skill is legendary.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_480"
				wait until read
				
			elsif ID == LC6_GEN_SURRENDERS_PLAYER_WON_WITH_ARM
				// GEN: The Greek armies are too powerful. We face dishonour in defeat.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_490"
				wait until read

				// GEN: But it is not over. My brother will bring retribution. He knows the Teachings of War better than I.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_500"
				wait until read
				
			elsif ID == LC6_GEN_REACT_PLAYER_BUILDS_ARMOURY
				// GEN: So the Greeks amass warriors? We must be ready for their inevitable assault!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_510"
				wait until read
				
			elsif ID == LC6_GEN_REACT_PLAYER_CREATES_THEIR_FIRST_PLATOON
				// GEN: They've built a platoon? They plan war!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_520"
				wait until read
				
			elsif ID == LC6_GEN_REACT_PLAYER_CREATES_THEIR_FIRST_CATAPULT
				// GEN: The Greeks build siege weapons. As the Teachings say, we must ready our own to face them.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_530"
				wait until read
				
			elsif ID == LC6_GEN_REACT_PLAYER_USES_MAGIC_FIRST_TIME
				// GEN: What magic is this they use against us? There is no honour here!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_540"
				wait until read
				
			elsif ID == LC6_GEN_REACT_PLAYER_USES_CREATURE_OFFENSIVELY_FIRST_TIME
				// GEN: The Greek Creature faces us in battle. This is worrying.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_550"
				wait until read
				
			elsif ID == LC6_GEN_REACT_IMPRESSIVE_LEVEL_1
				// GEN: The Greek hordes seem an easy foe. As the Teachings of War say, fear not your enemy.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_560"
				wait until read
				
			elsif ID == LC6_GEN_REACT_IMPRESSIVE_LEVEL_2
				// GEN: I have underestimated them. Their Town grows quickly.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_570"
				wait until read
				
			elsif ID == LC6_GEN_REACT_IMPRESSIVE_LEVEL_3
				// GEN: The Greeks have a formidable city. My people must work harder!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_580"
				wait until read
				
			elsif ID == LC6_GEN_REACT_PLAYER_KILLS_ENEMY_CREATURE
				// GEN: Our Creature has died. He fell with honour, but the Greeks will pay with their blood.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_590"
				wait until read
				
			elsif ID == LC6_GEN_REACT_PLAYER_POPULATION_EXPANDS_TO_X
				// GEN: The Greeks spread like blooms on a blood-soaked battlefield.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_600"
				wait until read
			
			elsif ID == LC6_GEN_REACT_PLAYER_TAKEN_ALL_MINOR_TOWNS_MOST_WITH_FORCE
				// GEN: They will pay for this. I will amass an unstoppable force and swoop on the Greeks!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_660"
				wait until read
				
			elsif ID == LC6_GEN_REACT_SIREN_READY_TO_CONVERT_ATTACKING_TROOPS
				// GEN: The Siren will shock the enemy. I will convert their men to our cause!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_1060"
				wait until read
				
			elsif ID == LC6_GEN_REACT_SIREN_READY_PLAYER_TRYING_TO_IMPRESS
				// GEN: Behold the power of this Epic Wonder!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_1070"
				wait until read
				
			elsif ID == LC6_GEN_REACT_PLAYER_SWITCHED_FROM_IMPRESS_TO_FORCE
				// GEN: They impressed those people and now they are going to use them to fight me! Recruit!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_70"
				wait until read
				
			elsif ID == LC6_GEN_REACT_PLAYER_SWITCHED_FROM_FORCE_TO_IMPRESS
				// GEN: They've wimped out of trying to fight; and they are now building an impressive city!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_80"
				wait until read
				// GEN: But we have a big headstart!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_90"
				wait until read
				
			elsif ID == LC6_GEN_REACT_PLAYER_INVESTIGATES_MONKS
				// GEN: Ive had it with those monks, they have refused to leave the sacred temple.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_100"
				wait until read
				// GEN: Platoon! Remove them by force!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_110"
				wait until read
				
			elsif ID == LC6_GEN_REACT_JAPANESE_PLATOON_READY_TO_ATTACK_MONKS
				// GEN: Now I shall forcibly remove those monks from the Temple; I will argue no longer with them!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_120"
				wait until read
				
			elsif ID == LC6_GEN_REACT_JAPANESE_PLATOON_DEAD_AFTER_ATTACKING_MONKS
				// GEN: What? A platoon of my finest warriors defeated so swiftly! I shall need to think about this...
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_130"
				wait until read
				
			elsif ID == LC6_GEN_REACT_PLAYER_ATTACKS_JAPANESE_HOME_TOWN
				// GEN: Defend the town!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_140"
				wait until read
				
			elsif ID == LC6_GEN_REACT_PLAYER_ATTACKS_JAPANESE_CLOSE_MINOR_TOWNS
				// GEN: No! This military advance must be stopped. We must shore up our defences!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_170"
				wait until read
				
			elsif ID == LC6_GEN_REACT_PLAYER_WINS_THE_LAND
				// GEN: They deserve respect for this victory, but they will not be so lucky on the next land!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_160"
				wait until read

			elsif ID == LC6_GEN_REACT_CITY_BUILT_ABODES
				// GEN: We can now house our people.  Excellent.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_690"
				wait until read

			elsif ID == LC6_GEN_REACT_CITY_BUILT_FIELDS
				// Food. The Teachings say never underestimate the supplies your people need.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_700"
				wait until read

			elsif ID == LC6_GEN_REACT_CITY_BUILT_STORAGE_PIT
				// GEN: Our Town now has the honour of a Storehouse.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_710"
				wait until read

			elsif ID == LC6_GEN_REACT_CITY_BUILT_TEMPLE
				// GEN: A magnificent Temple. We will earn respect and awe from all outsiders!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_720"
				wait until read

			elsif ID == LC6_GEN_REACT_CITY_BUILT_GRANARY
				// GEN: This Granary will speed our food production.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_730"
				wait until read

			elsif ID == LC6_GEN_REACT_CITY_BUILT_SCENIC_TREES
				// GEN: Our Town is now landscaped. We set great store by beauty.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_740"
				wait until read

			elsif ID == LC6_GEN_REACT_CITY_BUILT_NURSERY
				// GEN: We have a Nursery.  Children grow and learn honour and build us great cities!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_750"
				wait until read

			elsif ID == LC6_GEN_REACT_CITY_BUILT_FERTILITY_STATUE
				// GEN: Those who see our Fertility Statue will know the greatness of the Japanese.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_760"
				wait until read

			elsif ID == LC6_GEN_REACT_CITY_BUILT_MARKET
				// GEN: We now have a market. We Japanese are traders and builders at heart.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_770"
				wait until read

			elsif ID == LC6_GEN_REACT_CITY_BUILT_TAVERN
				// GEN: The Tavern will allow our hard-working people to relax and praise our culture through drink.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_780"
				wait until read

			elsif ID == LC6_GEN_REACT_CITY_BUILT_WALL
				// GEN: The Teachings say that Walls which keep the foe out, also keep the strength in.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_790"
				wait until read

			elsif ID == LC6_GEN_REACT_CITY_BUILT_GATEHOUSE
				// GEN: We will never bow to intruders. Our Gatehouses stand as warnings to all!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_800"
				wait until read

			elsif ID == LC6_GEN_REACT_WAR_BUILT_ABODES
				// GEN: We have homes for our warriors. Although they choose to be on the battlefield.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_810"
				wait until read

			elsif ID == LC6_GEN_REACT_WAR_BUILT_FIELDS
				// GEN: Our warriors have huge appetites. We need fields like this.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_820"
				wait until read

			elsif ID == LC6_GEN_REACT_WAR_BUILT_STORAGE_PIT
				// GEN: A warring nation needs resources. And this Storehouse will be full of them.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_830"
				wait until read

			elsif ID == LC6_GEN_REACT_WAR_BUILT_RANGED_ARMOURY
				// GEN: The Archers' Armoury will be vital for our defences.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_840"
				wait until read

			elsif ID == LC6_GEN_REACT_WAR_BUILT_MELEE_ARMOURY
				// GEN: We'll train the finest swordsmen with this Armoury.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_850"
				wait until read

			elsif ID == LC6_GEN_REACT_WAR_BUILT_NURSERY
				// GEN: A Nursery to nurture the honourable warriors of tomorrow.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_860"
				wait until read

			elsif ID == LC6_GEN_REACT_WAR_BUILT_FERTILITY_STATUE
				// GEN: We'll have more breeding with this Fertility Statue. And bigger armies.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_870"
				wait until read

			elsif ID == LC6_GEN_REACT_WAR_BUILT_WALL
				// GEN: Walls. So we may choose when we shall fight our foes.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_880"
				wait until read

			elsif ID == LC6_GEN_REACT_WAR_BUILT_GATEHOUSE
				// GEN: Ah, this sturdy Gatehouse is pleasing. It will defend us well!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_890"
				wait until read

			elsif ID == LC6_GEN_REACT_PLAYER_TAKES_BACK_TOWN
				// GEN: How can we have allowed them to take a town we had captured?
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_170"
				wait until read

			elsif ID == LC6_GEN_REACT_GENERAL_TAKES_BACK_TOWN
				// GEN: with our tenacious spirit even your captured towns are not safe!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_180"
				wait until read

			elsif ID == LC6_GEN_REACT_GENERAL_PLAYING_WAR_STYLE
				// GEN: So you like your armies do you? Bow to the might of MY armies.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_190"
				wait until read

			elsif ID == LC6_GEN_REACT_GENERAL_PLAYING_CITY_STYLE
				// GEN: So you are a city builder eh. Let's see if you can match MY city.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_200"
				wait until read

			elsif ID == LC6_GEN_REACT_TO_PLAYER_BUILDING_HUT
//				// GEN: They build with these simple huts? This is not impressive.
//				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_210"
//				wait until read

			elsif ID == LC6_GEN_REACT_TO_PLAYER_BUILDING_HOUSE
				// GEN: The Greeks wish to house their people. This shows foresight...
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_220"
				wait until read

			elsif ID == LC6_GEN_REACT_TO_PLAYER_BUILDING_VILLA
				// GEN: The Greek villas have a certain grace I will admit.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_230"
				wait until read

			elsif ID == LC6_GEN_REACT_TO_PLAYER_BUILDING_MANSION
				// GEN: I may take this dwelling as my own after I defeat you.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_240"
				wait until read

			elsif ID == LC6_GEN_REACT_TO_PLAYER_BUILDING_MANOR
				// GEN: Greek architecture is sturdy.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_250"
				wait until read

			elsif ID == LC6_GEN_REACT_TO_PLAYER_BUILDING_SKYSCRAPER
				// GEN: The Greeks build into the sky!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_260"
				wait until read

			elsif ID == LC6_GEN_REACT_TO_PLAYER_BUILDING_STOREHOUSE
				// GEN: It is wise to have good storage capacity.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_280"
				wait until read

			elsif ID == LC6_GEN_REACT_TO_PLAYER_BUILDING_FIELD
				// GEN: The Greeks cultivate their land.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_290"
				wait until read

			elsif ID == LC6_GEN_REACT_TO_PLAYER_BUILDING_CREATURE_PEN
				// GEN: They build a home for their creature?
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_300"
				wait until read

		// TR: Commenting out - similar line in dialogue manager
		//	elsif ID == LC6_GEN_REACT_TO_PLAYER_BUILDING_GATEHOUSE
				// GEN: The Greeks hide behind walls? I may not be able to get in but I can tempt their people out!
		//		say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_310"
		//		wait until read

			elsif ID == LC6_GEN_REACT_TO_PLAYER_BUILDING_GRAVEYARD
				// GEN: The Greeks bury their dead with respect.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_320"
				wait until read

			elsif ID == LC6_GEN_REACT_TO_PLAYER_BUILDING_TAVERN
				// GEN: Drink and be merry Greeks, for you never know what tomorrow may bring...
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_330"
				wait until read

			elsif ID == LC6_GEN_REACT_TO_PLAYER_BUILDING_NURSERY
				// GEN: The Greeks invest in their young. This is wise.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_340"
				wait until read

			elsif ID == LC6_GEN_REACT_TO_PLAYER_BUILDING_UNIVERSITY
				// GEN: The writings of your scholars could teach us much.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_350"
				wait until read

			elsif ID == LC6_GEN_REACT_TO_PLAYER_BUILDING_RESTHOME
				// GEN: At least these Greeks respect the elderly.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_360"
				wait until read

			elsif ID == LC6_GEN_REACT_TO_PLAYER_BUILDING_FORTIFIED_WALL
				// GEN: "That wall will not protect you from the magnificence of our City."
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_370"
				wait until read

			elsif ID == LC6_GEN_REACT_TO_PLAYER_BUILDING_TEMPLE
				// GEN: Praise your gods Greeks. Maybe they can help you defeat me?
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_380"
				wait until read

			elsif ID == LC6_GEN_REACT_TO_PLAYER_BUILDING_LUMBERMILL
				// GEN: A lumber mill. This will provide a lot of raw material for their buildings.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_390"
				wait until read

			elsif ID == LC6_GEN_REACT_TO_PLAYER_BUILDING_SMELTER
				// GEN: A smelter? What do you plan Greeks?
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_400"
				wait until read

			elsif ID == LC6_GEN_REACT_TO_PLAYER_BUILDING_GRANARY
				// GEN: A granary, this will feed the Greeks well.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_410"
				wait until read

			elsif ID == LC6_GEN_REACT_TO_PLAYER_BUILDING_BATHOUSE
				// GEN: Can you cleanse your spirit too Greeks?
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_420"
				wait until read

			elsif ID == LC6_GEN_REACT_TO_PLAYER_BUILDING_AMPHITHEATRE
				// GEN: The Greek amphitheatre is an engineering marvel. It inspires me.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_430"
				wait until read

			elsif ID == LC6_GEN_REACT_TO_PLAYER_BUILDING_PRISON
				// GEN: Ha! Prison? They are a criminal people.
				say "BW2T_SCRIPT_08FINAL_PLAYER_BUILDS_PRISON"
				wait until read

			end if
		end dialogue
	end if

end script LC6_GeneralReactions


//-----------------------------------------------------------------------------
//	Give the reactions from the advisors
//-----------------------------------------------------------------------------
begin script LC6_AdvisorReactions(ID)
start
	if ID == LC6_ADV_ADVISES_TO_BUILD_ARCHERY_ARMOURY
		wait until get toolbar state == variable MENU_TOOLBAR_STATE_OPEN_FULL
		wait until dialogue ready
	else
		wait until dialogue ready or 10 seconds
	end if
	
	if dialogue ready
		begin dialogue
			if ID == LC6_ADV_REACT_ARRIVAL
				// Dialogue now appears in the intro script as it's a cutscene
			
			elsif ID == LC6_ADV_REACT_PLAYER_X_IMPRESSIVE_BUILDINGS
				eject good spirit
				// GA: Marvellous. We have three very impressive buildings now.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_610"
				wait until read
				
			elsif ID == LC6_ADV_REACT_PLAYER_CREATES_X_BREEDERS
				eject evil spirit
				// EA: Yes. We've got a real people factory. The more people we have, the bigger armies we can recruit!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_620"
				wait until read

			elsif ID == LC6_ADV_REACT_PLAYER_TAKES_ALL_MINOR_TOWNS_MOST_WITH_IMPRESS
				eject good spirit
				// GA: This is excellent. All the small settlements are ours! We impressed them all with our Town!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_630"
				wait until read

				// GA: But something tells me the Japanese Town won't be so easy.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_640"
				wait until read

			elsif ID == LC6_ADV_REACT_PLAYER_TAKEN_ALL_MINOR_TOWNS_MOST_WITH_FORCE
				eject evil spirit
				// EA: Oh boy. We've really shed some blood. The enemy have just got to be shaking in their boots!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_650"
				wait until read
				
			elsif ID == LC6_ADV_REACT_PLAYERS_CREATURE_WINS_FIGHT
				eject evil spirit
				// EA: Oh superb! Our Creature rules!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_670"
				wait until read
				
			elsif ID == LC6_ADV_REACT_PLAYER_CREATES_X_SOLDIERS
				eject evil spirit
				// EA: We got, lemme see, 50 warriors. Now that's nice, Boss. Real nice.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_680"
				wait until read
			
			elsif ID == LC6_ADV_REACT_JAPANESE_PLATOON_READY_TO_ATTACK_MONKS
				eject evil spirit
				// EA: Hey Boss! You really want to come and watch this!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_440"
				wait until read
				// EA: Quick over here! The Japanese are trying to force the Monks to leave the Temple.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_450"
				wait until read
				// EA: This will be good for a laugh!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_460"
				wait until read
			
			elsif ID == LC6_ADV_REACT_JAPANESE_PLATOON_DEAD_AFTER_ATTACKING_MONKS
				eject evil spirit
				// EA: Hey; if we can get those Monks onto our side then they are bound to help us.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_470"
				wait until read
			
			elsif ID == LC6_ADV_REACT_PLAYER_PLATOON_NEARS_UNFRIENDLY_MONKS
				eject evil spirit
				// EA: I'm worried Boss! Those monks REALLY kick ass!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_480"
				wait until read
				// EA: I'd keep our people away until we've helped them out first.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_490"
				wait until read
				// EA: Check out the scroll above their temple... maybe they'll even fight for us!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_500"
				wait until read
			
			elsif ID == LC6_ADV_REACT_EPILOGUE
				eject good spirit
				eject evil spirit
				// GA: The Japanese know what they are up against now and will take measures against us.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_510"
				wait until read
				// GA: Lets go to the next land!
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_520"
				wait until read

			elsif ID == LC6_ADV_ADVISES_TO_BUILD_ARCHERY_ARMOURY
				eject evil spirit
				// EA: Hey boss, we've got enough tribute to build an archer armoury. Let's do it.
				say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_530"
				wait until read

			elsif ID == LC6_ADV_TELL_ABOUT_ARMIES_EATING_TWICE_AS_MUCH
				eject evil spirit
				// EA: An army marches on its stomach and these guys will eat at twice the normal rate. So keep an eye on your stores!
				say "BW2T_SCRIPT_03FINAL_BUILDTABTUTORIAL_1010"
				wait until read

			elsif ID == LC6_ADV_TELL_ABOUT_BUILDING_WALL
				eject good spirit
				// GA: Leader, you must start building a wall inside your influence. It can finish outside it, but not in an enemy's influence
				say "BW2T_SCRIPT_06FINAL_INTRO_90"
				wait until read
			end if
			
			send good spirit home
			send evil spirit home
		end dialogue
	end if

end script LC6_AdvisorReactions


//-----------------------------------------------------------------------------
//	Get the intro to the land
//-----------------------------------------------------------------------------
begin script LC6_LandIntro

	PortalPos			= marker at {948.615,128.037,2030.759}
	PlayerArcherPos		= marker at {869.172,56.294,740.945}
	TownPatrolRoute = create SCRIPT_OBJECT_TYPE_WAYPOINTROUTE at {0.000,0.000,0.000}
	
	PatrolPos1 = marker at {908.340,113.481,1915.207}
	PatrolPos2 = marker at {969.657,104.327,1853.618}
	PatrolPos3 = marker at {1032.132,112.390,1850.227}
	PatrolPos4 = marker at {973.911,104.652,1853.297}
	
	Counter = 0
	AddedVillager = 0
start
	add {PatrolPos1} to waypoint list TownPatrolRoute
	add {PatrolPos2} to waypoint list TownPatrolRoute
	add {PatrolPos3} to waypoint list TownPatrolRoute
	add {PatrolPos4} to waypoint list TownPatrolRoute
	
	// Fades to black at the end of this script
	run script Land6Intro
	
	Counter = 0
	force while Counter < 50
		AddedVillager = create random villager of tribe TRIBE_TYPE_JAPANESE at {L6JapaneseCapital} 
		attach AddedVillager to L6JapaneseCapital
		release AddedVillager
		Counter++
	end while
	DeletePeople = True

	// Create the Greek archers
	LC6_PlayersInitialArchers = create platoon PLATOON_INFO_GREEK_RANGED_1 at {PlayerArcherPos} with 50 men and 0 women
	PLAYER of LC6_PlayersInitialArchers = LC6_GREEK
	attach LC6_PlayersInitialArchers to L6GreekTown
	enable platoon LC6_PlayersInitialArchers camp
	release LC6_PlayersInitialArchers

	// Create the Japanese archers
	LC6_GeneralsInitialArchers = create platoon PLATOON_INFO_JAPANESE_RANGED_2 at {1045.683,120.197,1895.991} with 50 men and 0 women //get fire archer type for tribe TRIBE_TYPE_JAPANESE
	PLAYER of LC6_GeneralsInitialArchers = LC6_JAPANESE
	attach LC6_GeneralsInitialArchers to L6JapaneseCapital
	set LC6_GeneralsInitialArchers focus to {L6GreekTown}
	enable platoon LC6_GeneralsInitialArchers camp
	enable platoon LC6_GeneralsInitialArchers respond to town L6JapaneseCapital attack
	disable platoon LC6_GeneralsInitialArchers respond to local platoon attack

	// Create the Japanese melee units
	LC6_GeneralsInitialMelee = create platoon PLATOON_INFO_JAPANESE_MELEE_2 at {PatrolPos1} with 50 men and 0 women
	PLAYER of LC6_GeneralsInitialMelee = LC6_JAPANESE
	attach LC6_GeneralsInitialMelee to L6JapaneseCapital
	set LC6_GeneralsInitialMelee focus to {L6GreekTown}
	enable platoon LC6_GeneralsInitialMelee camp
	enable platoon LC6_GeneralsInitialMelee respond to town L6JapaneseCapital attack
	disable platoon LC6_GeneralsInitialMelee respond to local platoon attack
	
	move LC6_GeneralsInitialMelee along TownPatrolRoute with patrol WAYPOINTROUTE_TRAVERSAL_TYPE_CIRCULAR
	
	//Create Fire Archers
	LC6_GeneralsInitialFireArchers = create platoon PLATOON_INFO_JAPANESE_RANGED_3 at {1033.681, 117.778, 1877.219} with 50 men and 0 women
	PLAYER of LC6_GeneralsInitialFireArchers = LC6_JAPANESE
	attach LC6_GeneralsInitialFireArchers to L6JapaneseCapital
	set LC6_GeneralsInitialFireArchers focus to {L6GreekTown}
	disable platoon LC6_GeneralsInitialFireArchers camp
	enable platoon LC6_GeneralsInitialFireArchers respond to town L6JapaneseCapital attack
	disable platoon LC6_GeneralsInitialFireArchers respond to local platoon attack
	run background script LC6_MoveArchersToHill

	
	// Create the alignment meleeforce
	LC6_AlignmentPlatoon = create platoon PLATOON_INFO_JAPANESE_MELEE_2 at {1022.839,106.001,1837.535} with 15 men and 0 women
	attach LC6_AlignmentPlatoon to L6JapaneseCapital
	disable platoon LC6_AlignmentPlatoon camp
	enable platoon LC6_AlignmentPlatoon respond to town L6JapaneseCapital attack
	disable platoon LC6_AlignmentPlatoon respond to local platoon attack



	// Create the generals safeguard units that protect the capital
	LC6_SafeGuard1 = create platoon PLATOON_INFO_JAPANESE_MELEE_2 at {L6JapaneseCapital} + {20, 20} with 30 men and 0 women
	attach LC6_SafeGuard1 to L6JapaneseCapital
	disable platoon LC6_SafeGuard1 camp
	enable platoon LC6_SafeGuard1 respond to town L6JapaneseCapital attack
	set LC6_SafeGuard1 focus to {L6JapaneseCapital}
	disable platoon LC6_SafeGuard1 respond to local platoon attack

	LC6_SafeGuard2 = create platoon PLATOON_INFO_JAPANESE_RANGED_3 at {L6JapaneseCapital} - {20, -20} with 30 men and 0 women
	attach LC6_SafeGuard2 to L6JapaneseCapital
	disable platoon LC6_SafeGuard2 camp
	enable platoon LC6_SafeGuard2 respond to town L6JapaneseCapital attack
	set LC6_SafeGuard2 focus to {L6JapaneseCapital}
	disable platoon LC6_SafeGuard2 respond to local platoon attack



	// Fade up
	set fade in time 2
	wait 2 seconds

end script LC6_LandIntro


//-----------------------------------------------------------------------------
//	Get the reactions from the enemy general and the advisors for completing the land
//-----------------------------------------------------------------------------
begin script LC6_LandOutro
start

	//	LastCaptureEnum.h	-	for how the town was last captured
	//	LAST_CAPTURE_AGGRESSIVE                         =  1 ,
	//	LAST_CAPTURE_PASSIVE                            =  2 ,

	// Player wins with impressing
	if variable get last town player LC6_GREEK method of last conversion == variable LAST_CAPTURE_AGGRESSIVE
		run script LC6_GeneralReactions(LC6_GEN_SURRENDERS_PLAYER_WON_WITH_ARM)
	else
		run script LC6_GeneralReactions(LC6_GEN_SURRENDERS_PLAYER_WON_WITH_IMP)
	end if

	// Get the dialogue from the enemy general	
	run script LC6_GeneralReactions(LC6_GEN_REACT_PLAYER_WINS_THE_LAND)
	run script LC6_AdvisorReactions(LC6_ADV_REACT_EPILOGUE)

end script LC6_LandOutro


//-----------------------------------------------------------------------------
//	Create the scroll do the player can go to the next land
//-----------------------------------------------------------------------------
begin script LC6_CreateDepartureScroll

	DepartureScroll			= 0
	DepartureScrollPos		= marker at {L6JapaneseCapital} + {20.000,0.000,20.000}
	
start

	// Create the departure scroll to go to the next land
	DepartureScroll = create highlight GOLD name "BW2T_SCRIPT_GENERIC_DEPART_LAND" remind "BW2T_SCRIPT_GENERIC_DEPART_LAND" at {DepartureScrollPos}
	ALTITUDE of DepartureScroll = 3

	begin dialogue
		eject good spirit
		make good spirit point at {DepartureScroll}
		// GA: Click the scroll to leave this land and go onto the next.
		say "BW2T_SCRIPT_06FINAL_JAPANESE_GENERAL_PEACE_STEVE_540"
		wait until read
		send good spirit home
	end dialogue

	wait until DepartureScroll right clicked
	clear right clicked object

	begin dialogue
		eject good spirit
		//say "Are you sure you wish to leave the land?"
		say "BW2T_SCRIPT_03FINAL_ADVISORS_TUT_934"
		wait until read
		//say "Click again to confirm."
		say "BW2T_SCRIPT_03FINAL_ADVISORS_TUT_933"
		wait until read
		send good spirit home
	end dialogue

	wait until DepartureScroll right clicked
	clear right clicked object
	delete DepartureScroll

	run script Land6Outro

	////////SET up all challenges that haven't been set up.
	/////////Show any challenges that haven't been activated otherwise they don't appear on the menu
	if L6ShowingForestAmbush == 0
	set player 0 objective TRIBUTE_OBJECTIVE_LAND_6 with amount 1 text "BW2T_SCRIPT_06FINAL_FORESTAMBUSH_60" amount 1 description "BW2T_SCRIPT_06FINAL_FORESTAMBUSH_70" start value 0 reward GLOBAL_VALUE_TRIBUTE_LAND_6_FORESTAMBUSH
	end if
	
	if L6ShowingChopSuey == 0
	set player 0 objective TRIBUTE_OBJECTIVE_LAND_9 with amount 1 text "BW2T_SCRIPT_06FINAL_CHALLENGENAME_CHOP_SUEY" amount 1 description "BW2T_SCRIPT_06FINAL_CHALLENGE_CHOP_SUEY_REMINDER" start value 0 reward GLOBAL_VALUE_TRIBUTE_LAND_6_CHOPSUEY
	end if
	
	if L6ShowingPaternityBirth == 0
	set player 0 objective TRIBUTE_OBJECTIVE_LAND_7 with amount 1 text "BW2T_SCRIPT_06FINAL_OBJECTIVE_PATERNTIYBIRTH_10" amount 1 description "BW2T_SCRIPT_06FINAL_CHALLENGE_PATERNITY_SHEEP_REMINDER" start value 0 reward GLOBAL_VALUE_TRIBUTE_LAND_6_PATERNITYBIRTH
	end if
	
	

	increment tribute by GLOBAL_VALUE_TRIBUTE_LAND_6_COMPLETED

	if MyCreature exists
		save my_creature
	end if
	disable game can be lost
	load map "./Data/Landscape/BW2/Land7.bwe"
	
end script LC6_CreateDepartureScroll


//-----------------------------------------------------------------------------
//	Start building the wonder after a short delay then flag when it's completed
//-----------------------------------------------------------------------------
begin script LC6_OkToStartWonder
start

	// Put in a little delay before starting the Siren wonder
	wait 60 seconds
	run script LC6_GeneralReactions(LC6_GEN_REACT_KICK_OFF_SIREN)

	// Start building the wonder
	LC6_Wonder = build town L6JapaneseCapital epic wonders of type WONDER_SIREN in group LC6_NEUTRAL_ALIGN

	// Did we get the wonder?
	if LC6_Wonder exists
		wait until BUILT of LC6_Wonder >= 0.6 
		
		run script LC6_ShowSirenCutScene(LC6_Wonder)
		
		wait until BUILT of LC6_Wonder == 1 or L6CapitalConverted == LC6_TRUE // Has the wonder been built?
		
		run background script LC6_ChargeWonder
		
		wait 60 seconds or L6CapitalConverted == LC6_TRUE
		
		while L6CapitalConverted == LC6_FALSE
			if HEALTH of LC6_Wonder == 1
				CHARGE of LC6_Wonder = 1
				LC6_WonderReady = LC6_TRUE
			end if
		end while
	end if
	
end script LC6_OkToStartWonder


//-----------------------------------------------------------------------------
//	Get the towns and creatures on the land
//-----------------------------------------------------------------------------
begin script LC6_GetTownsAndCreatures

	Ctr						= 0
	TownsOk					= LC6_TRUE
	CreaturesOk				= LC6_TRUE
	Validate				= LC6_TRUE

	SFX						= 0

start

	// Get the towns
	if L6JapaneseCapital not exists
		run script Land6Globals
	end if

	// Validate that the towns exist
	if Validate == LC6_TRUE
		if L6GreekTown not exists
			TownsOk = LC6_FALSE
			if LC6_ShowDebug == LC6_TRUE
//				say "ERROR: Couldn't get the players town!"
				wait until read
			end if
		end if
		
		if L6JapaneseCapital not exists
			TownsOk = LC6_FALSE
			if LC6_ShowDebug == LC6_TRUE			
//				say "ERROR: Couldn't get the Japanese town!"
				wait until read
			end if
		end if
		
		while Ctr < L6_NUM_OF_MINOR_SETTLEMENTS
			if L6_MinorSettlement[Ctr] not exists
				TownsOk = LC6_FALSE
				if LC6_ShowDebug == LC6_TRUE				
//					say "ERROR: Couldn't get the minor town $d!" with number Ctr
					wait until read
				end if
				
				LC6_TownOrSettlement[Ctr] = LC6_INVALID
				LC6_WhoOwnsTown[Ctr] = LC6_INVALID
			else
				// Flag whether the town is a town or a settlement
				if is town L6_MinorSettlement[Ctr] settlement
					LC6_TownOrSettlement[Ctr] = LC6_SETTLEMENT
				else
					LC6_TownOrSettlement[Ctr] = LC6_TOWN

					// Record the minor towns in ascending order ie T1, T2, T3, T4, T5
					if get town with id 16 == L6_MinorSettlement[Ctr]			// T1
						LC6_TownActual[0] = L6_MinorSettlement[Ctr]
					elsif get town with id 8 == L6_MinorSettlement[Ctr]			// T2
						LC6_TownActual[1] = L6_MinorSettlement[Ctr]
					elsif get town with id 6 == L6_MinorSettlement[Ctr]			// T3
						LC6_TownActual[2] = L6_MinorSettlement[Ctr]
					elsif get town with id 9 == L6_MinorSettlement[Ctr]			// T4
						LC6_TownActual[3] = L6_MinorSettlement[Ctr]
					elsif get town with id 13 == L6_MinorSettlement[Ctr]		// T5
						LC6_TownActual[4] = L6_MinorSettlement[Ctr]
					end if

					if LC6_ShowDebug == LC6_TRUE
						SFX = create visual effect "gp_s_townctr_beam.ves" strength 0.1 scale 0.6 at {L6_MinorSettlement[Ctr]} time 10
					end if
				end if
				
				LC6_WhoOwnsTown[Ctr] = LC6_INVALID
			end if
						
			Ctr++
		end while
		
		// Are all of the towns ok?
		if TownsOk == LC6_TRUE
			if LC6_ShowDebug == LC6_TRUE			
//				say "INFO: Found all towns successfully :)"
				wait until read
			end if
		end if
	end if
	
	// Get the creatures
	MyCreature				= get player LC6_GREEK creature
//	LC6_JapaneseCreature	= get player LC6_JAPANESE creature
	
	// Validate that the creatures exist
	if Validate == LC6_TRUE
		if MyCreature not exists
			CreaturesOk = LC6_FALSE
			if LC6_ShowDebug == LC6_TRUE			
//				say "ERROR: Couldn't get the players creature!"
				wait until read
			end if
		end if

/*		JAPANESE DON'T HAVE A CREATURE NOW
		if LC6_JapaneseCreature not exists
			CreaturesOk = LC6_FALSE
			if LC6_ShowDebug == LC6_TRUE			
				say "ERROR: Couldn't get the Japanese players creature!"
				wait until read
			end if
		end if
*/		
		// Are all the creatures ok?
		if CreaturesOk == LC6_TRUE
			if LC6_ShowDebug == LC6_TRUE		
//				say "INFO: Found all the creatures successfully :)"
				wait until read
			end if
		end if
	end if
	
	// Make sure the town manager stuff doesn't interfere with the recruitment of platoons
	disable L6JapaneseCapital town manager

end script LC6_GetTownsAndCreatures


//-----------------------------------------------------------------
// Gibe the player the relevant tribute for taking over a town
//-----------------------------------------------------------------
begin script LC6_GivePLayerTributeForTakingTown(Town)
start

	// Get the required tribute depending on which town was taken
	/*if Town == 1
		increment tribute by GLOBAL_VALUE_TRIBUTE_LAND_6_TOWN1
	elsif Town == 2
		increment tribute by GLOBAL_VALUE_TRIBUTE_LAND_6_TOWN2
	elsif Town == 3
		increment tribute by GLOBAL_VALUE_TRIBUTE_LAND_6_TOWN3
	elsif Town == 4
		increment tribute by GLOBAL_VALUE_TRIBUTE_LAND_6_TOWN4
	elsif Town == 5
		increment tribute by GLOBAL_VALUE_TRIBUTE_LAND_6_TOWN5
	end if*/

end script LC6_GivePLayerTributeForTakingTown


//-----------------------------------------------------------------
// Set the objective
//-----------------------------------------------------------------
begin script LC6_AddObjectives
start

	// New uber way
	//set player 0 objective constant amount expression text "STRING" <description "STRING"> <icon constant> <parent constant> <type constant>
	

	//PRIMARY OBJECTIVES - these are controlled by script
	
	//PRIMARY - Dominate Land by Impressiveness    
	set player 0 objective TRIBUTE_OBJECTIVE_SCRIPT_CONTROLLED_WIN_LAND with amount 1 text "BW2T_SCRIPT_07FINAL_SECONDARYOBJECTIVE_80" amount 1 description "BW2T_SCRIPT_06FINAL_SECONDARYOBJECTIVE_51" start value 0 reward 120000 alignment 0.1
		
	//SECONDARY OBJECTIVES - these are controlled by code -

	// Add the relevant objectives to the list
	
	//SPECIAL OBJECTIVES
	
	//Enclose  town within walls    
	set player 0 objective TRIBUTE_OBJECTIVE_SPECIAL_ENCLOSE_TOWN_WITHIN_WALLS with amount 1 text "BW2T_SCRIPT_04FINAL_OBJECTIVE_NEUTRAL_10" amount 1 description "BW2T_SCRIPT_04FINAL_OBJECTIVE_NEUTRAL_11" start value 0	reward 15000
		

	//Take over 3 towns using impressiveness    
	set player 0 objective TRIBUTE_OBJECTIVE_TAKEOVER_TOWNS_IMPRESSIVENESS with amount 3 text "BW2T_SCRIPT_GENERIC_PICKUP163" amount 3 description "BW2T_SCRIPT_06FINAL_OBJECTIVE_GOOD_21" start value 0 reward 15000 alignment 0.05
	
	//Increase impressiveness by 30000    
	set player 0 objective TRIBUTE_OBJECTIVE_INCREASE_IMPRESSIVENESS with amount 30000 text "BW2T_SCRIPT_06FINAL_OBJECTIVE_NEUTRAL_10" amount 30000 description "BW2T_SCRIPT_06FINAL_OBJECTIVE_NEUTRAL_11" start value 0 reward 10000
	
	//Link all your impressiveness bubbles together    
	set player 0 objective TRIBUTE_OBJECTIVE_SPECIAL_LINK_TOWNS_WITH_IMPRESSIVENESS with amount 3 text "BW2T_SCRIPT_07FINAL_PRIMARYOBJECTIVE_51" amount 3 description "BW2T_SCRIPT_07FINAL_OBJECTIVE_NEUTRAL_11" start value 0 reward 5000
	
	//Build a wonder
	set player 0 objective TRIBUTE_OBJECTIVE_BUILD_WONDER with amount 1 text "BW2T_SCRIPT_10FINAL_OBJECTIVE_NEUTRAL_30" amount 1 description "BW2T_SCRIPT_10FINAL_OBJECTIVE_NEUTRAL_31" start value 0 reward 100000
	
	
	//TOWN OBJECTIVES
	
	//Build 5 fields on fertile land    
	set player 0 objective TRIBUTE_OBJECTIVE_BUILD_FIELD_FERTILE with amount 5 text "BW2T_SCRIPT_06FINAL_OBJECTIVE_NEUTRAL_90" amount 5 description "BW2T_SCRIPT_06FINAL_OBJECTIVE_NEUTRAL_91" start value 0 reward 4000
	
	//Build 10 embellishments    
	set player 0 objective TRIBUTE_OBJECTIVE_BUILD_EMBELLISHMENT with amount 10 text "BW2T_SCRIPT_08FINAL_OBJECTIVE_GOOD_30" amount 10 description "BW2T_SCRIPT_08FINAL_OBJECTIVE_GOOD_31" start value 0 reward 5000 alignment 0.03
	
	//Make 20 breeder disciples    
	set player 0 objective TRIBUTE_OBJECTIVE_MAKE_BREEDER_DISCIPLES with amount LC6_NUM_BREEDERS_NEEDED text "BW2T_SCRIPT_06FINAL_OBJECTIVE_NEUTRAL_80" amount LC6_NUM_BREEDERS_NEEDED description "BW2T_SCRIPT_06FINAL_OBJECTIVE_NEUTRAL_81" start value 0 reward 4000
		
	//Achieve city status    
	set player 0 objective TRIBUTE_OBJECTIVE_REACH_CITY_STATUS with amount 1 text "BW2T_SCRIPT_06FINAL_OBJECTIVE_NEUTRAL_60" amount 300 description "BW2T_SCRIPT_06FINAL_OBJECTIVE_NEUTRAL_61" start value 0 reward 20000
	
	//ARMY OBJECTIVES
		
	//Create 10 platoons    
	set player 0 objective TRIBUTE_OBJECTIVE_CREATE_TROOPS with amount LC6_NUM_SOLDIERS_NEEDED text "BW2T_SCRIPT_06FINAL_OBJECTIVE_50" amount LC6_NUM_SOLDIERS_NEEDED description "BW2T_SCRIPT_06FINAL_SECONDARYOBJECTIVE_71" start value 50 reward 10000 alignment -0.05

	//Take over 3 towns by force    
	set player 0 objective TRIBUTE_OBJECTIVE_TAKEOVER_TOWNS_FORCE with amount 3 text "BW2T_SCRIPT_GENERIC_PICKUP162" amount 3 description "BW2T_SCRIPT_06FINAL_OBJECTIVE_EVIL_21" start value 0 reward 15000 alignment -0.05
	
	
	//Kill every living thing    
	set player 0 objective TRIBUTE_OBJECTIVE_AS_SOON_AS_LIVING_THINGS_DEAD with amount 1 text "BW2T_SCRIPT_11FINAL_OBJECTIVE_EVIL_10" amount 1 description "BW2T_SCRIPT_11FINAL_OBJECTIVE_EVIL_11" class TRIBUTE_OBJECTIVE_CLASS_ARMY start value 0 reward 20000 alignment -0.2
	
	//TA: REMOVED AS cannot be completed..
	//Kill everyone who is not Greek in the world
	//set player 0 objective TRIBUTE_OBJECTIVE_AS_SOON_AS_NON_GREEK_DEAD with amount 1 text "BW2T_SCRIPT_10FINAL_OBJECTIVE_EVIL_20" amount 1 description "BW2T_SCRIPT_10FINAL_OBJECTIVE_EVIL_21" start value 0 reward 20000 alignment -0.2
	
	
	//RESOURCE objectives
	
		
	//Collect Resources    
	set player 0 objective TRIBUTE_OBJECTIVE_COLLECT_ALL with amount 18000 text "BW2T_SCRIPT_06FINAL_OBJECTIVE_NEUTRAL_40" amount 18000 description "BW2T_SCRIPT_06FINAL_OBJECTIVE_NEUTRAL_41" start value 0 reward 0
	
	//Collect 6000 ore    
	set player 0 objective TRIBUTE_OBJECTIVE_MINE_ORE with amount 6000 text "BW2T_SCRIPT_06FINAL_OBJECTIVE_NEUTRAL_100" amount 6000 description "BW2T_SCRIPT_06FINAL_OBJECTIVE_NEUTRAL_101" parent TRIBUTE_OBJECTIVE_COLLECT_ALL start value 0 reward 3000
	
	//Collect 6000 food    
	set player 0 objective TRIBUTE_OBJECTIVE_COLLECT_FOOD with amount 6000 text "BW2T_SCRIPT_06FINAL_OBJECTIVE_NEUTRAL_110" amount 6000 description "BW2T_SCRIPT_06FINAL_OBJECTIVE_NEUTRAL_111" parent TRIBUTE_OBJECTIVE_COLLECT_ALL start value 0 reward 3000
	
	//Collect 6000 wood    
	set player 0 objective TRIBUTE_OBJECTIVE_COLLECT_WOOD with amount 6000 text "BW2T_SCRIPT_06FINAL_OBJECTIVE_NEUTRAL_120" amount 6000 description "BW2T_SCRIPT_06FINAL_OBJECTIVE_NEUTRAL_121" parent TRIBUTE_OBJECTIVE_COLLECT_ALL start value 0 reward 3000
	


	//Creature Objectives
	
	//Creature Collect Resources    
	set player 0 objective TRIBUTE_OBJECTIVE_CREATURE_COLLECT_ALL with amount 15000 text "BW2T_SCRIPT_09FINAL_OBJECTIVE_NEUTRAL_60" amount 15000 description "BW2T_SCRIPT_09FINAL_OBJECTIVE_NEUTRAL_61" class TRIBUTE_OBJECTIVE_CLASS_CREATURE start value 0 reward 0
	
	//Creature Collects 5000 ore    
	set player 0 objective TRIBUTE_OBJECTIVE_CREATURE_COLLECT_ORE with amount 5000 text "BW2T_SCRIPT_07FINAL_OBJECTIVE_NEUTRAL_60" amount 5000 description "BW2T_SCRIPT_07FINAL_OBJECTIVE_NEUTRAL_61" parent TRIBUTE_OBJECTIVE_CREATURE_COLLECT_ALL class TRIBUTE_OBJECTIVE_CLASS_CREATURE start value 0 reward 3000
	
	//Creature Collects 5000 food    
	set player 0 objective TRIBUTE_OBJECTIVE_CREATURE_COLLECT_FOOD with amount 5000 text "BW2T_SCRIPT_09FINAL_OBJECTIVE_NEUTRAL_81" amount 5000 description "BW2T_SCRIPT_09FINAL_OBJECTIVE_NEUTRAL_80" parent TRIBUTE_OBJECTIVE_CREATURE_COLLECT_ALL class TRIBUTE_OBJECTIVE_CLASS_CREATURE start value 0 reward 3000
	
	//Creature Collects 5000 wood    
	set player 0 objective TRIBUTE_OBJECTIVE_CREATURE_COLLECT_WOOD with amount 5000 text "BW2T_SCRIPT_09FINAL_OBJECTIVE_NEUTRAL_90" amount 5000 description "BW2T_SCRIPT_09FINAL_OBJECTIVE_NEUTRAL_91" parent TRIBUTE_OBJECTIVE_CREATURE_COLLECT_ALL class TRIBUTE_OBJECTIVE_CLASS_CREATURE start value 0 reward 3000

	//Creature Build X Abodes.....
	set player 0 objective TRIBUTE_OBJECTIVE_CREATURE_BUILD_ABODES with amount 30	text "BW2T_SCRIPT_04FINAL_SECONDARYOBJECTIVE_10" amount 30 description "BW2T_SCRIPT_08FINAL_OBJECTIVES_DESCRIPTION_10" start value 0 reward 10000

	//////
	//The amount setting must occur last
	set player 0 objective class TRIBUTE_OBJECTIVE_CLASS_GOLD amount 20
	set player 0 objective class TRIBUTE_OBJECTIVE_CLASS_SPECIAL amount 0
	set player 0 objective class TRIBUTE_OBJECTIVE_CLASS_TOWN amount 1
	set player 0 objective class TRIBUTE_OBJECTIVE_CLASS_ARMY amount 1
	set player 0 objective class TRIBUTE_OBJECTIVE_CLASS_CREATURE amount 1
	set player 0 objective class TRIBUTE_OBJECTIVE_CLASS_RESOURCES amount 1


end script LC6_AddObjectives


//-----------------------------------------------------------------
// Remove the objective from the list
//-----------------------------------------------------------------
begin script LC6_RemoveObjective(Objective)
start

	
	
	if Objective == LC6_OBJECTIVE_MAKE_BREEDERS
		disable player 0 objective TRIBUTE_OBJECTIVE_MAKE_BREEDER_DISCIPLES
	elsif Objective == LC6_OBJECTIVE_TAKE_OVER_ALL_SETTLEMENTS
		disable player 0 objective TRIBUTE_OBJECTIVE_PLAYER_TAKE_OVER_MINOR_SETTLEMENTS
	elsif Objective == LC6_OBJECTIVE_MAKE_SOLDIERS
		disable player 0 objective TRIBUTE_OBJECTIVE_CREATE_PLATOONS
	end if

end script LC6_RemoveObjective


//-----------------------------------------------------------------------------
//	Fire the Siren spell in some spaccy way
//-----------------------------------------------------------------------------
begin script LC6_FireSiren(Pos)

	SirenSpell			= 0
	SirenWarning		= 0
	FireTimer			= create timer for 0 seconds
	WarningMade = LC6_FALSE
	FireSiren = LC6_TRUE
start
	if HEALTH of LC6_Wonder == 1
		begin dialogue
		//GEN: "Prepare to lull them with the Siren call."
			say "BW2T_SCRIPT_06FINAL_EPIC_SIREN_READY"
			wait until read
		end dialogue
	end if
	//create 30 worshippers at Wonder
	
	set FireTimer time to 15 seconds

	begin loop
		if HEALTH of LC6_Wonder == 1
			if WarningMade == LC6_FALSE
				WarningMade = LC6_TRUE
				SirenWarning = create visual effect VISUAL_EFFECT_EPIC_TARGET_WARNING at {Pos} + {0.000,10.000,0.000} time 15 target {Pos} + {0.000,10.000,0.000}
			end if
		else
			if SirenWarning exists
				delete SirenWarning
			end if
			
			LC6_DoneConvertWithSiren = LC6_FALSE
			FireSiren = LC6_FALSE
			set FireTimer time to 0 seconds
		end if
	until get FireTimer time remaining == 0
	end loop
	
	if FireSiren == LC6_TRUE and LC6_SirenFired	== LC6_FALSE
		LC6_SirenFired = LC6_TRUE
		LC6_DoneConvertWithSiren = LC6_TRUE
		run script LC6_GeneralReactions(LC6_GEN_REACT_SIREN_READY_TO_CONVERT_ATTACKING_TROOPS)
	
		SirenSpell = create siren at {Pos} player 1
		
		run background script Land6Siren(LC6_Wonder, SirenSpell)
		CHARGE of LC6_Wonder = 0
	end if

/*
	//THIS LINE WILL PROBS HAVE TO BE MOVED AS IT TELEPORTS PPL AS A CHEAT
	invoke SirenSpell EPIC_MOVE_VILLAGERS //teleports enemy villagers to siren (not on screen)
	wait 0.8 seconds
	invoke SirenSpell EPIC_BEAM_DOWN //sEND BEAM DOWN
	wait 0.7 seconds

	//play string sound "SCRIPT4_SEPIC_BEAMOFLIGHTSTART1"	//Short Beam Zap!
	//play string sound "SCRIPT4_SEPIC_BEAMOFLIGHT11"
	wait 0.5 second
	//play string sound "SCRIPT4_SEPIC_BEAMOFLIGHTLOOP7"

	wait 4 seconds

	invoke SirenSpell EPIC_SHOW_SIREN //show siren
	invoke SirenSpell EPIC_SHUT_DOWN_BEAM
	
	//ATTACH THIS MUSIC TO THE SIREN OBJECT?
	//start music "SirenSong"
		
	//stop sound "SCRIPT4_SEPIC_BEAMOFLIGHTLOOP7"
*/
	//Create a timer for time up counting
/*
	MusicEventTimer=create timer for 0 seconds
	MusicEvent1=get music "SirenSong" event "e1" time
	MusicEvent2=get music "SirenSong" event "e2" time
*/
/*	wait 12.5 seconds

	//replace this wait too?	
	//wait until get MusicEventTimer time since set >= MusicEvent1

	invoke SirenSpell EPIC_SUMMON_NYMPHS
	wait 0.5 seconds
	invoke SirenSpell EPIC_ADD_NYMPHS //add nymphs
	wait 20.2 seconds

	invoke SirenSpell EPIC_TRIGGER_NYMPHS_GESTURE //sic nymphs
	wait 3 seconds

	invoke SirenSpell EPIC_TRIGGER_NYMPHS //sic nymphs	
	wait 19.3 seconds

	//play string sound "SCRIPT4_SEPIC_SIRENDISAPPEAR"

	invoke SirenSpell EPIC_REMOVE_SIREN
	wait 12 seconds
*/
end script LC6_FireSiren

begin script LC6_AlignmentAttack
	EvilRoute = create SCRIPT_OBJECT_TYPE_WAYPOINTROUTE at {0.000,0.000,0.000}
	GoodRoute = create SCRIPT_OBJECT_TYPE_WAYPOINTROUTE at {0.000,0.000,0.000}
	
	EvilPos1 = marker at {987.126,86.871,1779.778}
	EvilPos2 = marker at {1030.770,76.348,1736.326}
	EvilPos3 = marker at {1073.434,71.778,1652.774}
	EvilPos4 = marker at {1064.482,66.418,1564.422}
	EvilPos5 = marker at {1033.342,65.497,1511.547}
	EvilPos6 = marker at {1075.199,69.284,1438.711}
	EvilPos7 = marker at {1058.152,70.482,1357.084}
	EvilPos8 = marker at {977.747,69.219,1360.737}
	EvilPos9 = marker at {921.464,57.112,1204.517}
	EvilPos10 = marker at {942.736,52.799,1017.572}
	EvilPos11 = marker at {863.050,55.395,874.794}
	
	GoodPos1 = marker at {997.841,93.779,1803.807}
	GoodPos2 = marker at {991.830,77.768,1670.559}
	GoodPos3 = marker at {867.925,68.250,1605.464}
	GoodPos4 = marker at {754.951,70.334,1324.975}
	GoodPos5 = marker at {391.392,57.331,1061.065}
	GoodPos6 = marker at {658.359,61.858,695.536}
	
	BehindArchersPos = marker at {990.746,80.287,1571.105}
start
	add {EvilPos1} to waypoint list EvilRoute
	add {EvilPos2} to waypoint list EvilRoute
	add {EvilPos3} to waypoint list EvilRoute
	add {EvilPos4} to waypoint list EvilRoute
	add {EvilPos5} to waypoint list EvilRoute
	add {EvilPos6} to waypoint list EvilRoute
	add {EvilPos7} to waypoint list EvilRoute
	add {EvilPos8} to waypoint list EvilRoute
	add {EvilPos9} to waypoint list EvilRoute
	add {EvilPos10} to waypoint list EvilRoute
	add {EvilPos11} to waypoint list EvilRoute

	add {GoodPos1} to waypoint list GoodRoute
	add {GoodPos2} to waypoint list GoodRoute
	add {GoodPos3} to waypoint list GoodRoute
	add {GoodPos4} to waypoint list GoodRoute
	add {GoodPos5} to waypoint list GoodRoute
	add {GoodPos6} to waypoint list GoodRoute

	if LC6_AlignmentPlatoon exists
		wait 15 seconds
		if persistent data "LAND4METHODOFCONVERSION" == 1
			begin dialogue
			//GEN: "So you like your armies do you? Bow to the might of MY armies."
				say "BW2T_SCRIPT_06FINAL_GENERAL_GREEKS_BUILD_ARMIES_110"
				wait until read
			end dialogue
			move LC6_AlignmentPlatoon along EvilRoute with patrol WAYPOINTROUTE_TRAVERSAL_TYPE_FORWARDS
			wait until get size of LC6_AlignmentPlatoon action queue == 0
			set LC6_AlignmentPlatoon attack everything near {L6GreekTown} radius 50
		else
			if LC6_AlignmentPlatoon exists
				move LC6_AlignmentPlatoon along GoodRoute with patrol WAYPOINTROUTE_TRAVERSAL_TYPE_FORWARDS
			end if
			
			wait until get size of LC6_AlignmentPlatoon action queue == 0 or PLAYER of get town with id 16 == 0 or LC6_CrossedMajinoLine == LC6_TRUE
			if LC6_AlignmentPlatoon exists
				if get size of LC6_AlignmentPlatoon action queue == 0
					wait 2 seconds
					
					begin dialogue
					//GEN: "I have underestimated them. Their Town grows quickly."
						say "BW2T_SCRIPT_06FINAL_GENERAL_GREEKS_BUILD_ARMIES_70"
						wait until read
					end dialogue	
					move LC6_AlignmentPlatoon along GoodRoute with patrol WAYPOINTROUTE_TRAVERSAL_TYPE_REVERSE
				else 
					clear LC6_AlignmentPlatoon action queue
				end if
						
				add action PLATOON_AGENDA_ACTION_MOVE_TO_POS using {BehindArchersPos} to LC6_AlignmentPlatoon action queue
				add action PLATOON_AGENDA_ACTION_FOLLOW_PLATOON using LC6_GeneralsInitialFireArchers to LC6_AlignmentPlatoon action queue
			end if
		end if
	end if
end script LC6_AlignmentAttack

begin script LC6_MoveArchersToHill
	WestPos = marker at {501.883,50.523,1226.004}
	EastPos = marker at {941.558,48.854,1122.831}
	PlayerCrossedTheLine = LC6_FALSE
	PlayersPlatoon = 0
	HillPos = marker at {986.771,79.240,1553.802}
	DefendedTown = LC6_FALSE
	TownPatrolRoute2 = create SCRIPT_OBJECT_TYPE_WAYPOINTROUTE at {0.000,0.000,0.000}
	PatrolPos1 = marker at {957.849, 88.405, 1777.420}
	PatrolPos2 = marker at {1045.733, 77.159, 1748.279}
	PatrolPos3 = marker at {973.699, 73.759, 1703.710}
	PatrolPos4 = marker at {1038.131, 75.501, 1732.245}
start
	add {PatrolPos1} to waypoint list TownPatrolRoute2
	add {PatrolPos2} to waypoint list TownPatrolRoute2
	add {PatrolPos3} to waypoint list TownPatrolRoute2
	add {PatrolPos4} to waypoint list TownPatrolRoute2
	
	begin loop  
		PlayersPlatoon = get platoon of player 0 nearest {L6JapaneseCapital} radius 2000
		if {PlayersPlatoon} and {L6JapaneseCapital} on same side of line between {WestPos} and {EastPos}
			PlayerCrossedTheLine = LC6_TRUE
		end if
	until PLAYER of get town with id 16 == 0 or PlayerCrossedTheLine == LC6_TRUE
	end loop
		
	if LC6_GeneralsInitialFireArchers exists
		add action PLATOON_AGENDA_ACTION_MOVE_TO_POS using {HillPos} to LC6_GeneralsInitialFireArchers action queue
	end if
	
	if LC6_GeneralsInitialMelee exists
//		clear LC6_GeneralsInitialMelee action queue
//		move LC6_GeneralsInitialMelee along TownPatrolRoute2 with patrol WAYPOINTROUTE_TRAVERSAL_TYPE_CIRCULAR
	end if
	
	while LC6_GeneralsInitialFireArchers exists and DefendedTown == LC6_FALSE
		if PLAYER of get town with id 9 == 0
			add action PLATOON_AGENDA_ACTION_ATTACK_TOWN_CENTRE_FOR_TAKE_OVER using get town with id 9 to LC6_GeneralsInitialFireArchers action queue
			add action PLATOON_AGENDA_ACTION_MOVE_TO_POS using {HillPos} to LC6_GeneralsInitialFireArchers action queue
			DefendedTown = LC6_TRUE
		end if
	end while
			
end script LC6_MoveArchersToHill

begin script LC6_ShowSirenCutScene(Wonder)

	SirenRelCam[3]
	SirenRelFoc[3]

start
	store camera details

	begin cinema
		set fade red 0 green 0 blue 0 time 2
		wait 2 seconds
		start music "cut_scene_sinister_02"
		set fade in time 2
		reset camera path 

		SirenRelCam[0] = marker at get world position from Wonder to {16.967, 20.203, 16.770}//{19.845, 23.508, -6.576}
		SirenRelFoc[0] = marker at get world position from Wonder to {-45.624, 45.293, -57.083}//{-71.354, 53.776, 21.109}

		SirenRelCam[1] = marker at get world position from Wonder to {-0.140, 15.779, 20.389}
		SirenRelFoc[1] = marker at get world position from Wonder to {1.777, 52.794, -72.482}

		SirenRelCam[2] = marker at get world position from Wonder to {-24.149, 7.451, 7.295}
		SirenRelFoc[2] = marker at get world position from Wonder to {61.532, 52.240, -18.267}

		queue camera move with position {SirenRelCam[0]} focus {SirenRelFoc[0]} time 0.0
		queue camera move with position {SirenRelCam[1]} focus {SirenRelFoc[1]} time 4.0
		queue camera move with position {SirenRelCam[2]} focus {SirenRelFoc[2]} time 7.0
		play camera path with easein 0 easeout 0 method SCRIPT_CAMERAPATH_EQUALTIME

		wait 2 seconds

		//GEN: "I will watch with interest while the Siren does her work."
		say "BW2T_SCRIPT_06FINAL_EPIC_SIREN_READY_2"
		wait 7 seconds
		wait until read
		set fade red 0 green 0 blue 0 time 2
		wait 2 seconds
		stop music
		reset camera path 
		restore camera details
		set fade in time 2	
		wait 2 seconds
	end cinema
	
end script LC6_ShowSirenCutScene

begin script LC6_GateManager
	LeftPos = marker at {1008.719, 194.507, 1850.648}
	RightPos = marker at {2062.500, 265.821, 1297.354}
	GateHouse[NUMBER_OF_GATE_HOUSES]
	GateClosed[NUMBER_OF_GATE_HOUSES] 
	PlayersPlatoon = 0
	PlayersCatapult = 0
	PlayersInWalls = LC6_FALSE
	Counter = 0
start
	while GateHouse[0] not exists 
		GateHouse[0] = get HOUSE ABODE_NUMBER_GATEHOUSE at {925.414, 119.259, 2018.770} radius 50
	end while
	while GateHouse[1] not exists
		GateHouse[1] = get HOUSE ABODE_NUMBER_GATEHOUSE at {1024.583, 114.434, 1873.472} radius 50
	end while
	while GateHouse[2] not exists
		GateHouse[2] = get HOUSE ABODE_NUMBER_GATEHOUSE at {1249.659, 119.951, 2005.247} radius 50
	end while
	
	if not gate GateHouse[0] is open
		set gate GateHouse[0] open
	end if

	if not gate GateHouse[1] is open
		set gate GateHouse[1] open
	end if

	if not gate GateHouse[2] is open
		set gate GateHouse[2] open
	end if

	GateClosed[0] = LC6_FALSE 
	GateClosed[1] = LC6_FALSE 
	GateClosed[2] = LC6_FALSE 
	
	begin loop 
	//----Check if the player's army approaches the norse capital----//	
		if town L6JapaneseCapital is under takeover from player 0
			PlayersInWalls = LC6_TRUE
		else
			PlayersInWalls = LC6_FALSE
		end if
		
		if PlayersInWalls == LC6_TRUE 
			if not gate GateHouse[0] is open and HEALTH of GateHouse[0] == 1
				set gate GateHouse[0] open
			end if
			if not gate GateHouse[1] is open and HEALTH of GateHouse[1] == 1
				set gate GateHouse[1] open
			end if
			if not gate GateHouse[2] is open and HEALTH of GateHouse[2] == 1
				set gate GateHouse[2] open
			end if
				
			GateClosed[0] = LC6_FALSE 
			GateClosed[1] = LC6_FALSE 
			GateClosed[2] = LC6_FALSE 
		end if
		
		if PlayersInWalls == LC6_FALSE
			Counter = 0
			while Counter < NUMBER_OF_GATE_HOUSES
				PlayersPlatoon = get platoon of player 0 nearest {GateHouse[Counter]} radius GLOBAL_VALUE_GATEHOUSE_CLOSE_DISTANCE
				PlayersCatapult = get siege weapon of player 0 nearest {GateHouse[Counter]} radius GLOBAL_VALUE_GATEHOUSE_CLOSE_DISTANCE
				
				if PlayersPlatoon exists or PlayersCatapult exists or get distance from {MyCreature} to {GateHouse[Counter]} < GLOBAL_VALUE_GATEHOUSE_CLOSE_DISTANCE_FOR_CREATURE
					if gate GateHouse[Counter] is open and HEALTH of GateHouse[Counter] == 1
						set gate GateHouse[Counter] close
					end if
					GateClosed[Counter] = LC6_TRUE
				elsif GateClosed[Counter] == LC6_TRUE 
					PlayersPlatoon = get platoon of player 0 nearest {GateHouse[Counter]} radius GLOBAL_VALUE_GATEHOUSE_OPEN_DISTANCE
					PlayersCatapult = get siege weapon of player 0 nearest {GateHouse[Counter]} radius GLOBAL_VALUE_GATEHOUSE_OPEN_DISTANCE

					if not PlayersPlatoon exists and not PlayersCatapult exists and get distance from {MyCreature} to {GateHouse[Counter]} > GLOBAL_VALUE_GATEHOUSE_OPEN_DISTANCE_FOR_CREATURE
						if not gate GateHouse[Counter] is open and HEALTH of GateHouse[Counter] == 1
							set gate GateHouse[Counter] open
						end if
						GateClosed[Counter] = LC6_FALSE
					end if
				end if
				Counter++
			end while
		end if
	until L6CapitalConverted == LC6_TRUE
	end loop
end script LC6_GateManager

begin script LC6_TributeManager
	TributeGiven[L6_NUM_OF_MINOR_SETTLEMENTS]
	Tribute[L6_NUM_OF_MINOR_SETTLEMENTS]
	Counter = 0
start
	TributeGiven[0] = LC6_FALSE
	TributeGiven[1] = LC6_FALSE
	TributeGiven[2] = LC6_FALSE
	TributeGiven[3] = LC6_FALSE
	TributeGiven[4] = LC6_FALSE
	TributeGiven[5] = LC6_FALSE
	TributeGiven[6] = LC6_FALSE
	TributeGiven[7] = LC6_FALSE
	TributeGiven[8] = LC6_FALSE
	TributeGiven[9] = LC6_FALSE
	TributeGiven[10] = LC6_FALSE
	
	Tribute[0] = GLOBAL_VALUE_TRIBUTE_LAND_6_TOWN_OKI
	Tribute[1] = GLOBAL_VALUE_TRIBUTE_LAND_6_TOWN_YUKI
	Tribute[2] = GLOBAL_VALUE_TRIBUTE_LAND_6_TOWN_SEKKIO
	Tribute[3] = GLOBAL_VALUE_TRIBUTE_LAND_6_TOWN_MIDO
	Tribute[4] = GLOBAL_VALUE_TRIBUTE_LAND_6_TOWN_SAKATO
	Tribute[5] = GLOBAL_VALUE_TRIBUTE_LAND_6_SETTLEMENT
	Tribute[6] = GLOBAL_VALUE_TRIBUTE_LAND_6_SETTLEMENT
	Tribute[7] = GLOBAL_VALUE_TRIBUTE_LAND_6_SETTLEMENT
	Tribute[8] = GLOBAL_VALUE_TRIBUTE_LAND_6_SETTLEMENT
	Tribute[9] = GLOBAL_VALUE_TRIBUTE_LAND_6_SETTLEMENT
	Tribute[10] = GLOBAL_VALUE_TRIBUTE_LAND_6_SETTLEMENT
	
	begin loop 
		Counter = 0
		while Counter < L6_NUM_OF_MINOR_SETTLEMENTS
			if TributeGiven[Counter] == LC6_FALSE
				if PLAYER of L6_AlexsMinorSettlement[Counter] == 0
					increment tribute by Tribute[Counter]
					TributeGiven[Counter] = LC6_TRUE
				elsif variable get town L6_AlexsMinorSettlement[Counter] status == variable TOWN_STATUS_MIGRATED
					if PLAYER of get town L6_AlexsMinorSettlement[Counter] is migrating to == 0
						increment tribute by Tribute[Counter]
						TributeGiven[Counter] = LC6_TRUE
					end if
				end if
			end if
			Counter++
		end while
	end loop
end script LC6_TributeManager

begin script LC6_RoadBuilder
	RoadPos[LC6_NUM_ROADS]
	Counter = 0
	Road = 0
start
	RoadPos[0] = marker at {998.293, 84.083, 1764.012}
	RoadPos[1] = marker at {1057.956, 122.382, 1914.756}
	RoadPos[2] = marker at {1041.945, 122.691, 1916.649}
	RoadPos[3] = marker at {1001.022, 131.748, 1989.566}
	RoadPos[4] = marker at {998.711, 136.325, 2029.278}
	RoadPos[5] = marker at {1118.834, 123.790, 1916.075}
	RoadPos[6] = marker at {1153.725, 134.630, 1984.808}
	RoadPos[7] = marker at {1088.454, 121.873, 1919.992}
	RoadPos[8] = marker at {1281.480, 108.588, 1940.393}
	RoadPos[9] = marker at {1069.636, 125.751, 1936.484}
	RoadPos[10] = marker at {1064.573, 125.816, 1936.841}
	RoadPos[11] = marker at {1123.366, 137.480, 2019.358}
	RoadPos[12] = marker at {1035.708, 134.747, 2024.338}
	RoadPos[13] = marker at {1080.436, 142.178, 2035.049}
	RoadPos[14] = marker at {1083.121, 142.340, 2035.468}
	RoadPos[15] = marker at {1118.745, 138.813, 2031.843}
	RoadPos[16] = marker at {1092.050, 126.217, 1935.058}
	RoadPos[17] = marker at {1089.914, 122.492, 1921.564}
	RoadPos[18] = marker at {1036.018, 135.968, 2030.439}
	RoadPos[19] = marker at {1072.589, 124.882, 1931.087}
	RoadPos[20] = marker at {1078.454, 142.965, 2040.561}
	RoadPos[21] = marker at {1085.808, 139.170, 2027.607}
	
	while Counter < LC6_NUM_ROADS
		Road = build building at {RoadPos[Counter]} desire 0
		release Road
		wait 30 seconds
		Counter++
	end while

end script LC6_RoadBuilder

begin script LC6_ResourceManager
	StoreHouse = 0
start
	while StoreHouse not exists
		StoreHouse = get building ABODE_NUMBER_STORAGE_PIT in L6JapaneseCapital min built 0 
	end while
	
	wait until BUILT of StoreHouse == 1
	
	begin loop
		if LC6_NeedResources == LC6_TRUE
			if HEALTH of StoreHouse == 1
				if get resource RESOURCE_TYPE_FOOD in StoreHouse < 10000 and not {StoreHouse} viewed
					add resource RESOURCE_TYPE_FOOD 2000 to L6JapaneseCapital
				end if
				if get resource RESOURCE_TYPE_WOOD in StoreHouse < 10000 and not {StoreHouse} viewed
					add resource RESOURCE_TYPE_WOOD 2000 to L6JapaneseCapital
				end if
				if get resource RESOURCE_TYPE_ORE in StoreHouse < 10000 and not {StoreHouse} viewed
					add resource RESOURCE_TYPE_ORE 2000 to L6JapaneseCapital
				end if
			end if
		end if
	until L6CapitalConverted == LC6_TRUE
	end loop
end script LC6_ResourceManager

begin script LC6_ChargeWonder
	WunderCharge = 0
start
	begin loop
		if BUILT of LC6_Wonder == 1 and HEALTH of LC6_Wonder == 1
			WunderCharge = CHARGE of LC6_Wonder
			WunderCharge += 0.1
			CHARGE of LC6_Wonder = WunderCharge
			wait 15 seconds
		end if
	until CHARGE of LC6_Wonder >= 1
	end loop
end script LC6_ChargeWonder

begin script LC6_CheckEnemiesArmySize
start
	begin loop
		if get number of platoons belonging to player LC6_JAPANESE > 5
			LC6_EnemyHasLotsOfArmies = LC6_TRUE
		end if
	until L6CapitalConverted == LC6_TRUE or LC6_EnemyHasLotsOfArmies == LC6_TRUE
	end loop
end script LC6_CheckEnemiesArmySize
//-----------------------------------------------------------------------------
//	End of script
//-----------------------------------------------------------------------------